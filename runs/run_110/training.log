2025-12-04 20:49:35,077 - INFO - Logging initialized. Log file: runs/run_110/training.log
2025-12-04 20:49:35,079 - INFO - Experiment directory: runs/run_110
2025-12-04 20:49:35,080 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-04 20:49:35,207 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-04 20:49:35,209 - INFO - Using device: cuda
2025-12-04 20:49:35,210 - INFO - Training configuration: epochs=20, warmup=3, lr=0.0005
2025-12-04 20:49:35,211 - INFO - SWIN configuration: variant=tiny, use_shifted_window=False
2025-12-04 20:49:35,212 - INFO - SWIN details: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7
2025-12-04 20:49:35,213 - INFO - Loading dataset...
2025-12-04 20:49:35,215 - INFO - Starting ImageNet data loading from root: /
2025-12-04 20:49:35,217 - INFO - Resolved root path: /
2025-12-04 20:49:35,218 - INFO - Root path exists: True
2025-12-04 20:49:35,219 - INFO - Root path is dir: True
2025-12-04 20:49:35,224 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-04 20:49:35,225 - INFO - Expected train_dir: /train_set, exists: True
2025-12-04 20:49:35,226 - INFO - Expected val_dir: /val_set, exists: True
2025-12-04 20:49:41,850 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-04 20:49:41,973 - INFO - Dataset loaded: train=50000 samples (521 batches), val=5000 samples (53 batches), test=5000 samples (53 batches)
2025-12-04 20:49:43,786 - INFO - Training Swin-Tiny from scratch
2025-12-04 20:49:43,787 - INFO - Initializing model from scratch...
2025-12-04 20:49:43,788 - INFO - Model architecture: Swin-Tiny
2025-12-04 20:49:43,790 - INFO - Model config: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7, use_shifted_window=False
2025-12-04 20:49:44,297 - INFO - Model created with random initialization
2025-12-04 20:49:44,298 - INFO - Total parameters: 28,288,354
2025-12-04 20:49:44,299 - INFO - Trainable parameters: 28,288,354
2025-12-04 20:49:44,646 - INFO - Starting from-scratch training...
2025-12-04 20:49:44,647 - INFO - Optimizer: training all model parameters
2025-12-04 20:49:44,649 - INFO - Starting training...
2025-12-04 21:04:39,256 - INFO - Epoch 1/20: LR: 0.000170
2025-12-04 21:04:39,271 - INFO - Epoch 1/20: Train Loss: 6.9050, Val Loss: 6.8245, Val Acc: 0.34%
2025-12-04 21:18:16,448 - INFO - Epoch 2/20: LR: 0.000335
2025-12-04 21:18:16,455 - INFO - Epoch 2/20: Train Loss: 6.8216, Val Loss: 6.6997, Val Acc: 0.30%
2025-12-04 21:32:10,569 - INFO - Epoch 3/20: LR: 0.000500
2025-12-04 21:32:10,580 - INFO - Epoch 3/20: Train Loss: 6.7746, Val Loss: 6.6884, Val Acc: 0.52%
2025-12-04 21:45:55,211 - INFO - Epoch 4/20: LR: 0.000496
2025-12-04 21:45:55,213 - INFO - Epoch 4/20: Train Loss: 6.7839, Val Loss: 6.8362, Val Acc: 0.26%
2025-12-04 21:59:35,959 - INFO - Epoch 5/20: LR: 0.000483
2025-12-04 22:00:55,598 - INFO - Epoch 5/20: Train Loss: 6.8853, Val Loss: 6.8397, Val Acc: 0.30%, Test Loss: 6.8397, Test Acc: 0.30%
2025-12-04 22:14:33,657 - INFO - Epoch 6/20: LR: 0.000463
2025-12-04 22:14:33,659 - INFO - Epoch 6/20: Train Loss: 6.8345, Val Loss: 6.8096, Val Acc: 0.28%
2025-12-04 22:28:15,209 - INFO - Epoch 7/20: LR: 0.000435
2025-12-04 22:28:15,211 - INFO - Epoch 7/20: Train Loss: 6.8081, Val Loss: 6.8000, Val Acc: 0.34%
2025-12-04 22:41:57,609 - INFO - Epoch 8/20: LR: 0.000401
2025-12-04 22:41:57,626 - INFO - Epoch 8/20: Train Loss: 6.7926, Val Loss: 6.7437, Val Acc: 0.40%
2025-12-04 22:55:44,871 - INFO - Epoch 9/20: LR: 0.000362
2025-12-04 22:55:44,910 - INFO - Epoch 9/20: Train Loss: 6.7606, Val Loss: 6.7539, Val Acc: 0.34%
2025-12-04 23:09:26,684 - INFO - Epoch 10/20: LR: 0.000319
2025-12-04 23:10:46,442 - INFO - Epoch 10/20: Train Loss: 6.7457, Val Loss: 6.7031, Val Acc: 0.52%, Test Loss: 6.7031, Test Acc: 0.52%
2025-12-04 23:10:46,444 - INFO - Saving checkpoint for epoch 10...
2025-12-04 23:10:47,332 - INFO - ✅ Checkpoint saved: runs/run_110/checkpoint_epoch_10.pth
2025-12-04 23:24:25,979 - INFO - Epoch 11/20: LR: 0.000274
2025-12-04 23:24:25,999 - INFO - Epoch 11/20: Train Loss: 6.7314, Val Loss: 6.6817, Val Acc: 0.76%
2025-12-04 23:37:58,698 - INFO - Epoch 12/20: LR: 0.000227
2025-12-04 23:37:58,725 - INFO - Epoch 12/20: Train Loss: 6.7084, Val Loss: 6.6806, Val Acc: 0.64%
2025-12-04 23:51:33,238 - INFO - Epoch 13/20: LR: 0.000182
2025-12-04 23:51:33,255 - INFO - Epoch 13/20: Train Loss: 6.7220, Val Loss: 6.8153, Val Acc: 0.42%
2025-12-05 00:05:09,479 - INFO - Epoch 14/20: LR: 0.000139
2025-12-05 00:05:09,501 - INFO - Epoch 14/20: Train Loss: 6.7578, Val Loss: 6.6752, Val Acc: 0.70%
2025-12-05 00:18:44,518 - INFO - Epoch 15/20: LR: 0.000100
2025-12-05 00:20:03,164 - INFO - Epoch 15/20: Train Loss: 6.7155, Val Loss: 6.6578, Val Acc: 0.64%, Test Loss: 6.6578, Test Acc: 0.64%
2025-12-05 00:33:38,555 - INFO - Epoch 16/20: LR: 0.000066
2025-12-05 00:33:38,698 - INFO - Epoch 16/20: Train Loss: 6.6937, Val Loss: 6.6311, Val Acc: 1.00%
2025-12-05 00:47:13,366 - INFO - Epoch 17/20: LR: 0.000038
2025-12-05 00:47:13,394 - INFO - Epoch 17/20: Train Loss: 6.6667, Val Loss: 6.6229, Val Acc: 0.98%
2025-12-05 01:00:45,631 - INFO - Epoch 18/20: LR: 0.000018
2025-12-05 01:00:45,645 - INFO - Epoch 18/20: Train Loss: 6.6358, Val Loss: 6.5868, Val Acc: 0.84%
2025-12-05 01:14:20,899 - INFO - Epoch 19/20: LR: 0.000005
2025-12-05 01:14:20,930 - INFO - Epoch 19/20: Train Loss: 6.6215, Val Loss: 6.5794, Val Acc: 0.96%
2025-12-05 01:27:57,956 - INFO - Epoch 20/20: LR: 0.000001
2025-12-05 01:29:16,772 - INFO - Epoch 20/20: Train Loss: 6.6147, Val Loss: 6.5781, Val Acc: 1.04%, Test Loss: 6.5781, Test Acc: 1.04%
2025-12-05 01:29:16,790 - INFO - Saving checkpoint for epoch 20...
2025-12-05 01:29:18,058 - INFO - ✅ Checkpoint saved: runs/run_110/checkpoint_epoch_20.pth
2025-12-05 01:29:18,059 - INFO - Training completed!
2025-12-05 01:29:18,061 - INFO - Training completed!
2025-12-05 01:29:18,062 - INFO - Generating training curves...
2025-12-05 01:29:20,034 - WARNING - Inhomogeneous shapes in per-class F1 data: [(997,), (997,), (996,), (997,), (997,), (997,), (997,), (997,), (998,), (997,), (997,), (998,), (997,), (997,), (997,), (997,), (997,), (997,), (997,), (998,)]. Skipping per-class plotting.
2025-12-05 01:29:20,036 - INFO - Training curves saved as separate images with base name 'runs/run_110/training_curves_from_scratch'
2025-12-05 01:29:20,037 - INFO - Generating confusion matrix on test set...
