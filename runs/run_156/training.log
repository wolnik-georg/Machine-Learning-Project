<<<<<<< Updated upstream
<<<<<<< Updated upstream
<<<<<<< Updated upstream
<<<<<<< Updated upstream
2025-12-10 23:15:46,266 - INFO - Logging initialized. Log file: runs/run_156/training.log
2025-12-10 23:15:47,453 - INFO - Experiment directory: runs/run_156
2025-12-10 23:15:55,031 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-10 23:15:57,092 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-10 23:15:58,309 - INFO - Using device: cuda
2025-12-10 23:16:02,031 - INFO - Training configuration: epochs=30, warmup=2, lr=0.000125
2025-12-10 23:16:05,288 - INFO - SWIN configuration: variant=tiny, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False
2025-12-10 23:16:08,562 - INFO - SWIN details: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7
2025-12-10 23:16:17,967 - INFO - Loading dataset...
2025-12-10 23:16:19,330 - INFO - Starting ImageNet data loading from root: /
2025-12-10 23:16:22,388 - INFO - Resolved root path: /
2025-12-10 23:16:22,907 - INFO - Root path exists: True
2025-12-10 23:16:23,777 - INFO - Root path is dir: True
2025-12-10 23:16:24,416 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-10 23:16:25,797 - INFO - Expected train_dir: /train_set, exists: True
2025-12-10 23:16:26,499 - INFO - Expected val_dir: /val_set, exists: True
2025-12-10 23:16:45,132 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-10 23:16:45,709 - INFO - Dataset loaded: train=50000 samples (391 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-10 23:16:55,115 - INFO - Training Swin-Tiny from scratch
2025-12-10 23:16:55,149 - INFO - Initializing model from scratch...
2025-12-10 23:16:55,153 - INFO - Model architecture: Swin-Tiny
2025-12-10 23:16:55,157 - INFO - Model config: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False
2025-12-10 23:16:56,882 - INFO - Model created with random initialization
2025-12-10 23:16:56,883 - INFO - Total parameters: 28,288,354
2025-12-10 23:16:56,884 - INFO - Trainable parameters: 28,288,354
2025-12-10 23:16:57,151 - INFO - Starting from-scratch training...
2025-12-10 23:16:57,175 - INFO - Optimizer: training all model parameters
2025-12-10 23:16:57,184 - INFO - LR Scheduler: cosine with 2 warmup epochs
2025-12-10 23:16:57,185 - INFO - Starting training...
2025-12-10 23:17:33,214 - ERROR - Experiment failed with error: CUDA out of memory. Tried to allocate 58.00 MiB. GPU 0 has a total capacity of 11.60 GiB of which 60.31 MiB is free. Including non-PyTorch memory, this process has 11.53 GiB memory in use. Of the allocated memory 11.21 GiB is allocated by PyTorch, and 140.09 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-10 23:17:33,223 - ERROR - Full traceback:
Traceback (most recent call last):
  File "/home/pml04/swin_transformer/Machine-Learning-Project/main.py", line 212, in main
    run_from_scratch(
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/from_scratch.py", line 235, in run_from_scratch
    criterion, lr_history, metrics_history = _train_single_model(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/from_scratch.py", line 135, in _train_single_model
    run_training_loop(
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/training/trainer.py", line 165, in run_training_loop
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/training/trainer.py", line 64, in train_one_epoch
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/models/model_wrapper.py", line 35, in forward
    features = self.encoder(x)
               ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/models/swin/swin_transformer_model.py", line 177, in forward
    x = self.forward_features(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/models/swin/swin_transformer_model.py", line 171, in forward_features
    x = layer(x)
        ^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/models/swin/basic_layer.py", line 201, in forward
    x = block(x)
        ^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/models/swin/swin_transformer_block.py", line 223, in forward
    attn_windows = self.attn(x_windows, attn_mask)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/models/swin/window_attention.py", line 132, in forward
    scores = torch.matmul(q, k.transpose(-2, -1)) * (self.head_dim**-0.5)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 58.00 MiB. GPU 0 has a total capacity of 11.60 GiB of which 60.31 MiB is free. Including non-PyTorch memory, this process has 11.53 GiB memory in use. Of the allocated memory 11.21 GiB is allocated by PyTorch, and 140.09 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
=======
=======
>>>>>>> Stashed changes
=======
>>>>>>> Stashed changes
=======
>>>>>>> Stashed changes
2025-12-10 23:11:56,677 - INFO - Logging initialized. Log file: runs/run_156/training.log
2025-12-10 23:11:56,678 - INFO - Logging initialized. Log file: runs/run_156/training.log
2025-12-10 23:11:56,693 - INFO - Experiment directory: runs/run_156
2025-12-10 23:11:56,694 - INFO - Experiment directory: runs/run_156
2025-12-10 23:11:56,695 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-10 23:11:56,695 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-10 23:11:56,850 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-10 23:11:56,852 - INFO - Using device: cuda
2025-12-10 23:11:56,854 - INFO - Training configuration: epochs=30, warmup=2, lr=0.000125
2025-12-10 23:11:56,856 - INFO - SWIN configuration: variant=tiny, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False
2025-12-10 23:11:56,858 - INFO - SWIN details: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7
2025-12-10 23:11:56,860 - INFO - Loading dataset...
2025-12-10 23:11:56,865 - INFO - Starting ImageNet data loading from root: /
2025-12-10 23:11:56,867 - INFO - Resolved root path: /
2025-12-10 23:11:56,869 - INFO - Root path exists: True
2025-12-10 23:11:56,871 - INFO - Root path is dir: True
2025-12-10 23:11:56,877 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var']
2025-12-10 23:11:56,879 - INFO - Expected train_dir: /train_set, exists: False
2025-12-10 23:11:56,881 - INFO - Expected val_dir: /val_set, exists: False
2025-12-10 23:11:56,882 - ERROR - Experiment failed with error: ImageNet data not found in /. Expected 'train_set' and 'val_set' subfolders.
2025-12-10 23:11:56,918 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-10 23:11:56,919 - INFO - Using device: cuda
2025-12-10 23:11:56,921 - INFO - Training configuration: epochs=30, warmup=2, lr=0.000125
2025-12-10 23:11:56,923 - INFO - SWIN configuration: variant=tiny, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False
2025-12-10 23:11:56,924 - INFO - SWIN details: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7
2025-12-10 23:11:56,926 - INFO - Loading dataset...
2025-12-10 23:11:56,931 - INFO - Starting ImageNet data loading from root: /
2025-12-10 23:11:56,934 - INFO - Resolved root path: /
2025-12-10 23:11:56,936 - INFO - Root path exists: True
2025-12-10 23:11:56,937 - INFO - Root path is dir: True
2025-12-10 23:11:56,943 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var']
2025-12-10 23:11:56,945 - INFO - Expected train_dir: /train_set, exists: False
2025-12-10 23:11:56,947 - INFO - Expected val_dir: /val_set, exists: False
2025-12-10 23:11:56,949 - ERROR - Experiment failed with error: ImageNet data not found in /. Expected 'train_set' and 'val_set' subfolders.
2025-12-10 23:11:56,884 - ERROR - Full traceback:
Traceback (most recent call last):
  File "/home/pml04/swin_transformer/Machine-Learning-Project/main.py", line 175, in main
    train_generator, val_generator, test_generator = load_data(
                                                     ^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/data/dataloader.py", line 344, in load_data
    train_dataset, val_dataset, test_dataset = _load_imagenet_data(
                                               ^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/data/dataloader.py", line 185, in _load_imagenet_data
    raise FileNotFoundError(
FileNotFoundError: ImageNet data not found in /. Expected 'train_set' and 'val_set' subfolders.
2025-12-10 23:11:56,950 - ERROR - Full traceback:
Traceback (most recent call last):
  File "/home/pml04/swin_transformer/Machine-Learning-Project/main.py", line 175, in main
    train_generator, val_generator, test_generator = load_data(
                                                     ^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/data/dataloader.py", line 344, in load_data
    train_dataset, val_dataset, test_dataset = _load_imagenet_data(
                                               ^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/data/dataloader.py", line 185, in _load_imagenet_data
    raise FileNotFoundError(
FileNotFoundError: ImageNet data not found in /. Expected 'train_set' and 'val_set' subfolders.
<<<<<<< Updated upstream
<<<<<<< Updated upstream
<<<<<<< Updated upstream
>>>>>>> Stashed changes
=======
>>>>>>> Stashed changes
=======
>>>>>>> Stashed changes
=======
>>>>>>> Stashed changes
