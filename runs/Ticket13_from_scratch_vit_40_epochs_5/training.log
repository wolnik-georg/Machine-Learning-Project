2025-12-20 21:38:09,533 - INFO - Logging initialized. Log file: runs/run_231/training.log
2025-12-20 21:38:09,575 - INFO - Experiment directory: runs/run_231
2025-12-20 21:38:09,577 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-20 21:38:09,684 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-20 21:38:10,140 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-20 21:38:10,142 - INFO - Using device: cuda
2025-12-20 21:38:10,144 - INFO - Training configuration: epochs=40, warmup=3, lr=0.0005
2025-12-20 21:38:10,145 - INFO - VIT configuration: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-20 21:38:10,147 - INFO - Loading dataset...
2025-12-20 21:38:10,150 - INFO - Starting ImageNet data loading from root: /
2025-12-20 21:38:10,152 - INFO - Resolved root path: /
2025-12-20 21:38:10,154 - INFO - Root path exists: True
2025-12-20 21:38:10,156 - INFO - Root path is dir: True
2025-12-20 21:38:10,165 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-20 21:38:10,167 - INFO - Expected train_dir: /train_set, exists: True
2025-12-20 21:38:10,169 - INFO - Expected val_dir: /val_set, exists: True
2025-12-20 21:38:33,876 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-20 21:38:34,261 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-20 21:38:39,910 - INFO - Training VIT from scratch
2025-12-20 21:38:39,937 - INFO - Initializing VIT model from scratch...
2025-12-20 21:38:39,939 - INFO - Model architecture: VIT
2025-12-20 21:38:39,941 - INFO - Model config: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-20 21:38:41,251 - INFO - Model created with random initialization
2025-12-20 21:38:41,253 - INFO - Total parameters: 29,854,376
2025-12-20 21:38:41,255 - INFO - Trainable parameters: 29,854,376
2025-12-20 21:38:41,356 - INFO - Starting from-scratch training...
2025-12-20 21:38:41,358 - INFO - Optimizer: training all model parameters
2025-12-20 21:38:41,362 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-20 21:38:41,364 - INFO - Starting training...
2025-12-20 22:25:44,676 - INFO - Epoch 1/40: LR: 0.000170
2025-12-20 22:25:44,775 - INFO - Epoch 1/40: Train Loss: 6.8936, Val Loss: 6.8025, Val Acc: 0.47%
2025-12-20 23:09:22,112 - INFO - Epoch 2/40: LR: 0.000335
2025-12-20 23:09:22,139 - INFO - Epoch 2/40: Train Loss: 6.7229, Val Loss: 6.4320, Val Acc: 1.36%
2025-12-20 23:52:34,775 - INFO - Epoch 3/40: LR: 0.000500
2025-12-20 23:52:34,802 - INFO - Epoch 3/40: Train Loss: 6.4499, Val Loss: 6.1307, Val Acc: 2.18%
2025-12-21 00:36:52,762 - INFO - Epoch 4/40: LR: 0.000499
2025-12-21 00:36:52,825 - INFO - Epoch 4/40: Train Loss: 6.3026, Val Loss: 6.0432, Val Acc: 2.76%
2025-12-21 01:21:31,540 - INFO - Epoch 5/40: LR: 0.000497
2025-12-21 01:35:47,014 - INFO - Epoch 5/40: Train Loss: 6.2042, Val Loss: 5.9386, Val Acc: 3.24%, Test Loss: 5.9386, Test Acc: 3.24%
2025-12-21 02:19:33,004 - INFO - Epoch 6/40: LR: 0.000493
2025-12-21 02:19:33,059 - INFO - Epoch 6/40: Train Loss: 6.1271, Val Loss: 5.8436, Val Acc: 3.72%
2025-12-21 03:04:23,095 - INFO - Epoch 7/40: LR: 0.000487
2025-12-21 03:04:23,148 - INFO - Epoch 7/40: Train Loss: 6.0698, Val Loss: 5.8437, Val Acc: 3.90%
2025-12-21 03:47:48,152 - INFO - Epoch 8/40: LR: 0.000480
2025-12-21 03:47:48,178 - INFO - Epoch 8/40: Train Loss: 6.0066, Val Loss: 5.7276, Val Acc: 4.62%
2025-12-21 04:31:09,736 - INFO - Epoch 9/40: LR: 0.000471
2025-12-21 04:31:09,757 - INFO - Epoch 9/40: Train Loss: 5.9395, Val Loss: 5.6882, Val Acc: 4.92%
2025-12-21 05:14:33,458 - INFO - Epoch 10/40: LR: 0.000461
2025-12-21 05:28:47,073 - INFO - Epoch 10/40: Train Loss: 5.8559, Val Loss: 5.5730, Val Acc: 5.64%, Test Loss: 5.5730, Test Acc: 5.64%
2025-12-21 05:28:47,075 - INFO - Saving checkpoint for epoch 10...
2025-12-21 05:28:48,350 - INFO - ✅ Checkpoint saved: runs/run_231/checkpoint_epoch_10.pth
2025-12-21 06:12:52,498 - INFO - Epoch 11/40: LR: 0.000450
2025-12-21 06:12:52,547 - INFO - Epoch 11/40: Train Loss: 5.7700, Val Loss: 5.4775, Val Acc: 6.42%
2025-12-21 06:57:10,320 - INFO - Epoch 12/40: LR: 0.000437
2025-12-21 06:57:10,355 - INFO - Epoch 12/40: Train Loss: 5.6896, Val Loss: 5.4415, Val Acc: 6.68%
2025-12-21 07:40:58,870 - INFO - Epoch 13/40: LR: 0.000424
2025-12-21 07:40:58,918 - INFO - Epoch 13/40: Train Loss: 5.6285, Val Loss: 5.3570, Val Acc: 7.24%
2025-12-21 08:24:23,636 - INFO - Epoch 14/40: LR: 0.000409
2025-12-21 08:24:23,678 - INFO - Epoch 14/40: Train Loss: 5.5430, Val Loss: 5.2580, Val Acc: 8.13%
2025-12-21 09:07:57,562 - INFO - Epoch 15/40: LR: 0.000393
2025-12-21 09:22:13,362 - INFO - Epoch 15/40: Train Loss: 5.4594, Val Loss: 5.2284, Val Acc: 8.38%, Test Loss: 5.2284, Test Acc: 8.38%
2025-12-21 10:05:23,298 - INFO - Epoch 16/40: LR: 0.000376
2025-12-21 10:05:23,343 - INFO - Epoch 16/40: Train Loss: 5.3876, Val Loss: 5.1532, Val Acc: 8.92%
2025-12-21 10:49:09,927 - INFO - Epoch 17/40: LR: 0.000359
2025-12-21 10:49:09,978 - INFO - Epoch 17/40: Train Loss: 5.3084, Val Loss: 5.0844, Val Acc: 9.85%
2025-12-21 11:32:29,199 - INFO - Epoch 18/40: LR: 0.000341
2025-12-21 11:32:29,204 - INFO - Epoch 18/40: Train Loss: 5.2320, Val Loss: 5.0416, Val Acc: 9.95%
2025-12-21 12:15:58,234 - INFO - Epoch 19/40: LR: 0.000322
2025-12-21 12:15:58,301 - INFO - Epoch 19/40: Train Loss: 5.1498, Val Loss: 4.9647, Val Acc: 10.88%
2025-12-21 12:59:44,863 - INFO - Epoch 20/40: LR: 0.000304
2025-12-21 13:14:00,407 - INFO - Epoch 20/40: Train Loss: 5.0768, Val Loss: 4.9523, Val Acc: 11.26%, Test Loss: 4.9523, Test Acc: 11.26%
2025-12-21 13:14:00,455 - INFO - Saving checkpoint for epoch 20...
2025-12-21 13:14:01,735 - INFO - ✅ Checkpoint saved: runs/run_231/checkpoint_epoch_20.pth
2025-12-21 13:58:29,327 - INFO - Epoch 21/40: LR: 0.000285
2025-12-21 13:58:29,364 - INFO - Epoch 21/40: Train Loss: 5.0028, Val Loss: 4.8656, Val Acc: 11.82%
2025-12-21 14:41:34,260 - INFO - Epoch 22/40: LR: 0.000265
2025-12-21 14:41:34,332 - INFO - Epoch 22/40: Train Loss: 4.9211, Val Loss: 4.8568, Val Acc: 11.93%
2025-12-21 15:25:52,876 - INFO - Epoch 23/40: LR: 0.000246
2025-12-21 15:25:52,931 - INFO - Epoch 23/40: Train Loss: 4.8477, Val Loss: 4.7985, Val Acc: 12.81%
2025-12-21 16:10:49,475 - INFO - Epoch 24/40: LR: 0.000228
2025-12-21 16:10:49,512 - INFO - Epoch 24/40: Train Loss: 4.7727, Val Loss: 4.7345, Val Acc: 13.54%
2025-12-21 16:54:53,074 - INFO - Epoch 25/40: LR: 0.000209
2025-12-21 17:09:07,925 - INFO - Epoch 25/40: Train Loss: 4.6953, Val Loss: 4.7079, Val Acc: 13.80%, Test Loss: 4.7079, Test Acc: 13.80%
2025-12-21 17:52:27,127 - INFO - Epoch 26/40: LR: 0.000191
2025-12-21 17:52:27,173 - INFO - Epoch 26/40: Train Loss: 4.6195, Val Loss: 4.6870, Val Acc: 14.21%
2025-12-21 18:36:04,998 - INFO - Epoch 27/40: LR: 0.000174
2025-12-21 18:36:05,028 - INFO - Epoch 27/40: Train Loss: 4.5439, Val Loss: 4.6295, Val Acc: 15.05%
2025-12-21 19:20:09,118 - INFO - Epoch 28/40: LR: 0.000157
2025-12-21 19:20:09,153 - INFO - Epoch 28/40: Train Loss: 4.4680, Val Loss: 4.6072, Val Acc: 15.18%
2025-12-21 20:04:12,536 - INFO - Epoch 29/40: LR: 0.000141
2025-12-21 20:04:12,599 - INFO - Epoch 29/40: Train Loss: 4.3939, Val Loss: 4.5661, Val Acc: 15.68%
2025-12-21 20:47:23,500 - INFO - Epoch 30/40: LR: 0.000126
2025-12-21 21:01:30,959 - INFO - Epoch 30/40: Train Loss: 4.3221, Val Loss: 4.5898, Val Acc: 15.72%, Test Loss: 4.5898, Test Acc: 15.72%
2025-12-21 21:01:31,649 - INFO - Saving checkpoint for epoch 30...
2025-12-21 21:01:33,066 - INFO - ✅ Checkpoint saved: runs/run_231/checkpoint_epoch_30.pth
2025-12-21 21:45:11,945 - INFO - Epoch 31/40: LR: 0.000113
2025-12-21 21:45:12,096 - INFO - Epoch 31/40: Train Loss: 4.2653, Val Loss: 4.5377, Val Acc: 16.37%
2025-12-21 22:29:13,817 - INFO - Epoch 32/40: LR: 0.000100
2025-12-21 22:29:13,866 - INFO - Epoch 32/40: Train Loss: 4.1984, Val Loss: 4.5595, Val Acc: 16.15%
2025-12-21 23:13:46,340 - INFO - Epoch 33/40: LR: 0.000089
2025-12-21 23:13:46,404 - INFO - Epoch 33/40: Train Loss: 4.1442, Val Loss: 4.5132, Val Acc: 16.92%
2025-12-21 23:58:10,145 - INFO - Epoch 34/40: LR: 0.000079
2025-12-21 23:58:10,176 - INFO - Epoch 34/40: Train Loss: 4.0816, Val Loss: 4.5111, Val Acc: 16.90%
2025-12-22 00:42:00,630 - INFO - Epoch 35/40: LR: 0.000070
2025-12-22 00:56:21,144 - INFO - Epoch 35/40: Train Loss: 4.0394, Val Loss: 4.4875, Val Acc: 17.15%, Test Loss: 4.4875, Test Acc: 17.15%
2025-12-22 01:41:23,903 - INFO - Epoch 36/40: LR: 0.000063
2025-12-22 01:41:23,978 - INFO - Epoch 36/40: Train Loss: 3.9878, Val Loss: 4.4800, Val Acc: 17.44%
2025-12-22 02:25:13,587 - INFO - Epoch 37/40: LR: 0.000057
2025-12-22 02:25:13,626 - INFO - Epoch 37/40: Train Loss: 3.9455, Val Loss: 4.4749, Val Acc: 17.50%
2025-12-22 03:07:59,011 - INFO - Epoch 38/40: LR: 0.000053
2025-12-22 03:07:59,041 - INFO - Epoch 38/40: Train Loss: 3.9011, Val Loss: 4.4601, Val Acc: 17.63%
2025-12-22 03:51:09,217 - INFO - Epoch 39/40: LR: 0.000051
2025-12-22 03:51:09,250 - INFO - Epoch 39/40: Train Loss: 3.8776, Val Loss: 4.4646, Val Acc: 17.52%
2025-12-22 04:34:14,277 - INFO - Epoch 40/40: LR: 0.000050
2025-12-22 04:48:31,143 - INFO - Epoch 40/40: Train Loss: 3.8429, Val Loss: 4.4591, Val Acc: 17.63%, Test Loss: 4.4591, Test Acc: 17.63%
2025-12-22 04:48:31,170 - INFO - Saving checkpoint for epoch 40...
2025-12-22 04:48:32,430 - INFO - ✅ Checkpoint saved: runs/run_231/checkpoint_epoch_40.pth
2025-12-22 04:48:32,432 - INFO - Training completed!
2025-12-22 04:48:32,435 - INFO - Training completed!
2025-12-22 04:48:32,436 - INFO - Generating training curves...
2025-12-22 04:48:36,713 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-22 04:48:36,716 - INFO - Training curves saved as separate images with base name 'runs/run_231/training_curves_from_scratch'
2025-12-22 04:48:36,717 - INFO - Generating confusion matrix on test set...
2025-12-22 05:54:31,557 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-22 06:09:58,056 - INFO - Final Test Results of from_scratch model: Loss: 4.4591, Accuracy: 17.63%
2025-12-22 06:09:58,081 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-22 06:09:58,956 - INFO - LR schedule plot saved to 'runs/run_231/lr_schedule_from_scratch.png'
2025-12-22 06:09:58,958 - INFO - 
Final Test Results:
2025-12-22 06:09:58,959 - INFO - Loss: 4.4591
2025-12-22 06:09:58,960 - INFO - Accuracy: 17.63%
2025-12-22 06:09:58,962 - INFO - Precision: 16.05%
2025-12-22 06:09:58,963 - INFO - Recall: 17.63%
2025-12-22 06:09:58,965 - INFO - F1 Score: 16.12%
2025-12-22 06:09:59,692 - INFO - Experiment completed. Results saved to runs/run_231/results_from_scratch.json
2025-12-22 06:09:59,698 - INFO - Experiment completed. Metadata saved to runs/run_231/metadata_from_scratch.json
2025-12-22 06:10:00,128 - INFO - ✅ Model weights saved: runs/run_231/final_model_from_scratch_weights.pth
2025-12-22 06:10:00,133 - INFO - Final model saved: runs/run_231/final_model_from_scratch_weights.pth
2025-12-22 06:10:00,134 - INFO - Final model metadata saved: runs/run_231/final_model_from_scratch_metadata.json
2025-12-22 06:10:00,136 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-22 06:10:00,137 - INFO - Final Accuracy: 17.63%
2025-12-22 06:10:00,139 - INFO - Final F1 Score: 16.12%
2025-12-22 06:10:00,145 - INFO - from_scratch experiment completed successfully!
