2025-12-07 12:17:14,268 - INFO - Logging initialized. Log file: runs/run_113/training.log
2025-12-07 12:17:14,270 - INFO - Experiment directory: runs/run_113
2025-12-07 12:17:14,271 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-07 12:17:14,494 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-07 12:17:14,496 - INFO - Using device: cuda
2025-12-07 12:17:14,498 - INFO - Training configuration: epochs=20, warmup=3, lr=0.0005
2025-12-07 12:17:14,500 - INFO - SWIN configuration: variant=tiny, use_shifted_window=True
2025-12-07 12:17:14,502 - INFO - SWIN details: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=14
2025-12-07 12:17:14,503 - INFO - Loading dataset...
2025-12-07 12:17:14,505 - INFO - Starting ImageNet data loading from root: /
2025-12-07 12:17:14,507 - INFO - Resolved root path: /
2025-12-07 12:17:14,509 - INFO - Root path exists: True
2025-12-07 12:17:14,511 - INFO - Root path is dir: True
2025-12-07 12:17:14,517 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-07 12:17:14,519 - INFO - Expected train_dir: /train_set, exists: True
2025-12-07 12:17:14,520 - INFO - Expected val_dir: /val_set, exists: True
2025-12-07 12:17:21,122 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-07 12:17:21,244 - INFO - Dataset loaded: train=50000 samples (391 batches), val=5000 samples (40 batches), test=5000 samples (40 batches)
2025-12-07 12:17:23,574 - INFO - Training Swin-Tiny from scratch
2025-12-07 12:17:23,576 - INFO - Initializing model from scratch...
2025-12-07 12:17:23,578 - INFO - Model architecture: Swin-Tiny
2025-12-07 12:17:23,579 - INFO - Model config: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=14, use_shifted_window=True
2025-12-07 12:17:23,816 - WARNING - Window size 14 doesn't divide input resolution [7, 7] evenly. Adjusting window_size to 7 and shift_size to 0.
2025-12-07 12:17:23,855 - WARNING - Window size 14 doesn't divide input resolution [7, 7] evenly. Adjusting window_size to 7 and shift_size to 0.
2025-12-07 12:17:24,104 - INFO - Model created with random initialization
2025-12-07 12:17:24,106 - INFO - Total parameters: 28,338,754
2025-12-07 12:17:24,107 - INFO - Trainable parameters: 28,338,754
2025-12-07 12:17:24,437 - INFO - Starting from-scratch training...
2025-12-07 12:17:24,439 - INFO - Optimizer: training all model parameters
2025-12-07 12:17:24,442 - INFO - Starting training...
2025-12-07 12:36:43,579 - INFO - Epoch 1/20: LR: 0.000170
2025-12-07 12:36:43,599 - INFO - Epoch 1/20: Train Loss: 6.9053, Val Loss: 6.8248, Val Acc: 0.40%
2025-12-07 12:52:17,820 - INFO - Epoch 2/20: LR: 0.000335
2025-12-07 12:52:17,853 - INFO - Epoch 2/20: Train Loss: 6.8229, Val Loss: 6.7167, Val Acc: 0.38%
2025-12-07 13:09:36,676 - INFO - Epoch 3/20: LR: 0.000500
2025-12-07 13:09:36,700 - INFO - Epoch 3/20: Train Loss: 6.7547, Val Loss: 6.6207, Val Acc: 0.60%
2025-12-07 13:24:25,942 - INFO - Epoch 4/20: LR: 0.000496
2025-12-07 13:24:25,974 - INFO - Epoch 4/20: Train Loss: 6.6723, Val Loss: 6.5127, Val Acc: 0.84%
2025-12-07 13:39:14,048 - INFO - Epoch 5/20: LR: 0.000483
2025-12-07 13:40:38,292 - INFO - Epoch 5/20: Train Loss: 6.4995, Val Loss: 6.3267, Val Acc: 1.38%, Test Loss: 6.3267, Test Acc: 1.38%
2025-12-07 13:55:25,936 - INFO - Epoch 6/20: LR: 0.000463
2025-12-07 13:55:25,938 - INFO - Epoch 6/20: Train Loss: 6.3724, Val Loss: 6.1854, Val Acc: 1.66%
2025-12-07 14:10:13,483 - INFO - Epoch 7/20: LR: 0.000435
2025-12-07 14:10:13,485 - INFO - Epoch 7/20: Train Loss: 6.2830, Val Loss: 6.0852, Val Acc: 2.14%
2025-12-07 14:25:00,962 - INFO - Epoch 8/20: LR: 0.000401
2025-12-07 14:25:01,009 - INFO - Epoch 8/20: Train Loss: 6.1904, Val Loss: 6.0269, Val Acc: 2.20%
2025-12-07 14:39:50,634 - INFO - Epoch 9/20: LR: 0.000362
2025-12-07 14:39:50,648 - INFO - Epoch 9/20: Train Loss: 6.1113, Val Loss: 5.9444, Val Acc: 3.08%
2025-12-07 14:54:43,006 - INFO - Epoch 10/20: LR: 0.000319
2025-12-07 14:56:06,808 - INFO - Epoch 10/20: Train Loss: 6.0350, Val Loss: 5.8469, Val Acc: 3.42%, Test Loss: 5.8469, Test Acc: 3.42%
2025-12-07 14:56:06,810 - INFO - Saving checkpoint for epoch 10...
2025-12-07 14:56:07,621 - INFO - ✅ Checkpoint saved: runs/run_113/checkpoint_epoch_10.pth
2025-12-07 15:11:06,162 - INFO - Epoch 11/20: LR: 0.000274
2025-12-07 15:11:06,164 - INFO - Epoch 11/20: Train Loss: 5.9518, Val Loss: 5.7791, Val Acc: 3.74%
2025-12-07 15:25:53,144 - INFO - Epoch 12/20: LR: 0.000227
2025-12-07 15:25:53,158 - INFO - Epoch 12/20: Train Loss: 5.8540, Val Loss: 5.6559, Val Acc: 4.36%
2025-12-07 15:40:41,793 - INFO - Epoch 13/20: LR: 0.000182
2025-12-07 15:40:41,795 - INFO - Epoch 13/20: Train Loss: 5.7622, Val Loss: 5.5724, Val Acc: 4.76%
2025-12-07 15:55:27,879 - INFO - Epoch 14/20: LR: 0.000139
2025-12-07 15:55:27,902 - INFO - Epoch 14/20: Train Loss: 5.6690, Val Loss: 5.4555, Val Acc: 5.56%
2025-12-07 16:10:14,352 - INFO - Epoch 15/20: LR: 0.000100
2025-12-07 16:11:39,406 - INFO - Epoch 15/20: Train Loss: 5.5812, Val Loss: 5.3875, Val Acc: 5.96%, Test Loss: 5.3875, Test Acc: 5.96%
2025-12-07 16:26:28,204 - INFO - Epoch 16/20: LR: 0.000066
2025-12-07 16:26:28,377 - INFO - Epoch 16/20: Train Loss: 5.4833, Val Loss: 5.3128, Val Acc: 7.00%
2025-12-07 16:41:28,783 - INFO - Epoch 17/20: LR: 0.000038
2025-12-07 16:41:30,194 - INFO - Epoch 17/20: Train Loss: 5.4285, Val Loss: 5.2659, Val Acc: 7.62%
2025-12-07 16:56:42,583 - INFO - Epoch 18/20: LR: 0.000018
2025-12-07 16:56:42,592 - INFO - Epoch 18/20: Train Loss: 5.3768, Val Loss: 5.2150, Val Acc: 7.52%
2025-12-07 17:11:49,487 - INFO - Epoch 19/20: LR: 0.000005
2025-12-07 17:11:49,496 - INFO - Epoch 19/20: Train Loss: 5.3365, Val Loss: 5.2080, Val Acc: 7.82%
2025-12-07 17:26:50,152 - INFO - Epoch 20/20: LR: 0.000001
2025-12-07 17:28:15,813 - INFO - Epoch 20/20: Train Loss: 5.3183, Val Loss: 5.1953, Val Acc: 8.02%, Test Loss: 5.1953, Test Acc: 8.02%
2025-12-07 17:28:15,815 - INFO - Saving checkpoint for epoch 20...
2025-12-07 17:28:16,614 - INFO - ✅ Checkpoint saved: runs/run_113/checkpoint_epoch_20.pth
2025-12-07 17:28:16,615 - INFO - Training completed!
2025-12-07 17:28:16,619 - INFO - Training completed!
2025-12-07 17:28:16,620 - INFO - Generating training curves...
2025-12-07 17:28:18,238 - WARNING - Inhomogeneous shapes in per-class F1 data: [(997,), (996,), (997,), (997,), (997,), (998,), (998,), (997,), (997,), (998,), (998,), (998,), (999,), (997,), (999,), (1000,), (1000,), (1000,), (999,), (999,)]. Skipping per-class plotting.
2025-12-07 17:28:18,240 - INFO - Training curves saved as separate images with base name 'runs/run_113/training_curves_from_scratch'
2025-12-07 17:28:18,242 - INFO - Generating confusion matrix on test set...
