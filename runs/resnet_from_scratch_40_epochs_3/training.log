2025-12-23 15:20:57,135 - INFO - Logging initialized. Log file: runs/run_237/training.log
2025-12-23 15:20:57,362 - INFO - Experiment directory: runs/run_237
2025-12-23 15:20:57,364 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-23 15:20:57,432 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-23 15:20:57,872 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-23 15:20:57,874 - INFO - Using device: cuda
2025-12-23 15:20:57,876 - INFO - Training configuration: epochs=40, warmup=3, lr=0.0005
2025-12-23 15:20:57,877 - INFO - RESNET configuration: {'type': 'resnet', 'layers': [3, 4, 6, 3], 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-23 15:20:57,879 - INFO - Loading dataset...
2025-12-23 15:20:57,882 - INFO - Starting ImageNet data loading from root: /
2025-12-23 15:20:57,884 - INFO - Resolved root path: /
2025-12-23 15:20:57,885 - INFO - Root path exists: True
2025-12-23 15:20:57,887 - INFO - Root path is dir: True
2025-12-23 15:20:57,898 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-23 15:20:57,900 - INFO - Expected train_dir: /train_set, exists: True
2025-12-23 15:20:57,901 - INFO - Expected val_dir: /val_set, exists: True
2025-12-23 15:21:12,237 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-23 15:21:12,578 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-23 15:21:17,865 - INFO - Training RESNET from scratch
2025-12-23 15:21:17,901 - INFO - Initializing RESNET model from scratch...
2025-12-23 15:21:17,902 - INFO - Model architecture: RESNET
2025-12-23 15:21:17,904 - INFO - Model config: {'type': 'resnet', 'layers': [3, 4, 6, 3], 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-23 15:21:19,179 - INFO - Model created with random initialization
2025-12-23 15:21:19,182 - INFO - Total parameters: 25,557,032
2025-12-23 15:21:19,183 - INFO - Trainable parameters: 25,557,032
2025-12-23 15:21:19,292 - INFO - Starting from-scratch training...
2025-12-23 15:21:19,293 - INFO - Optimizer: training all model parameters
2025-12-23 15:21:19,297 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-23 15:21:19,299 - INFO - Starting training...
2025-12-23 16:11:08,936 - INFO - Epoch 1/40: LR: 0.000170
2025-12-23 16:11:09,123 - INFO - Epoch 1/40: Train Loss: 6.9446, Val Loss: 6.8903, Val Acc: 0.16%
2025-12-23 16:53:11,213 - INFO - Epoch 2/40: LR: 0.000335
2025-12-23 16:53:11,336 - INFO - Epoch 2/40: Train Loss: 6.8489, Val Loss: 6.6483, Val Acc: 0.56%
2025-12-23 17:34:28,352 - INFO - Epoch 3/40: LR: 0.000500
2025-12-23 17:34:28,382 - INFO - Epoch 3/40: Train Loss: 6.4780, Val Loss: 6.3863, Val Acc: 1.05%
2025-12-23 18:15:10,975 - INFO - Epoch 4/40: LR: 0.000499
2025-12-23 18:15:11,088 - INFO - Epoch 4/40: Train Loss: 6.2002, Val Loss: 6.1389, Val Acc: 2.18%
2025-12-23 18:56:10,778 - INFO - Epoch 5/40: LR: 0.000497
2025-12-23 19:09:50,862 - INFO - Epoch 5/40: Train Loss: 5.9227, Val Loss: 5.6115, Val Acc: 3.96%, Test Loss: 5.6115, Test Acc: 3.96%
2025-12-23 19:50:27,906 - INFO - Epoch 6/40: LR: 0.000493
2025-12-23 19:50:28,026 - INFO - Epoch 6/40: Train Loss: 5.7093, Val Loss: 5.4656, Val Acc: 4.92%
2025-12-23 20:31:38,734 - INFO - Epoch 7/40: LR: 0.000487
2025-12-23 20:31:38,781 - INFO - Epoch 7/40: Train Loss: 5.5092, Val Loss: 5.3551, Val Acc: 5.94%
2025-12-23 21:11:37,701 - INFO - Epoch 8/40: LR: 0.000480
2025-12-23 21:11:37,780 - INFO - Epoch 8/40: Train Loss: 5.3003, Val Loss: 5.1781, Val Acc: 8.01%
2025-12-23 21:52:11,785 - INFO - Epoch 9/40: LR: 0.000471
2025-12-23 21:52:11,849 - INFO - Epoch 9/40: Train Loss: 5.1143, Val Loss: 4.7929, Val Acc: 10.94%
2025-12-23 22:33:08,639 - INFO - Epoch 10/40: LR: 0.000461
2025-12-23 22:46:57,022 - INFO - Epoch 10/40: Train Loss: 4.9272, Val Loss: 4.5666, Val Acc: 13.34%, Test Loss: 4.5666, Test Acc: 13.34%
2025-12-23 22:46:57,047 - INFO - Saving checkpoint for epoch 10...
2025-12-23 22:46:59,089 - INFO - ✅ Checkpoint saved: runs/run_237/checkpoint_epoch_10.pth
2025-12-23 23:27:10,189 - INFO - Epoch 11/40: LR: 0.000450
2025-12-23 23:27:10,309 - INFO - Epoch 11/40: Train Loss: 4.7404, Val Loss: 4.4488, Val Acc: 14.48%
2025-12-24 00:07:37,935 - INFO - Epoch 12/40: LR: 0.000437
2025-12-24 00:07:37,973 - INFO - Epoch 12/40: Train Loss: 4.5726, Val Loss: 4.1978, Val Acc: 17.40%
2025-12-24 00:48:21,083 - INFO - Epoch 13/40: LR: 0.000424
2025-12-24 00:48:21,147 - INFO - Epoch 13/40: Train Loss: 4.4198, Val Loss: 4.0063, Val Acc: 19.86%
2025-12-24 01:28:27,028 - INFO - Epoch 14/40: LR: 0.000409
2025-12-24 01:28:27,061 - INFO - Epoch 14/40: Train Loss: 4.2697, Val Loss: 3.8923, Val Acc: 21.16%
2025-12-24 02:09:21,150 - INFO - Epoch 15/40: LR: 0.000393
2025-12-24 02:22:55,124 - INFO - Epoch 15/40: Train Loss: 4.1116, Val Loss: 3.8204, Val Acc: 22.60%, Test Loss: 3.8204, Test Acc: 22.60%
2025-12-24 03:02:57,493 - INFO - Epoch 16/40: LR: 0.000376
2025-12-24 03:02:57,528 - INFO - Epoch 16/40: Train Loss: 3.9718, Val Loss: 3.7055, Val Acc: 23.99%
2025-12-24 03:42:58,762 - INFO - Epoch 17/40: LR: 0.000359
2025-12-24 03:42:58,912 - INFO - Epoch 17/40: Train Loss: 3.8343, Val Loss: 3.6350, Val Acc: 25.47%
2025-12-24 04:23:29,553 - INFO - Epoch 18/40: LR: 0.000341
2025-12-24 04:23:29,586 - INFO - Epoch 18/40: Train Loss: 3.7203, Val Loss: 3.4974, Val Acc: 27.21%
2025-12-24 05:03:19,475 - INFO - Epoch 19/40: LR: 0.000322
2025-12-24 05:03:19,526 - INFO - Epoch 19/40: Train Loss: 3.6058, Val Loss: 3.4982, Val Acc: 27.63%
2025-12-24 05:43:10,148 - INFO - Epoch 20/40: LR: 0.000304
2025-12-24 05:56:46,623 - INFO - Epoch 20/40: Train Loss: 3.5045, Val Loss: 3.3412, Val Acc: 29.86%, Test Loss: 3.3412, Test Acc: 29.86%
2025-12-24 05:56:46,697 - INFO - Saving checkpoint for epoch 20...
2025-12-24 05:56:47,988 - INFO - ✅ Checkpoint saved: runs/run_237/checkpoint_epoch_20.pth
2025-12-24 06:37:24,048 - INFO - Epoch 21/40: LR: 0.000285
2025-12-24 06:37:24,070 - INFO - Epoch 21/40: Train Loss: 3.3992, Val Loss: 3.3096, Val Acc: 30.73%
2025-12-24 07:17:35,151 - INFO - Epoch 22/40: LR: 0.000265
2025-12-24 07:17:35,186 - INFO - Epoch 22/40: Train Loss: 3.3013, Val Loss: 3.2183, Val Acc: 32.20%
2025-12-24 07:57:50,432 - INFO - Epoch 23/40: LR: 0.000246
2025-12-24 07:57:50,464 - INFO - Epoch 23/40: Train Loss: 3.2009, Val Loss: 3.1902, Val Acc: 32.60%
2025-12-24 08:38:47,897 - INFO - Epoch 24/40: LR: 0.000228
2025-12-24 08:38:47,921 - INFO - Epoch 24/40: Train Loss: 3.1272, Val Loss: 3.0956, Val Acc: 34.11%
2025-12-24 09:19:00,570 - INFO - Epoch 25/40: LR: 0.000209
2025-12-24 09:32:29,146 - INFO - Epoch 25/40: Train Loss: 3.0468, Val Loss: 3.0979, Val Acc: 34.50%, Test Loss: 3.0979, Test Acc: 34.50%
2025-12-24 10:13:47,401 - INFO - Epoch 26/40: LR: 0.000191
2025-12-24 10:13:47,670 - INFO - Epoch 26/40: Train Loss: 2.9747, Val Loss: 2.9980, Val Acc: 35.88%
2025-12-24 10:54:10,058 - INFO - Epoch 27/40: LR: 0.000174
2025-12-24 10:54:10,091 - INFO - Epoch 27/40: Train Loss: 2.8871, Val Loss: 2.9660, Val Acc: 36.55%
2025-12-24 11:34:54,688 - INFO - Epoch 28/40: LR: 0.000157
2025-12-24 11:34:54,740 - INFO - Epoch 28/40: Train Loss: 2.8160, Val Loss: 2.9374, Val Acc: 37.20%
2025-12-24 12:15:14,725 - INFO - Epoch 29/40: LR: 0.000141
2025-12-24 12:15:14,782 - INFO - Epoch 29/40: Train Loss: 2.7561, Val Loss: 2.9107, Val Acc: 38.17%
2025-12-24 12:55:48,394 - INFO - Epoch 30/40: LR: 0.000126
2025-12-24 13:09:25,793 - INFO - Epoch 30/40: Train Loss: 2.6957, Val Loss: 2.8687, Val Acc: 38.74%, Test Loss: 2.8687, Test Acc: 38.74%
2025-12-24 13:09:25,836 - INFO - Saving checkpoint for epoch 30...
2025-12-24 13:09:27,312 - INFO - ✅ Checkpoint saved: runs/run_237/checkpoint_epoch_30.pth
2025-12-24 13:49:33,335 - INFO - Epoch 31/40: LR: 0.000113
2025-12-24 13:49:36,028 - INFO - Epoch 31/40: Train Loss: 2.6431, Val Loss: 2.8445, Val Acc: 39.44%
2025-12-24 14:30:09,163 - INFO - Epoch 32/40: LR: 0.000100
2025-12-24 14:30:09,220 - INFO - Epoch 32/40: Train Loss: 2.5858, Val Loss: 2.8144, Val Acc: 39.94%
2025-12-24 15:10:08,232 - INFO - Epoch 33/40: LR: 0.000089
2025-12-24 15:10:08,263 - INFO - Epoch 33/40: Train Loss: 2.5459, Val Loss: 2.8043, Val Acc: 40.42%
2025-12-24 15:50:51,080 - INFO - Epoch 34/40: LR: 0.000079
2025-12-24 15:50:51,177 - INFO - Epoch 34/40: Train Loss: 2.4917, Val Loss: 2.7828, Val Acc: 40.61%
2025-12-24 16:31:19,568 - INFO - Epoch 35/40: LR: 0.000070
2025-12-24 16:44:52,653 - INFO - Epoch 35/40: Train Loss: 2.4501, Val Loss: 2.7537, Val Acc: 41.24%, Test Loss: 2.7537, Test Acc: 41.24%
2025-12-24 17:24:42,825 - INFO - Epoch 36/40: LR: 0.000063
2025-12-24 17:24:42,904 - INFO - Epoch 36/40: Train Loss: 2.4142, Val Loss: 2.7489, Val Acc: 41.17%
2025-12-24 18:05:47,865 - INFO - Epoch 37/40: LR: 0.000057
2025-12-24 18:05:47,924 - INFO - Epoch 37/40: Train Loss: 2.3802, Val Loss: 2.7246, Val Acc: 41.80%
2025-12-24 18:46:15,273 - INFO - Epoch 38/40: LR: 0.000053
2025-12-24 18:46:15,311 - INFO - Epoch 38/40: Train Loss: 2.3545, Val Loss: 2.7317, Val Acc: 42.04%
2025-12-24 19:27:02,321 - INFO - Epoch 39/40: LR: 0.000051
2025-12-24 19:27:02,353 - INFO - Epoch 39/40: Train Loss: 2.3392, Val Loss: 2.7339, Val Acc: 41.89%
2025-12-24 20:07:54,884 - INFO - Epoch 40/40: LR: 0.000050
2025-12-24 20:21:32,383 - INFO - Epoch 40/40: Train Loss: 2.3175, Val Loss: 2.7136, Val Acc: 42.21%, Test Loss: 2.7136, Test Acc: 42.21%
2025-12-24 20:21:32,417 - INFO - Saving checkpoint for epoch 40...
2025-12-24 20:21:33,682 - INFO - ✅ Checkpoint saved: runs/run_237/checkpoint_epoch_40.pth
2025-12-24 20:21:33,684 - INFO - Training completed!
2025-12-24 20:21:33,686 - INFO - Training completed!
2025-12-24 20:21:33,688 - INFO - Generating training curves...
2025-12-24 20:21:37,305 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-24 20:21:37,307 - INFO - Training curves saved as separate images with base name 'runs/run_237/training_curves_from_scratch'
2025-12-24 20:21:37,309 - INFO - Generating confusion matrix on test set...
2025-12-24 21:24:25,473 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-24 21:39:29,546 - INFO - Final Test Results of from_scratch model: Loss: 2.7136, Accuracy: 42.21%
2025-12-24 21:39:29,586 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-24 21:39:30,371 - INFO - LR schedule plot saved to 'runs/run_237/lr_schedule_from_scratch.png'
2025-12-24 21:39:30,373 - INFO - 
Final Test Results:
2025-12-24 21:39:30,374 - INFO - Loss: 2.7136
2025-12-24 21:39:30,376 - INFO - Accuracy: 42.21%
2025-12-24 21:39:30,377 - INFO - Precision: 43.04%
2025-12-24 21:39:30,378 - INFO - Recall: 42.21%
2025-12-24 21:39:30,380 - INFO - F1 Score: 41.43%
2025-12-24 21:39:31,126 - INFO - Experiment completed. Results saved to runs/run_237/results_from_scratch.json
2025-12-24 21:39:31,131 - INFO - Experiment completed. Metadata saved to runs/run_237/metadata_from_scratch.json
2025-12-24 21:39:31,609 - INFO - ✅ Model weights saved: runs/run_237/final_model_from_scratch_weights.pth
2025-12-24 21:39:31,614 - INFO - Final model saved: runs/run_237/final_model_from_scratch_weights.pth
2025-12-24 21:39:31,616 - INFO - Final model metadata saved: runs/run_237/final_model_from_scratch_metadata.json
2025-12-24 21:39:31,617 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-24 21:39:31,618 - INFO - Final Accuracy: 42.21%
2025-12-24 21:39:31,620 - INFO - Final F1 Score: 41.43%
2025-12-24 21:39:31,621 - INFO - from_scratch experiment completed successfully!
