2025-12-21 01:20:51,122 - INFO - Logging initialized. Log file: runs/run_232/training.log
2025-12-21 01:20:51,301 - INFO - Experiment directory: runs/run_232
2025-12-21 01:20:51,303 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-21 01:20:51,326 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-21 01:20:51,667 - INFO - GPU memory cleared at startup. Available: 11.6GB
2025-12-21 01:20:51,669 - INFO - Using device: cuda
2025-12-21 01:20:51,670 - INFO - Training configuration: epochs=40, warmup=3, lr=0.0005
2025-12-21 01:20:51,672 - INFO - VIT configuration: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-21 01:20:51,674 - INFO - Loading dataset...
2025-12-21 01:20:51,678 - INFO - Starting ImageNet data loading from root: /
2025-12-21 01:20:51,680 - INFO - Resolved root path: /
2025-12-21 01:20:51,682 - INFO - Root path exists: True
2025-12-21 01:20:51,684 - INFO - Root path is dir: True
2025-12-21 01:20:51,696 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-21 01:20:51,698 - INFO - Expected train_dir: /train_set, exists: True
2025-12-21 01:20:51,700 - INFO - Expected val_dir: /val_set, exists: True
2025-12-21 01:21:05,905 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-21 01:21:06,246 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-21 01:21:10,707 - INFO - Training VIT from scratch
2025-12-21 01:21:10,739 - INFO - Initializing VIT model from scratch...
2025-12-21 01:21:10,742 - INFO - Model architecture: VIT
2025-12-21 01:21:10,744 - INFO - Model config: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-21 01:21:12,032 - INFO - Model created with random initialization
2025-12-21 01:21:12,034 - INFO - Total parameters: 29,854,376
2025-12-21 01:21:12,035 - INFO - Trainable parameters: 29,854,376
2025-12-21 01:21:12,118 - INFO - Starting from-scratch training...
2025-12-21 01:21:12,120 - INFO - Optimizer: training all model parameters
2025-12-21 01:21:12,124 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-21 01:21:12,126 - INFO - Starting training...
2025-12-21 02:18:24,714 - INFO - Epoch 1/40: LR: 0.000170
2025-12-21 02:18:24,744 - INFO - Epoch 1/40: Train Loss: 6.8936, Val Loss: 6.8025, Val Acc: 0.47%
2025-12-21 03:07:00,454 - INFO - Epoch 2/40: LR: 0.000335
2025-12-21 03:07:00,509 - INFO - Epoch 2/40: Train Loss: 6.7229, Val Loss: 6.4320, Val Acc: 1.36%
2025-12-21 03:52:42,684 - INFO - Epoch 3/40: LR: 0.000500
2025-12-21 03:52:42,692 - INFO - Epoch 3/40: Train Loss: 6.4482, Val Loss: 6.1196, Val Acc: 2.27%
2025-12-21 04:37:48,226 - INFO - Epoch 4/40: LR: 0.000499
2025-12-21 04:37:48,266 - INFO - Epoch 4/40: Train Loss: 6.2953, Val Loss: 6.0721, Val Acc: 2.57%
2025-12-21 05:22:45,586 - INFO - Epoch 5/40: LR: 0.000497
2025-12-21 05:37:16,908 - INFO - Epoch 5/40: Train Loss: 6.1952, Val Loss: 5.9414, Val Acc: 3.14%, Test Loss: 5.9414, Test Acc: 3.14%
2025-12-21 06:23:34,964 - INFO - Epoch 6/40: LR: 0.000493
2025-12-21 06:23:34,996 - INFO - Epoch 6/40: Train Loss: 6.1453, Val Loss: 5.8842, Val Acc: 3.58%
2025-12-21 07:08:45,220 - INFO - Epoch 7/40: LR: 0.000487
2025-12-21 07:08:45,271 - INFO - Epoch 7/40: Train Loss: 6.0803, Val Loss: 5.8460, Val Acc: 4.04%
2025-12-21 07:54:26,267 - INFO - Epoch 8/40: LR: 0.000480
2025-12-21 07:54:26,295 - INFO - Epoch 8/40: Train Loss: 6.0369, Val Loss: 5.8301, Val Acc: 4.26%
2025-12-21 08:38:38,783 - INFO - Epoch 9/40: LR: 0.000471
2025-12-21 08:38:38,800 - INFO - Epoch 9/40: Train Loss: 5.9717, Val Loss: 5.6996, Val Acc: 4.83%
2025-12-21 09:23:10,136 - INFO - Epoch 10/40: LR: 0.000461
2025-12-21 09:37:26,856 - INFO - Epoch 10/40: Train Loss: 5.8962, Val Loss: 5.7229, Val Acc: 4.74%, Test Loss: 5.7229, Test Acc: 4.74%
2025-12-21 09:37:26,884 - INFO - Saving checkpoint for epoch 10...
2025-12-21 09:37:28,284 - INFO - ✅ Checkpoint saved: runs/run_232/checkpoint_epoch_10.pth
2025-12-21 10:21:45,963 - INFO - Epoch 11/40: LR: 0.000450
2025-12-21 10:21:45,990 - INFO - Epoch 11/40: Train Loss: 5.8136, Val Loss: 5.5043, Val Acc: 6.16%
2025-12-21 11:06:49,446 - INFO - Epoch 12/40: LR: 0.000437
2025-12-21 11:06:49,471 - INFO - Epoch 12/40: Train Loss: 5.7260, Val Loss: 5.4886, Val Acc: 6.17%
2025-12-21 11:51:54,651 - INFO - Epoch 13/40: LR: 0.000424
2025-12-21 11:51:54,659 - INFO - Epoch 13/40: Train Loss: 5.6725, Val Loss: 5.3696, Val Acc: 7.19%
2025-12-21 12:36:53,446 - INFO - Epoch 14/40: LR: 0.000409
2025-12-21 12:36:53,481 - INFO - Epoch 14/40: Train Loss: 5.5849, Val Loss: 5.3169, Val Acc: 7.54%
2025-12-21 13:22:51,169 - INFO - Epoch 15/40: LR: 0.000393
2025-12-21 13:37:15,521 - INFO - Epoch 15/40: Train Loss: 5.5018, Val Loss: 5.2728, Val Acc: 8.14%, Test Loss: 5.2728, Test Acc: 8.14%
2025-12-21 14:23:01,662 - INFO - Epoch 16/40: LR: 0.000376
2025-12-21 14:23:02,475 - INFO - Epoch 16/40: Train Loss: 5.4348, Val Loss: 5.2148, Val Acc: 8.50%
2025-12-21 15:08:00,532 - INFO - Epoch 17/40: LR: 0.000359
2025-12-21 15:08:00,592 - INFO - Epoch 17/40: Train Loss: 5.3572, Val Loss: 5.1299, Val Acc: 9.20%
2025-12-21 15:55:24,743 - INFO - Epoch 18/40: LR: 0.000341
2025-12-21 15:55:24,782 - INFO - Epoch 18/40: Train Loss: 5.2875, Val Loss: 5.0849, Val Acc: 9.61%
2025-12-21 16:43:03,016 - INFO - Epoch 19/40: LR: 0.000322
2025-12-21 16:43:03,044 - INFO - Epoch 19/40: Train Loss: 5.2080, Val Loss: 5.0080, Val Acc: 10.66%
2025-12-21 17:28:44,759 - INFO - Epoch 20/40: LR: 0.000304
2025-12-21 17:43:11,807 - INFO - Epoch 20/40: Train Loss: 5.1378, Val Loss: 4.9927, Val Acc: 10.69%, Test Loss: 4.9927, Test Acc: 10.69%
2025-12-21 17:43:11,844 - INFO - Saving checkpoint for epoch 20...
2025-12-21 17:43:13,222 - INFO - ✅ Checkpoint saved: runs/run_232/checkpoint_epoch_20.pth
2025-12-21 18:28:42,338 - INFO - Epoch 21/40: LR: 0.000285
2025-12-21 18:28:42,791 - INFO - Epoch 21/40: Train Loss: 5.0631, Val Loss: 4.9251, Val Acc: 11.43%
2025-12-21 19:14:58,268 - INFO - Epoch 22/40: LR: 0.000265
2025-12-21 19:14:58,356 - INFO - Epoch 22/40: Train Loss: 4.9829, Val Loss: 4.8621, Val Acc: 11.92%
2025-12-21 20:00:38,487 - INFO - Epoch 23/40: LR: 0.000246
2025-12-21 20:00:38,511 - INFO - Epoch 23/40: Train Loss: 4.9109, Val Loss: 4.8258, Val Acc: 12.48%
2025-12-21 20:45:58,650 - INFO - Epoch 24/40: LR: 0.000228
2025-12-21 20:45:58,653 - INFO - Epoch 24/40: Train Loss: 4.8422, Val Loss: 4.7746, Val Acc: 12.98%
2025-12-21 21:30:19,076 - INFO - Epoch 25/40: LR: 0.000209
2025-12-21 21:44:44,035 - INFO - Epoch 25/40: Train Loss: 4.7636, Val Loss: 4.7491, Val Acc: 13.41%, Test Loss: 4.7491, Test Acc: 13.41%
2025-12-21 22:33:01,872 - INFO - Epoch 26/40: LR: 0.000191
2025-12-21 22:33:02,068 - INFO - Epoch 26/40: Train Loss: 4.6897, Val Loss: 4.7015, Val Acc: 13.96%
2025-12-21 23:20:10,016 - INFO - Epoch 27/40: LR: 0.000174
2025-12-21 23:20:10,071 - INFO - Epoch 27/40: Train Loss: 4.6199, Val Loss: 4.6699, Val Acc: 14.44%
2025-12-22 00:08:07,500 - INFO - Epoch 28/40: LR: 0.000157
2025-12-22 00:08:07,543 - INFO - Epoch 28/40: Train Loss: 4.5473, Val Loss: 4.6400, Val Acc: 14.59%
2025-12-22 00:55:01,885 - INFO - Epoch 29/40: LR: 0.000141
2025-12-22 00:55:01,999 - INFO - Epoch 29/40: Train Loss: 4.4773, Val Loss: 4.6231, Val Acc: 14.91%
2025-12-22 01:43:28,405 - INFO - Epoch 30/40: LR: 0.000126
2025-12-22 01:57:46,260 - INFO - Epoch 30/40: Train Loss: 4.4069, Val Loss: 4.6093, Val Acc: 15.13%, Test Loss: 4.6093, Test Acc: 15.13%
2025-12-22 01:57:46,357 - INFO - Saving checkpoint for epoch 30...
2025-12-22 01:57:47,717 - INFO - ✅ Checkpoint saved: runs/run_232/checkpoint_epoch_30.pth
2025-12-22 02:43:47,210 - INFO - Epoch 31/40: LR: 0.000113
2025-12-22 02:43:47,261 - INFO - Epoch 31/40: Train Loss: 4.3538, Val Loss: 4.5662, Val Acc: 15.78%
2025-12-22 03:28:11,624 - INFO - Epoch 32/40: LR: 0.000100
2025-12-22 03:28:11,657 - INFO - Epoch 32/40: Train Loss: 4.2908, Val Loss: 4.5760, Val Acc: 15.78%
2025-12-22 04:12:05,285 - INFO - Epoch 33/40: LR: 0.000089
2025-12-22 04:12:05,314 - INFO - Epoch 33/40: Train Loss: 4.2373, Val Loss: 4.5345, Val Acc: 16.33%
2025-12-22 04:56:34,528 - INFO - Epoch 34/40: LR: 0.000079
2025-12-22 04:56:34,570 - INFO - Epoch 34/40: Train Loss: 4.1774, Val Loss: 4.5310, Val Acc: 16.46%
2025-12-22 05:42:53,861 - INFO - Epoch 35/40: LR: 0.000070
2025-12-22 05:57:18,767 - INFO - Epoch 35/40: Train Loss: 4.1369, Val Loss: 4.5108, Val Acc: 16.76%, Test Loss: 4.5108, Test Acc: 16.76%
2025-12-22 06:42:11,020 - INFO - Epoch 36/40: LR: 0.000063
2025-12-22 06:42:11,023 - INFO - Epoch 36/40: Train Loss: 4.0893, Val Loss: 4.5080, Val Acc: 16.85%
2025-12-22 07:27:22,556 - INFO - Epoch 37/40: LR: 0.000057
2025-12-22 07:27:22,566 - INFO - Epoch 37/40: Train Loss: 4.0480, Val Loss: 4.5016, Val Acc: 16.97%
2025-12-22 08:11:21,130 - INFO - Epoch 38/40: LR: 0.000053
2025-12-22 08:11:21,155 - INFO - Epoch 38/40: Train Loss: 4.0068, Val Loss: 4.4832, Val Acc: 17.23%
2025-12-22 08:57:43,273 - INFO - Epoch 39/40: LR: 0.000051
2025-12-22 08:57:43,274 - INFO - Epoch 39/40: Train Loss: 3.9790, Val Loss: 4.4842, Val Acc: 17.34%
2025-12-22 09:42:30,473 - INFO - Epoch 40/40: LR: 0.000050
2025-12-22 09:56:55,886 - INFO - Epoch 40/40: Train Loss: 3.9494, Val Loss: 4.4876, Val Acc: 17.28%, Test Loss: 4.4876, Test Acc: 17.28%
2025-12-22 09:56:55,889 - INFO - Saving checkpoint for epoch 40...
2025-12-22 09:56:57,261 - INFO - ✅ Checkpoint saved: runs/run_232/checkpoint_epoch_40.pth
2025-12-22 09:56:57,263 - INFO - Training completed!
2025-12-22 09:56:57,266 - INFO - Training completed!
2025-12-22 09:56:57,268 - INFO - Generating training curves...
2025-12-22 09:57:01,199 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-22 09:57:01,201 - INFO - Training curves saved as separate images with base name 'runs/run_232/training_curves_from_scratch'
2025-12-22 09:57:01,203 - INFO - Generating confusion matrix on test set...
2025-12-22 11:00:24,895 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-22 11:16:12,387 - INFO - Final Test Results of from_scratch model: Loss: 4.4876, Accuracy: 17.28%
2025-12-22 11:16:12,389 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-22 11:16:13,144 - INFO - LR schedule plot saved to 'runs/run_232/lr_schedule_from_scratch.png'
2025-12-22 11:16:13,147 - INFO - 
Final Test Results:
2025-12-22 11:16:13,149 - INFO - Loss: 4.4876
2025-12-22 11:16:13,151 - INFO - Accuracy: 17.28%
2025-12-22 11:16:13,153 - INFO - Precision: 15.79%
2025-12-22 11:16:13,154 - INFO - Recall: 17.28%
2025-12-22 11:16:13,156 - INFO - F1 Score: 15.71%
2025-12-22 11:16:13,868 - INFO - Experiment completed. Results saved to runs/run_232/results_from_scratch.json
2025-12-22 11:16:13,874 - INFO - Experiment completed. Metadata saved to runs/run_232/metadata_from_scratch.json
2025-12-22 11:16:14,303 - INFO - ✅ Model weights saved: runs/run_232/final_model_from_scratch_weights.pth
2025-12-22 11:16:14,308 - INFO - Final model saved: runs/run_232/final_model_from_scratch_weights.pth
2025-12-22 11:16:14,309 - INFO - Final model metadata saved: runs/run_232/final_model_from_scratch_metadata.json
2025-12-22 11:16:14,311 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-22 11:16:14,313 - INFO - Final Accuracy: 17.28%
2025-12-22 11:16:14,315 - INFO - Final F1 Score: 15.71%
2025-12-22 11:16:14,322 - INFO - from_scratch experiment completed successfully!
