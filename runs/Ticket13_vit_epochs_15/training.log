2025-12-16 08:40:47,438 - INFO - Logging initialized. Log file: runs/run_219/training.log
2025-12-16 08:40:47,462 - INFO - Experiment directory: runs/run_219
2025-12-16 08:40:47,464 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-16 08:40:47,552 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-16 08:40:47,972 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-16 08:40:47,974 - INFO - Using device: cuda
2025-12-16 08:40:47,975 - INFO - Training configuration: epochs=15, warmup=1, lr=0.0015
2025-12-16 08:40:47,977 - INFO - VIT configuration: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-16 08:40:47,978 - INFO - Loading dataset...
2025-12-16 08:40:47,981 - INFO - Starting ImageNet data loading from root: /
2025-12-16 08:40:47,982 - INFO - Resolved root path: /
2025-12-16 08:40:47,984 - INFO - Root path exists: True
2025-12-16 08:40:47,986 - INFO - Root path is dir: True
2025-12-16 08:40:47,996 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-16 08:40:47,997 - INFO - Expected train_dir: /train_set, exists: True
2025-12-16 08:40:47,999 - INFO - Expected val_dir: /val_set, exists: True
2025-12-16 08:41:02,304 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-16 08:41:02,644 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-16 08:41:07,547 - INFO - Training VIT from scratch
2025-12-16 08:41:07,582 - INFO - Initializing VIT model from scratch...
2025-12-16 08:41:07,584 - INFO - Model architecture: VIT
2025-12-16 08:41:07,585 - INFO - Model config: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-16 08:41:08,830 - INFO - Model created with random initialization
2025-12-16 08:41:08,831 - INFO - Total parameters: 29,854,376
2025-12-16 08:41:08,832 - INFO - Trainable parameters: 29,854,376
2025-12-16 08:41:08,935 - INFO - Starting from-scratch training...
2025-12-16 08:41:08,937 - INFO - Optimizer: training all model parameters
2025-12-16 08:41:08,941 - INFO - LR Scheduler: cosine with 1 warmup epochs
2025-12-16 08:41:08,942 - INFO - Starting training...
2025-12-16 09:30:53,521 - INFO - Epoch 1/15: LR: 0.001500
2025-12-16 09:30:53,795 - INFO - Epoch 1/15: Train Loss: 6.8510, Val Loss: 6.7194, Val Acc: 0.79%
2025-12-16 10:14:09,712 - INFO - Epoch 2/15: LR: 0.001482
2025-12-16 10:14:09,738 - INFO - Epoch 2/15: Train Loss: 6.8617, Val Loss: 6.6828, Val Acc: 0.68%
2025-12-16 10:57:44,868 - INFO - Epoch 3/15: LR: 0.001431
2025-12-16 10:57:44,888 - INFO - Epoch 3/15: Train Loss: 6.7963, Val Loss: 6.6629, Val Acc: 0.64%
2025-12-16 11:43:26,846 - INFO - Epoch 4/15: LR: 0.001347
2025-12-16 11:43:26,885 - INFO - Epoch 4/15: Train Loss: 6.8159, Val Loss: 6.7354, Val Acc: 0.51%
2025-12-16 12:27:06,017 - INFO - Epoch 5/15: LR: 0.001236
2025-12-16 12:41:08,062 - INFO - Epoch 5/15: Train Loss: 6.7892, Val Loss: 6.7159, Val Acc: 0.53%, Test Loss: 6.7159, Test Acc: 0.53%
2025-12-16 13:24:28,719 - INFO - Epoch 6/15: LR: 0.001104
2025-12-16 13:24:28,787 - INFO - Epoch 6/15: Train Loss: 6.7502, Val Loss: 6.6810, Val Acc: 0.61%
2025-12-16 14:06:34,607 - INFO - Epoch 7/15: LR: 0.000956
2025-12-16 14:06:36,065 - INFO - Epoch 7/15: Train Loss: 6.7710, Val Loss: 6.7028, Val Acc: 0.56%
2025-12-16 14:50:45,158 - INFO - Epoch 8/15: LR: 0.000800
2025-12-16 14:50:45,209 - INFO - Epoch 8/15: Train Loss: 6.7394, Val Loss: 6.6605, Val Acc: 0.66%
2025-12-16 15:40:57,912 - INFO - Epoch 9/15: LR: 0.000644
2025-12-16 15:40:57,988 - INFO - Epoch 9/15: Train Loss: 6.7544, Val Loss: 6.7239, Val Acc: 0.47%
2025-12-16 16:36:12,847 - INFO - Epoch 10/15: LR: 0.000496
2025-12-16 16:50:11,065 - INFO - Epoch 10/15: Train Loss: 6.7566, Val Loss: 6.6489, Val Acc: 0.64%, Test Loss: 6.6489, Test Acc: 0.64%
2025-12-16 16:50:11,176 - INFO - Saving checkpoint for epoch 10...
2025-12-16 16:50:13,009 - INFO - ✅ Checkpoint saved: runs/run_219/checkpoint_epoch_10.pth
2025-12-16 17:46:33,592 - INFO - Epoch 11/15: LR: 0.000364
2025-12-16 17:46:33,699 - INFO - Epoch 11/15: Train Loss: 6.7096, Val Loss: 6.6278, Val Acc: 0.72%
2025-12-16 18:37:20,561 - INFO - Epoch 12/15: LR: 0.000253
2025-12-16 18:37:20,647 - INFO - Epoch 12/15: Train Loss: 6.6950, Val Loss: 6.6127, Val Acc: 0.74%
2025-12-16 19:24:53,171 - INFO - Epoch 13/15: LR: 0.000169
2025-12-16 19:24:53,254 - INFO - Epoch 13/15: Train Loss: 6.6788, Val Loss: 6.5845, Val Acc: 0.83%
2025-12-16 20:08:49,405 - INFO - Epoch 14/15: LR: 0.000118
2025-12-16 20:08:49,433 - INFO - Epoch 14/15: Train Loss: 6.6536, Val Loss: 6.5605, Val Acc: 0.94%
2025-12-16 20:51:13,436 - INFO - Epoch 15/15: LR: 0.000100
2025-12-16 21:05:11,256 - INFO - Epoch 15/15: Train Loss: 6.6380, Val Loss: 6.5520, Val Acc: 0.97%, Test Loss: 6.5520, Test Acc: 0.97%
2025-12-16 21:05:11,294 - INFO - Training completed!
2025-12-16 21:05:11,307 - INFO - Training completed!
2025-12-16 21:05:11,308 - INFO - Generating training curves...
2025-12-16 21:05:16,265 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-16 21:05:16,267 - INFO - Training curves saved as separate images with base name 'runs/run_219/training_curves_from_scratch'
2025-12-16 21:05:16,269 - INFO - Generating confusion matrix on test set...
2025-12-16 22:09:26,247 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-16 22:25:26,833 - INFO - Final Test Results of from_scratch model: Loss: 6.5520, Accuracy: 0.97%
2025-12-16 22:25:26,847 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-16 22:25:27,768 - INFO - LR schedule plot saved to 'runs/run_219/lr_schedule_from_scratch.png'
2025-12-16 22:25:27,770 - INFO - 
Final Test Results:
2025-12-16 22:25:27,772 - INFO - Loss: 6.5520
2025-12-16 22:25:27,773 - INFO - Accuracy: 0.97%
2025-12-16 22:25:27,774 - INFO - Precision: 0.21%
2025-12-16 22:25:27,776 - INFO - Recall: 0.97%
2025-12-16 22:25:27,778 - INFO - F1 Score: 0.25%
2025-12-16 22:25:28,093 - INFO - Experiment completed. Results saved to runs/run_219/results_from_scratch.json
2025-12-16 22:25:28,136 - INFO - Experiment completed. Metadata saved to runs/run_219/metadata_from_scratch.json
2025-12-16 22:25:28,869 - INFO - ✅ Model weights saved: runs/run_219/final_model_from_scratch_weights.pth
2025-12-16 22:25:28,922 - INFO - Final model saved: runs/run_219/final_model_from_scratch_weights.pth
2025-12-16 22:25:28,924 - INFO - Final model metadata saved: runs/run_219/final_model_from_scratch_metadata.json
2025-12-16 22:25:28,926 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-16 22:25:28,928 - INFO - Final Accuracy: 0.97%
2025-12-16 22:25:28,930 - INFO - Final F1 Score: 0.25%
2025-12-16 22:25:28,936 - INFO - from_scratch experiment completed successfully!
