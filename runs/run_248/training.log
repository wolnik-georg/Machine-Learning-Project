2025-12-30 19:26:33,935 - INFO - Logging initialized. Log file: runs/run_248/training.log
2025-12-30 19:26:33,976 - INFO - Experiment directory: runs/run_248
2025-12-30 19:26:33,978 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-30 19:26:33,998 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-30 19:26:34,329 - INFO - GPU memory cleared at startup. Available: 11.6GB
2025-12-30 19:26:34,331 - INFO - Using device: cuda
2025-12-30 19:26:34,332 - INFO - Training configuration: epochs=50, warmup=3, lr=0.0003
2025-12-30 19:26:34,333 - INFO - RESNET configuration: {'type': 'resnet', 'layers': [3, 4, 6, 3], 'num_classes': 1000, 'use_gradient_checkpointing': False}
2025-12-30 19:26:34,334 - INFO - Loading dataset...
2025-12-30 19:26:34,338 - INFO - Starting ImageNet data loading from root: /
2025-12-30 19:26:34,339 - INFO - Resolved root path: /
2025-12-30 19:26:34,341 - INFO - Root path exists: True
2025-12-30 19:26:34,342 - INFO - Root path is dir: True
2025-12-30 19:26:34,353 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-30 19:26:34,355 - INFO - Expected train_dir: /train_set, exists: True
2025-12-30 19:26:34,356 - INFO - Expected val_dir: /val_set, exists: True
2025-12-30 19:26:48,942 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-30 19:26:51,900 - INFO - Dataset limits applied (stratified sampling enabled)
2025-12-30 19:26:51,903 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-30 19:26:53,582 - INFO - Training RESNET from scratch
2025-12-30 19:26:53,583 - INFO - Initializing RESNET model from scratch...
2025-12-30 19:26:53,584 - INFO - Model architecture: RESNET
2025-12-30 19:26:53,586 - INFO - Model config: {'type': 'resnet', 'layers': [3, 4, 6, 3], 'num_classes': 1000, 'use_gradient_checkpointing': False}
2025-12-30 19:26:54,874 - INFO - Model created with random initialization
2025-12-30 19:26:54,876 - INFO - Total parameters: 25,557,032
2025-12-30 19:26:54,877 - INFO - Trainable parameters: 25,557,032
2025-12-30 19:26:54,989 - INFO - Compiling model with torch.compile()
2025-12-30 19:26:59,250 - INFO - Mixed precision enabled → CUDA bf16 selected (hardware supported)
2025-12-30 19:26:59,251 - INFO - Starting from-scratch training...
2025-12-30 19:26:59,252 - INFO - Optimizer: training all model parameters
2025-12-30 19:26:59,257 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-30 19:26:59,259 - INFO - Starting training...
2025-12-30 20:09:11,289 - INFO - Epoch 1/50: LR: 0.000102
2025-12-30 20:09:11,308 - INFO - Epoch 1/50: Train Loss: 6.9712, Val Loss: 6.9011, Val Acc: 0.19%
2025-12-30 20:29:15,897 - INFO - Epoch 2/50: LR: 0.000201
2025-12-30 20:29:15,910 - INFO - Epoch 2/50: Train Loss: 6.8701, Val Loss: 6.5877, Val Acc: 0.83%
2025-12-30 20:49:19,025 - INFO - Epoch 3/50: LR: 0.000300
2025-12-30 20:49:19,027 - INFO - Epoch 3/50: Train Loss: 6.5126, Val Loss: 6.1835, Val Acc: 1.57%
2025-12-30 21:09:42,080 - INFO - Epoch 4/50: LR: 0.000300
2025-12-30 21:09:42,091 - INFO - Epoch 4/50: Train Loss: 6.2467, Val Loss: 5.9455, Val Acc: 2.53%
2025-12-30 21:29:26,335 - INFO - Epoch 5/50: LR: 0.000299
2025-12-30 21:40:17,535 - INFO - Epoch 5/50: Train Loss: 5.9877, Val Loss: 5.7241, Val Acc: 3.30%, Test Loss: 5.7241, Test Acc: 3.30%
2025-12-30 22:00:14,890 - INFO - Epoch 6/50: LR: 0.000297
2025-12-30 22:00:14,898 - INFO - Epoch 6/50: Train Loss: 5.7694, Val Loss: 5.5748, Val Acc: 4.06%
2025-12-30 22:20:04,692 - INFO - Epoch 7/50: LR: 0.000296
2025-12-30 22:20:04,773 - INFO - Epoch 7/50: Train Loss: 5.5646, Val Loss: 5.5183, Val Acc: 5.42%
2025-12-30 22:40:08,933 - INFO - Epoch 8/50: LR: 0.000293
2025-12-30 22:40:08,963 - INFO - Epoch 8/50: Train Loss: 5.3655, Val Loss: 4.9664, Val Acc: 8.63%
2025-12-30 23:00:35,219 - INFO - Epoch 9/50: LR: 0.000290
2025-12-30 23:00:35,232 - INFO - Epoch 9/50: Train Loss: 5.1843, Val Loss: 4.9324, Val Acc: 9.47%
2025-12-30 23:20:54,635 - INFO - Epoch 10/50: LR: 0.000287
2025-12-30 23:31:59,311 - INFO - Epoch 10/50: Train Loss: 5.0026, Val Loss: 4.6702, Val Acc: 11.79%, Test Loss: 4.6702, Test Acc: 11.79%
2025-12-30 23:31:59,314 - INFO - Saving checkpoint for epoch 10...
2025-12-30 23:32:00,741 - INFO - ✅ Checkpoint saved: runs/run_248/checkpoint_epoch_10.pth
2025-12-30 23:52:01,376 - INFO - Epoch 11/50: LR: 0.000283
2025-12-30 23:52:01,378 - INFO - Epoch 11/50: Train Loss: 4.8290, Val Loss: 4.6579, Val Acc: 12.21%
2025-12-31 00:12:16,731 - INFO - Epoch 12/50: LR: 0.000278
2025-12-31 00:12:16,733 - INFO - Epoch 12/50: Train Loss: 4.6599, Val Loss: 4.2920, Val Acc: 15.98%
2025-12-31 00:32:39,170 - INFO - Epoch 13/50: LR: 0.000273
2025-12-31 00:32:39,172 - INFO - Epoch 13/50: Train Loss: 4.5202, Val Loss: 4.3174, Val Acc: 16.69%
2025-12-31 00:52:58,189 - INFO - Epoch 14/50: LR: 0.000268
2025-12-31 00:52:58,194 - INFO - Epoch 14/50: Train Loss: 4.3838, Val Loss: 4.0937, Val Acc: 18.44%
2025-12-31 01:13:23,104 - INFO - Epoch 15/50: LR: 0.000262
2025-12-31 01:24:43,247 - INFO - Epoch 15/50: Train Loss: 4.2398, Val Loss: 3.8903, Val Acc: 21.68%, Test Loss: 3.8903, Test Acc: 21.68%
2025-12-31 01:44:50,046 - INFO - Epoch 16/50: LR: 0.000256
2025-12-31 01:44:50,051 - INFO - Epoch 16/50: Train Loss: 4.1101, Val Loss: 3.7687, Val Acc: 22.64%
2025-12-31 02:05:09,712 - INFO - Epoch 17/50: LR: 0.000249
2025-12-31 02:05:09,730 - INFO - Epoch 17/50: Train Loss: 3.9877, Val Loss: 3.6628, Val Acc: 24.70%
2025-12-31 02:25:59,414 - INFO - Epoch 18/50: LR: 0.000242
2025-12-31 02:25:59,419 - INFO - Epoch 18/50: Train Loss: 3.8719, Val Loss: 3.6432, Val Acc: 25.03%
2025-12-31 02:46:32,783 - INFO - Epoch 19/50: LR: 0.000235
2025-12-31 02:46:32,806 - INFO - Epoch 19/50: Train Loss: 3.7948, Val Loss: 3.6922, Val Acc: 25.12%
2025-12-31 03:07:23,040 - INFO - Epoch 20/50: LR: 0.000228
2025-12-31 03:18:32,844 - INFO - Epoch 20/50: Train Loss: 3.6936, Val Loss: 3.4657, Val Acc: 27.37%, Test Loss: 3.4657, Test Acc: 27.37%
2025-12-31 03:18:32,849 - INFO - Saving checkpoint for epoch 20...
2025-12-31 03:18:33,951 - INFO - ✅ Checkpoint saved: runs/run_248/checkpoint_epoch_20.pth
2025-12-31 03:39:13,169 - INFO - Epoch 21/50: LR: 0.000220
2025-12-31 03:39:13,173 - INFO - Epoch 21/50: Train Loss: 3.5865, Val Loss: 3.3859, Val Acc: 29.09%
2025-12-31 03:59:55,293 - INFO - Epoch 22/50: LR: 0.000212
2025-12-31 03:59:55,298 - INFO - Epoch 22/50: Train Loss: 3.5014, Val Loss: 3.5055, Val Acc: 28.05%
2025-12-31 04:20:42,168 - INFO - Epoch 23/50: LR: 0.000204
2025-12-31 04:20:42,173 - INFO - Epoch 23/50: Train Loss: 3.4236, Val Loss: 3.2429, Val Acc: 31.55%
2025-12-31 04:41:22,523 - INFO - Epoch 24/50: LR: 0.000196
2025-12-31 04:41:22,544 - INFO - Epoch 24/50: Train Loss: 3.3363, Val Loss: 3.2105, Val Acc: 31.76%
2025-12-31 05:02:12,142 - INFO - Epoch 25/50: LR: 0.000188
2025-12-31 05:13:35,603 - INFO - Epoch 25/50: Train Loss: 3.2594, Val Loss: 3.1333, Val Acc: 33.56%, Test Loss: 3.1333, Test Acc: 33.56%
2025-12-31 05:34:25,809 - INFO - Epoch 26/50: LR: 0.000179
2025-12-31 05:34:25,814 - INFO - Epoch 26/50: Train Loss: 3.2012, Val Loss: 3.2073, Val Acc: 32.62%
2025-12-31 05:55:21,745 - INFO - Epoch 27/50: LR: 0.000171
2025-12-31 05:55:21,764 - INFO - Epoch 27/50: Train Loss: 3.1266, Val Loss: 3.1158, Val Acc: 34.23%
2025-12-31 06:16:42,277 - INFO - Epoch 28/50: LR: 0.000162
2025-12-31 06:16:42,282 - INFO - Epoch 28/50: Train Loss: 3.0672, Val Loss: 3.0679, Val Acc: 35.03%
2025-12-31 06:37:56,282 - INFO - Epoch 29/50: LR: 0.000154
2025-12-31 06:37:56,314 - INFO - Epoch 29/50: Train Loss: 3.0036, Val Loss: 3.0230, Val Acc: 35.81%
2025-12-31 06:58:48,807 - INFO - Epoch 30/50: LR: 0.000146
2025-12-31 07:10:15,131 - INFO - Epoch 30/50: Train Loss: 2.9341, Val Loss: 3.0386, Val Acc: 35.92%, Test Loss: 3.0386, Test Acc: 35.92%
2025-12-31 07:10:15,137 - INFO - Saving checkpoint for epoch 30...
2025-12-31 07:10:16,289 - INFO - ✅ Checkpoint saved: runs/run_248/checkpoint_epoch_30.pth
2025-12-31 07:31:17,421 - INFO - Epoch 31/50: LR: 0.000138
2025-12-31 07:31:17,436 - INFO - Epoch 31/50: Train Loss: 2.8629, Val Loss: 2.9190, Val Acc: 37.45%
2025-12-31 07:52:24,224 - INFO - Epoch 32/50: LR: 0.000130
2025-12-31 07:52:24,229 - INFO - Epoch 32/50: Train Loss: 2.8208, Val Loss: 2.9313, Val Acc: 37.53%
2025-12-31 08:13:28,895 - INFO - Epoch 33/50: LR: 0.000122
2025-12-31 08:13:28,901 - INFO - Epoch 33/50: Train Loss: 2.7753, Val Loss: 2.9295, Val Acc: 38.17%
2025-12-31 08:34:45,784 - INFO - Epoch 34/50: LR: 0.000115
2025-12-31 08:34:45,800 - INFO - Epoch 34/50: Train Loss: 2.7062, Val Loss: 2.9481, Val Acc: 37.32%
2025-12-31 08:55:42,864 - INFO - Epoch 35/50: LR: 0.000108
2025-12-31 09:07:08,130 - INFO - Epoch 35/50: Train Loss: 2.6661, Val Loss: 2.8636, Val Acc: 39.49%, Test Loss: 2.8636, Test Acc: 39.49%
2025-12-31 09:28:12,649 - INFO - Epoch 36/50: LR: 0.000101
2025-12-31 09:28:12,655 - INFO - Epoch 36/50: Train Loss: 2.6146, Val Loss: 2.8211, Val Acc: 39.67%
2025-12-31 09:49:21,396 - INFO - Epoch 37/50: LR: 0.000094
2025-12-31 09:49:21,404 - INFO - Epoch 37/50: Train Loss: 2.5704, Val Loss: 2.7810, Val Acc: 40.50%
2025-12-31 10:10:35,964 - INFO - Epoch 38/50: LR: 0.000088
2025-12-31 10:10:35,969 - INFO - Epoch 38/50: Train Loss: 2.5236, Val Loss: 2.7823, Val Acc: 40.33%
2025-12-31 10:35:20,476 - INFO - Epoch 39/50: LR: 0.000082
2025-12-31 10:35:20,480 - INFO - Epoch 39/50: Train Loss: 2.4860, Val Loss: 2.7754, Val Acc: 41.02%
2025-12-31 10:56:39,912 - INFO - Epoch 40/50: LR: 0.000077
2025-12-31 11:08:12,691 - INFO - Epoch 40/50: Train Loss: 2.4502, Val Loss: 2.7310, Val Acc: 41.32%, Test Loss: 2.7310, Test Acc: 41.32%
2025-12-31 11:08:12,696 - INFO - Saving checkpoint for epoch 40...
2025-12-31 11:08:13,799 - INFO - ✅ Checkpoint saved: runs/run_248/checkpoint_epoch_40.pth
2025-12-31 11:29:42,212 - INFO - Epoch 41/50: LR: 0.000072
2025-12-31 11:29:42,217 - INFO - Epoch 41/50: Train Loss: 2.4201, Val Loss: 2.7411, Val Acc: 41.51%
2025-12-31 11:51:08,304 - INFO - Epoch 42/50: LR: 0.000067
2025-12-31 11:51:08,309 - INFO - Epoch 42/50: Train Loss: 2.3701, Val Loss: 2.7374, Val Acc: 41.57%
2025-12-31 12:13:12,044 - INFO - Epoch 43/50: LR: 0.000063
2025-12-31 12:13:12,048 - INFO - Epoch 43/50: Train Loss: 2.3354, Val Loss: 2.7035, Val Acc: 42.28%
