2025-12-23 00:40:39,555 - INFO - Logging initialized. Log file: runs/run_236/training.log
2025-12-23 00:40:39,589 - INFO - Experiment directory: runs/run_236
2025-12-23 00:40:39,591 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-23 00:40:39,651 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-23 00:40:40,105 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-23 00:40:40,107 - INFO - Using device: cuda
2025-12-23 00:40:40,108 - INFO - Training configuration: epochs=40, warmup=3, lr=0.0005
2025-12-23 00:40:40,109 - INFO - RESNET configuration: {'type': 'resnet', 'layers': [3, 4, 6, 3], 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-23 00:40:40,110 - INFO - Loading dataset...
2025-12-23 00:40:40,113 - INFO - Starting ImageNet data loading from root: /
2025-12-23 00:40:40,115 - INFO - Resolved root path: /
2025-12-23 00:40:40,116 - INFO - Root path exists: True
2025-12-23 00:40:40,117 - INFO - Root path is dir: True
2025-12-23 00:40:40,125 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-23 00:40:40,126 - INFO - Expected train_dir: /train_set, exists: True
2025-12-23 00:40:40,127 - INFO - Expected val_dir: /val_set, exists: True
2025-12-23 00:41:01,200 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-23 00:41:01,578 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-23 00:41:06,890 - INFO - Training RESNET from scratch
2025-12-23 00:41:06,938 - INFO - Initializing RESNET model from scratch...
2025-12-23 00:41:06,940 - INFO - Model architecture: RESNET
2025-12-23 00:41:06,941 - INFO - Model config: {'type': 'resnet', 'layers': [3, 4, 6, 3], 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-23 00:41:08,256 - INFO - Model created with random initialization
2025-12-23 00:41:08,258 - INFO - Total parameters: 25,557,032
2025-12-23 00:41:08,260 - INFO - Trainable parameters: 25,557,032
2025-12-23 00:41:08,363 - INFO - Starting from-scratch training...
2025-12-23 00:41:08,365 - INFO - Optimizer: training all model parameters
2025-12-23 00:41:08,369 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-23 00:41:08,371 - INFO - Starting training...
2025-12-23 01:25:02,886 - INFO - Epoch 1/40: LR: 0.000170
2025-12-23 01:25:02,928 - INFO - Epoch 1/40: Train Loss: 6.9438, Val Loss: 6.8894, Val Acc: 0.15%
2025-12-23 02:06:09,796 - INFO - Epoch 2/40: LR: 0.000335
2025-12-23 02:06:09,798 - INFO - Epoch 2/40: Train Loss: 6.8424, Val Loss: 6.5979, Val Acc: 0.71%
2025-12-23 02:47:34,702 - INFO - Epoch 3/40: LR: 0.000500
2025-12-23 02:47:34,704 - INFO - Epoch 3/40: Train Loss: 6.4632, Val Loss: 6.3656, Val Acc: 1.28%
2025-12-23 03:28:32,996 - INFO - Epoch 4/40: LR: 0.000499
2025-12-23 03:28:33,312 - INFO - Epoch 4/40: Train Loss: 6.1930, Val Loss: 5.9720, Val Acc: 2.17%
2025-12-23 04:09:46,142 - INFO - Epoch 5/40: LR: 0.000497
2025-12-23 04:23:33,581 - INFO - Epoch 5/40: Train Loss: 5.9204, Val Loss: 5.7210, Val Acc: 4.19%, Test Loss: 5.7210, Test Acc: 4.19%
2025-12-23 05:04:18,810 - INFO - Epoch 6/40: LR: 0.000493
2025-12-23 05:04:18,815 - INFO - Epoch 6/40: Train Loss: 5.6887, Val Loss: 5.4218, Val Acc: 5.42%
2025-12-23 05:45:20,389 - INFO - Epoch 7/40: LR: 0.000487
2025-12-23 05:45:20,392 - INFO - Epoch 7/40: Train Loss: 5.4945, Val Loss: 5.2791, Val Acc: 6.54%
2025-12-23 06:26:17,133 - INFO - Epoch 8/40: LR: 0.000480
2025-12-23 06:26:17,139 - INFO - Epoch 8/40: Train Loss: 5.2796, Val Loss: 5.0066, Val Acc: 9.09%
2025-12-23 07:07:17,245 - INFO - Epoch 9/40: LR: 0.000471
2025-12-23 07:07:17,247 - INFO - Epoch 9/40: Train Loss: 5.0795, Val Loss: 4.8462, Val Acc: 10.61%
2025-12-23 07:47:58,541 - INFO - Epoch 10/40: LR: 0.000461
2025-12-23 08:01:48,895 - INFO - Epoch 10/40: Train Loss: 4.8939, Val Loss: 4.4922, Val Acc: 13.28%, Test Loss: 4.4922, Test Acc: 13.28%
2025-12-23 08:01:48,898 - INFO - Saving checkpoint for epoch 10...
2025-12-23 08:01:50,206 - INFO - ✅ Checkpoint saved: runs/run_236/checkpoint_epoch_10.pth
2025-12-23 08:42:18,316 - INFO - Epoch 11/40: LR: 0.000450
2025-12-23 08:42:18,350 - INFO - Epoch 11/40: Train Loss: 4.6954, Val Loss: 4.3994, Val Acc: 14.24%
2025-12-23 09:22:39,633 - INFO - Epoch 12/40: LR: 0.000437
2025-12-23 09:22:39,636 - INFO - Epoch 12/40: Train Loss: 4.5430, Val Loss: 4.2375, Val Acc: 16.97%
2025-12-23 10:03:26,737 - INFO - Epoch 13/40: LR: 0.000424
2025-12-23 10:03:26,744 - INFO - Epoch 13/40: Train Loss: 4.3768, Val Loss: 3.9432, Val Acc: 20.61%
2025-12-23 10:44:12,047 - INFO - Epoch 14/40: LR: 0.000409
2025-12-23 10:44:12,079 - INFO - Epoch 14/40: Train Loss: 4.2082, Val Loss: 3.8177, Val Acc: 22.25%
2025-12-23 11:24:58,491 - INFO - Epoch 15/40: LR: 0.000393
2025-12-23 11:38:35,117 - INFO - Epoch 15/40: Train Loss: 4.0640, Val Loss: 3.7675, Val Acc: 23.08%, Test Loss: 3.7675, Test Acc: 23.08%
2025-12-23 12:19:38,940 - INFO - Epoch 16/40: LR: 0.000376
2025-12-23 12:19:38,972 - INFO - Epoch 16/40: Train Loss: 3.9270, Val Loss: 3.7056, Val Acc: 24.21%
2025-12-23 13:01:08,370 - INFO - Epoch 17/40: LR: 0.000359
2025-12-23 13:01:08,375 - INFO - Epoch 17/40: Train Loss: 3.7919, Val Loss: 3.5210, Val Acc: 26.93%
2025-12-23 13:42:17,429 - INFO - Epoch 18/40: LR: 0.000341
2025-12-23 13:42:17,463 - INFO - Epoch 18/40: Train Loss: 3.6787, Val Loss: 3.4260, Val Acc: 28.63%
2025-12-23 14:23:45,677 - INFO - Epoch 19/40: LR: 0.000322
2025-12-23 14:23:45,713 - INFO - Epoch 19/40: Train Loss: 3.5603, Val Loss: 3.4319, Val Acc: 28.42%
2025-12-23 15:06:04,205 - INFO - Epoch 20/40: LR: 0.000304
2025-12-23 15:19:51,223 - INFO - Epoch 20/40: Train Loss: 3.4572, Val Loss: 3.3092, Val Acc: 30.71%, Test Loss: 3.3092, Test Acc: 30.71%
2025-12-23 15:19:51,226 - INFO - Saving checkpoint for epoch 20...
2025-12-23 15:19:52,516 - INFO - ✅ Checkpoint saved: runs/run_236/checkpoint_epoch_20.pth
2025-12-23 16:01:09,079 - INFO - Epoch 21/40: LR: 0.000285
2025-12-23 16:01:09,087 - INFO - Epoch 21/40: Train Loss: 3.3574, Val Loss: 3.2453, Val Acc: 31.39%
2025-12-23 16:43:17,715 - INFO - Epoch 22/40: LR: 0.000265
2025-12-23 16:43:17,717 - INFO - Epoch 22/40: Train Loss: 3.2628, Val Loss: 3.1631, Val Acc: 32.81%
2025-12-23 17:23:56,492 - INFO - Epoch 23/40: LR: 0.000246
2025-12-23 17:23:56,499 - INFO - Epoch 23/40: Train Loss: 3.1600, Val Loss: 3.1034, Val Acc: 34.20%
2025-12-23 18:05:05,179 - INFO - Epoch 24/40: LR: 0.000228
2025-12-23 18:05:05,181 - INFO - Epoch 24/40: Train Loss: 3.0886, Val Loss: 3.0586, Val Acc: 34.67%
2025-12-23 18:45:41,324 - INFO - Epoch 25/40: LR: 0.000209
2025-12-23 18:59:33,554 - INFO - Epoch 25/40: Train Loss: 3.0101, Val Loss: 3.0385, Val Acc: 35.27%, Test Loss: 3.0385, Test Acc: 35.27%
2025-12-23 19:40:38,404 - INFO - Epoch 26/40: LR: 0.000191
2025-12-23 19:40:38,406 - INFO - Epoch 26/40: Train Loss: 2.9385, Val Loss: 2.9577, Val Acc: 36.58%
2025-12-23 20:21:34,068 - INFO - Epoch 27/40: LR: 0.000174
2025-12-23 20:21:34,073 - INFO - Epoch 27/40: Train Loss: 2.8527, Val Loss: 2.9106, Val Acc: 37.68%
2025-12-23 21:02:30,256 - INFO - Epoch 28/40: LR: 0.000157
2025-12-23 21:02:30,258 - INFO - Epoch 28/40: Train Loss: 2.7805, Val Loss: 2.8867, Val Acc: 38.29%
2025-12-23 21:43:06,754 - INFO - Epoch 29/40: LR: 0.000141
2025-12-23 21:43:06,763 - INFO - Epoch 29/40: Train Loss: 2.7193, Val Loss: 2.8513, Val Acc: 38.92%
2025-12-23 22:24:05,205 - INFO - Epoch 30/40: LR: 0.000126
2025-12-23 22:37:43,236 - INFO - Epoch 30/40: Train Loss: 2.6655, Val Loss: 2.8259, Val Acc: 39.52%, Test Loss: 2.8259, Test Acc: 39.52%
2025-12-23 22:37:43,239 - INFO - Saving checkpoint for epoch 30...
2025-12-23 22:37:44,531 - INFO - ✅ Checkpoint saved: runs/run_236/checkpoint_epoch_30.pth
2025-12-23 23:18:38,653 - INFO - Epoch 31/40: LR: 0.000113
2025-12-23 23:18:38,663 - INFO - Epoch 31/40: Train Loss: 2.6107, Val Loss: 2.8024, Val Acc: 40.01%
2025-12-23 23:59:38,583 - INFO - Epoch 32/40: LR: 0.000100
2025-12-23 23:59:38,604 - INFO - Epoch 32/40: Train Loss: 2.5540, Val Loss: 2.7688, Val Acc: 40.58%
2025-12-24 00:40:08,188 - INFO - Epoch 33/40: LR: 0.000089
2025-12-24 00:40:08,192 - INFO - Epoch 33/40: Train Loss: 2.5182, Val Loss: 2.7728, Val Acc: 40.65%
2025-12-24 01:20:58,548 - INFO - Epoch 34/40: LR: 0.000079
2025-12-24 01:20:58,550 - INFO - Epoch 34/40: Train Loss: 2.4594, Val Loss: 2.7263, Val Acc: 41.47%
2025-12-24 02:01:33,296 - INFO - Epoch 35/40: LR: 0.000070
2025-12-24 02:15:10,680 - INFO - Epoch 35/40: Train Loss: 2.4195, Val Loss: 2.7223, Val Acc: 41.63%, Test Loss: 2.7223, Test Acc: 41.63%
2025-12-24 02:55:58,770 - INFO - Epoch 36/40: LR: 0.000063
2025-12-24 02:55:58,772 - INFO - Epoch 36/40: Train Loss: 2.3832, Val Loss: 2.7295, Val Acc: 41.63%
2025-12-24 03:36:31,851 - INFO - Epoch 37/40: LR: 0.000057
2025-12-24 03:36:31,857 - INFO - Epoch 37/40: Train Loss: 2.3508, Val Loss: 2.6892, Val Acc: 42.37%
2025-12-24 04:17:16,781 - INFO - Epoch 38/40: LR: 0.000053
2025-12-24 04:17:16,783 - INFO - Epoch 38/40: Train Loss: 2.3249, Val Loss: 2.7003, Val Acc: 42.55%
2025-12-24 04:57:50,464 - INFO - Epoch 39/40: LR: 0.000051
2025-12-24 04:57:50,488 - INFO - Epoch 39/40: Train Loss: 2.3105, Val Loss: 2.6907, Val Acc: 42.59%
2025-12-24 05:38:44,113 - INFO - Epoch 40/40: LR: 0.000050
2025-12-24 05:52:20,586 - INFO - Epoch 40/40: Train Loss: 2.2856, Val Loss: 2.6793, Val Acc: 43.00%, Test Loss: 2.6793, Test Acc: 43.00%
2025-12-24 05:52:20,588 - INFO - Saving checkpoint for epoch 40...
2025-12-24 05:52:21,883 - INFO - ✅ Checkpoint saved: runs/run_236/checkpoint_epoch_40.pth
2025-12-24 05:52:21,885 - INFO - Training completed!
2025-12-24 05:52:21,887 - INFO - Training completed!
2025-12-24 05:52:21,889 - INFO - Generating training curves...
2025-12-24 05:52:25,297 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-24 05:52:25,299 - INFO - Training curves saved as separate images with base name 'runs/run_236/training_curves_from_scratch'
2025-12-24 05:52:25,300 - INFO - Generating confusion matrix on test set...
2025-12-24 06:57:41,926 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-24 07:12:33,211 - INFO - Final Test Results of from_scratch model: Loss: 2.6793, Accuracy: 43.00%
2025-12-24 07:12:33,223 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-24 07:12:34,033 - INFO - LR schedule plot saved to 'runs/run_236/lr_schedule_from_scratch.png'
2025-12-24 07:12:34,035 - INFO - 
Final Test Results:
2025-12-24 07:12:34,036 - INFO - Loss: 2.6793
2025-12-24 07:12:34,038 - INFO - Accuracy: 43.00%
2025-12-24 07:12:34,039 - INFO - Precision: 43.79%
2025-12-24 07:12:34,040 - INFO - Recall: 43.00%
2025-12-24 07:12:34,042 - INFO - F1 Score: 42.27%
2025-12-24 07:12:34,784 - INFO - Experiment completed. Results saved to runs/run_236/results_from_scratch.json
2025-12-24 07:12:34,790 - INFO - Experiment completed. Metadata saved to runs/run_236/metadata_from_scratch.json
2025-12-24 07:12:35,337 - INFO - ✅ Model weights saved: runs/run_236/final_model_from_scratch_weights.pth
2025-12-24 07:12:35,342 - INFO - Final model saved: runs/run_236/final_model_from_scratch_weights.pth
2025-12-24 07:12:35,343 - INFO - Final model metadata saved: runs/run_236/final_model_from_scratch_metadata.json
2025-12-24 07:12:35,345 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-24 07:12:35,346 - INFO - Final Accuracy: 43.00%
2025-12-24 07:12:35,347 - INFO - Final F1 Score: 42.27%
2025-12-24 07:12:35,349 - INFO - from_scratch experiment completed successfully!
