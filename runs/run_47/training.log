2025-11-27 09:35:21,274 - INFO - Logging initialized. Log file: runs/run_47/training.log
2025-11-27 09:35:21,333 - INFO - Experiment directory: runs/run_47
2025-11-27 09:35:21,334 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-11-27 09:35:21,475 - INFO - Random seeds set to 42 (deterministic=False)
2025-11-27 09:35:21,476 - INFO - Using device: cuda
2025-11-27 09:35:21,476 - INFO - Training configuration: epochs=2, warmup=1, lr=0.001
2025-11-27 09:35:21,477 - INFO - Loading dataset...
2025-11-27 09:35:24,016 - INFO - Dataset loaded: train=1303, val=261, test=313 batches
2025-11-27 09:35:25,801 - INFO - Using pretrained model: swin_tiny_patch4_window7_224
2025-11-27 09:35:25,802 - INFO - Model architecture: Swin-Tiny
2025-11-27 09:35:25,802 - INFO - Initializing reference model...
2025-11-27 09:35:25,803 - INFO - Loading TIMM model: swin_tiny_patch4_window7_224 with pretrained weights
2025-11-27 09:35:26,316 - INFO - Loading pretrained weights from Hugging Face hub (timm/swin_tiny_patch4_window7_224.ms_in1k)
2025-11-27 09:35:26,532 - INFO - HTTP Request: HEAD https://huggingface.co/timm/swin_tiny_patch4_window7_224.ms_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-11-27 09:35:26,548 - INFO - [timm/swin_tiny_patch4_window7_224.ms_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-27 09:35:26,768 - INFO - Successfully loaded swin_tiny_patch4_window7_224 from TIMM
2025-11-27 09:35:26,769 - INFO - Encoder loaded: 768 output features
2025-11-27 09:35:26,770 - INFO - Created classification head: 768 -> 100 classes
2025-11-27 09:35:26,772 - INFO - Reference model created. Trainable params (head only): 78,436
2025-11-27 09:35:27,117 - INFO - Detected Swin Transformer architecture
2025-11-27 09:35:27,118 - INFO - Detected model size: tiny
2025-11-27 09:35:27,118 - INFO - Initializing custom Swin model (size: tiny)...
2025-11-27 09:35:27,119 - INFO - Custom model will match architecture: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24]
2025-11-27 09:35:27,453 - INFO - Transferring weights from reference to custom encoder...
2025-11-27 09:35:27,454 - INFO - Weight transfer: SwinTransformer -> SwinTransformerModel
2025-11-27 09:35:27,469 - INFO - Weight transfer: 169 layers transferred.
2025-11-27 09:35:27,488 - INFO - Weight transfer completed: {'transferred': 169, 'missing': 0, 'size_mismatches': 0}
2025-11-27 09:35:27,489 - INFO - ✓ All expected weights transferred successfully
2025-11-27 09:35:27,490 - INFO - Custom model created. Trainable params (head only): 78,436
2025-11-27 09:35:27,492 - INFO - Starting reference model training...
2025-11-27 09:35:27,493 - INFO - Optimizer: training head parameters only (encoder frozen)
2025-11-27 09:35:27,494 - INFO - Starting training...
2025-11-27 09:37:37,877 - INFO - Epoch 1/2: LR: 0.001000
2025-11-27 09:37:37,878 - INFO - Epoch 1/2: Train Loss: 3.5903, Val Loss: 2.5830, Val Acc: 60.75%
2025-11-27 09:39:45,760 - INFO - Epoch 2/2: LR: 0.000000
2025-11-27 09:39:45,761 - INFO - Epoch 2/2: Train Loss: 1.2534, Val Loss: 0.9155, Val Acc: 73.05%
2025-11-27 09:39:45,762 - INFO - Training completed!
2025-11-27 09:39:45,763 - INFO - Reference model training completed!
2025-11-27 09:39:45,763 - INFO - Generating training curves...
2025-11-27 09:39:47,664 - INFO - Training curves saved as separate images with base name 'runs/run_47/training_curves_reference'
2025-11-27 09:39:47,665 - INFO - Generating confusion matrix on test set...
2025-11-27 09:40:43,691 - INFO - Performing final evaluation of reference model on test set...
2025-11-27 09:41:27,567 - INFO - Final Test Results of reference model: Loss: 0.9103, Accuracy: 73.02%
2025-11-27 09:41:27,568 - INFO - Generating LR schedule plot of reference model...
2025-11-27 09:41:27,902 - INFO - LR schedule plot saved to 'runs/run_47/lr_schedule_reference.png'
2025-11-27 09:41:27,902 - INFO - 
Final Test Results:
2025-11-27 09:41:27,903 - INFO - Loss: 0.9103
2025-11-27 09:41:27,903 - INFO - Accuracy: 73.02%
2025-11-27 09:41:27,903 - INFO - Precision: 73.64%
2025-11-27 09:41:27,904 - INFO - Recall: 73.02%
2025-11-27 09:41:27,904 - INFO - F1 Score: 72.90%
2025-11-27 09:41:27,918 - INFO - Experiment completed. Results saved to runs/run_47/results_reference.json
2025-11-27 09:41:27,938 - INFO - Experiment completed. Metadata saved to runs/run_47/metadata_reference.json
2025-11-27 09:41:28,324 - INFO - ✅ Model weights saved: trained_models/CIFAR100_final_model_reference_weights.pth
2025-11-27 09:41:28,325 - INFO - Starting custom model training...
2025-11-27 09:41:28,326 - INFO - Optimizer: training head parameters only (encoder frozen)
2025-11-27 09:41:28,327 - INFO - Starting training...
2025-11-27 09:43:37,860 - INFO - Epoch 1/2: LR: 0.001000
2025-11-27 09:43:37,861 - INFO - Epoch 1/2: Train Loss: 3.5705, Val Loss: 2.5348, Val Acc: 60.05%
2025-11-27 09:45:47,108 - INFO - Epoch 2/2: LR: 0.000000
2025-11-27 09:45:47,108 - INFO - Epoch 2/2: Train Loss: 1.2540, Val Loss: 0.9201, Val Acc: 72.45%
2025-11-27 09:45:47,109 - INFO - Training completed!
2025-11-27 09:45:47,110 - INFO - Custom model training completed!
2025-11-27 09:45:47,110 - INFO - Generating training curves...
2025-11-27 09:45:48,928 - INFO - Training curves saved as separate images with base name 'runs/run_47/training_curves_custom'
2025-11-27 09:45:48,928 - INFO - Generating confusion matrix on test set...
2025-11-27 09:46:44,885 - INFO - Performing final evaluation of custom model on test set...
2025-11-27 09:47:28,700 - INFO - Final Test Results of custom model: Loss: 0.9153, Accuracy: 73.27%
2025-11-27 09:47:28,700 - INFO - Generating LR schedule plot of custom model...
2025-11-27 09:47:29,037 - INFO - LR schedule plot saved to 'runs/run_47/lr_schedule_custom.png'
2025-11-27 09:47:29,037 - INFO - 
Final Test Results:
2025-11-27 09:47:29,038 - INFO - Loss: 0.9153
2025-11-27 09:47:29,039 - INFO - Accuracy: 73.27%
2025-11-27 09:47:29,039 - INFO - Precision: 74.48%
2025-11-27 09:47:29,040 - INFO - Recall: 73.27%
2025-11-27 09:47:29,041 - INFO - F1 Score: 73.18%
2025-11-27 09:47:29,047 - INFO - Experiment completed. Results saved to runs/run_47/results_custom.json
2025-11-27 09:47:29,074 - INFO - Experiment completed. Metadata saved to runs/run_47/metadata_custom.json
2025-11-27 09:47:29,371 - INFO - ✅ Model weights saved: trained_models/CIFAR100_final_model_custom_weights.pth
2025-11-27 09:47:29,372 - INFO - === MODEL COMPARISON RESULTS (linear_probe on CIFAR100) ===
2025-11-27 09:47:29,373 - INFO - Reference (TIMM): 73.02%
2025-11-27 09:47:29,374 - INFO - Custom          : 73.27%
2025-11-27 09:47:29,375 - INFO - Difference      : 0.25%
2025-11-27 09:47:29,377 - INFO - linear_probe experiment completed successfully!
