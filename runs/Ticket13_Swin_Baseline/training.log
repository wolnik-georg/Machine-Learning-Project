2025-12-14 13:34:37,153 - INFO - Logging initialized. Log file: runs/run_205/training.log
2025-12-14 13:34:37,156 - INFO - Experiment directory: runs/run_205
2025-12-14 13:34:37,158 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-14 13:34:37,180 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-14 13:34:37,635 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-14 13:34:37,637 - INFO - Using device: cuda
2025-12-14 13:34:37,639 - INFO - Training configuration: epochs=50, warmup=4, lr=0.0005
2025-12-14 13:34:37,641 - INFO - SWIN configuration: variant=tiny, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False, use_gradient_checkpointing=True
2025-12-14 13:34:37,642 - INFO - SWIN details: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7
2025-12-14 13:34:37,644 - INFO - Loading dataset...
2025-12-14 13:34:37,649 - INFO - Starting ImageNet data loading from root: /
2025-12-14 13:34:37,651 - INFO - Resolved root path: /
2025-12-14 13:34:37,653 - INFO - Root path exists: True
2025-12-14 13:34:37,655 - INFO - Root path is dir: True
2025-12-14 13:34:37,666 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-14 13:34:37,668 - INFO - Expected train_dir: /train_set, exists: True
2025-12-14 13:34:37,669 - INFO - Expected val_dir: /val_set, exists: True
2025-12-14 13:34:51,965 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-14 13:34:52,310 - INFO - Dataset loaded: train=100000 samples (447 batches), val=50000 samples (224 batches), test=50000 samples (224 batches)
2025-12-14 13:34:56,575 - INFO - Training Swin-Tiny from scratch
2025-12-14 13:34:56,577 - INFO - Initializing model from scratch...
2025-12-14 13:34:56,578 - INFO - Model architecture: Swin-Tiny
2025-12-14 13:34:56,580 - INFO - Model config: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False, use_gradient_checkpointing=True
2025-12-14 13:34:57,575 - INFO - Model created with random initialization
2025-12-14 13:34:57,577 - INFO - Total parameters: 28,288,354
2025-12-14 13:34:57,579 - INFO - Trainable parameters: 28,288,354
2025-12-14 13:34:57,689 - INFO - Starting from-scratch training...
2025-12-14 13:34:57,691 - INFO - Optimizer: training all model parameters
2025-12-14 13:34:57,695 - INFO - LR Scheduler: cosine with 4 warmup epochs
2025-12-14 13:34:57,697 - INFO - Starting training...
2025-12-14 14:47:59,080 - INFO - Epoch 1/50: LR: 0.000129
2025-12-14 14:47:59,121 - INFO - Epoch 1/50: Train Loss: 6.8981, Val Loss: 6.7921, Val Acc: 0.46%
2025-12-14 15:35:52,950 - INFO - Epoch 2/50: LR: 0.000253
2025-12-14 15:35:53,004 - INFO - Epoch 2/50: Train Loss: 6.7482, Val Loss: 6.5237, Val Acc: 0.97%
2025-12-14 16:24:22,577 - INFO - Epoch 3/50: LR: 0.000376
2025-12-14 16:24:22,650 - INFO - Epoch 3/50: Train Loss: 6.4402, Val Loss: 6.1063, Val Acc: 1.81%
2025-12-14 17:08:04,724 - INFO - Epoch 4/50: LR: 0.000500
2025-12-14 17:08:04,738 - INFO - Epoch 4/50: Train Loss: 6.1650, Val Loss: 5.8368, Val Acc: 2.76%
2025-12-14 17:56:21,670 - INFO - Epoch 5/50: LR: 0.000499
2025-12-14 18:10:43,909 - INFO - Epoch 5/50: Train Loss: 6.0131, Val Loss: 5.6847, Val Acc: 3.48%, Test Loss: 5.6847, Test Acc: 3.48%
2025-12-14 18:54:30,777 - INFO - Epoch 6/50: LR: 0.000498
2025-12-14 18:54:30,794 - INFO - Epoch 6/50: Train Loss: 5.8219, Val Loss: 5.4653, Val Acc: 5.14%
2025-12-14 19:42:42,535 - INFO - Epoch 7/50: LR: 0.000495
2025-12-14 19:42:42,561 - INFO - Epoch 7/50: Train Loss: 5.6555, Val Loss: 5.2784, Val Acc: 6.39%
2025-12-14 20:26:24,566 - INFO - Epoch 8/50: LR: 0.000492
2025-12-14 20:26:24,587 - INFO - Epoch 8/50: Train Loss: 5.5233, Val Loss: 5.1409, Val Acc: 7.56%
2025-12-14 21:14:34,854 - INFO - Epoch 9/50: LR: 0.000487
2025-12-14 21:14:34,862 - INFO - Epoch 9/50: Train Loss: 5.3889, Val Loss: 5.0218, Val Acc: 8.53%
2025-12-14 21:59:06,971 - INFO - Epoch 10/50: LR: 0.000481
2025-12-14 22:13:45,326 - INFO - Epoch 10/50: Train Loss: 5.2768, Val Loss: 4.9384, Val Acc: 9.51%, Test Loss: 4.9384, Test Acc: 9.51%
2025-12-14 22:13:45,350 - INFO - Saving checkpoint for epoch 10...
2025-12-14 22:13:46,780 - INFO - ✅ Checkpoint saved: runs/run_205/checkpoint_epoch_10.pth
2025-12-14 23:01:25,027 - INFO - Epoch 11/50: LR: 0.000475
2025-12-14 23:01:25,069 - INFO - Epoch 11/50: Train Loss: 5.1581, Val Loss: 4.7792, Val Acc: 11.18%
2025-12-14 23:46:15,225 - INFO - Epoch 12/50: LR: 0.000467
2025-12-14 23:46:15,296 - INFO - Epoch 12/50: Train Loss: 5.0548, Val Loss: 4.7072, Val Acc: 12.01%
2025-12-15 00:37:26,488 - INFO - Epoch 13/50: LR: 0.000459
2025-12-15 00:37:26,563 - INFO - Epoch 13/50: Train Loss: 4.9506, Val Loss: 4.5621, Val Acc: 13.49%
2025-12-15 01:22:22,739 - INFO - Epoch 14/50: LR: 0.000450
2025-12-15 01:22:22,763 - INFO - Epoch 14/50: Train Loss: 4.8543, Val Loss: 4.4803, Val Acc: 14.58%
2025-12-15 02:09:57,291 - INFO - Epoch 15/50: LR: 0.000439
2025-12-15 02:24:17,648 - INFO - Epoch 15/50: Train Loss: 4.7534, Val Loss: 4.4105, Val Acc: 15.15%, Test Loss: 4.4105, Test Acc: 15.15%
2025-12-15 03:07:54,923 - INFO - Epoch 16/50: LR: 0.000429
2025-12-15 03:07:54,954 - INFO - Epoch 16/50: Train Loss: 4.6581, Val Loss: 4.2951, Val Acc: 16.86%
2025-12-15 03:55:31,405 - INFO - Epoch 17/50: LR: 0.000417
2025-12-15 03:55:31,469 - INFO - Epoch 17/50: Train Loss: 4.5713, Val Loss: 4.1951, Val Acc: 17.84%
2025-12-15 04:39:27,703 - INFO - Epoch 18/50: LR: 0.000405
2025-12-15 04:39:27,794 - INFO - Epoch 18/50: Train Loss: 4.4640, Val Loss: 4.1403, Val Acc: 18.41%
2025-12-15 05:28:04,501 - INFO - Epoch 19/50: LR: 0.000392
2025-12-15 05:28:04,527 - INFO - Epoch 19/50: Train Loss: 4.3845, Val Loss: 4.0598, Val Acc: 19.63%
2025-12-15 06:12:03,701 - INFO - Epoch 20/50: LR: 0.000379
2025-12-15 06:26:32,273 - INFO - Epoch 20/50: Train Loss: 4.2916, Val Loss: 4.0391, Val Acc: 19.98%, Test Loss: 4.0391, Test Acc: 19.98%
2025-12-15 06:26:32,276 - INFO - Saving checkpoint for epoch 20...
2025-12-15 06:26:33,509 - INFO - ✅ Checkpoint saved: runs/run_205/checkpoint_epoch_20.pth
2025-12-15 07:13:56,408 - INFO - Epoch 21/50: LR: 0.000365
2025-12-15 07:13:56,438 - INFO - Epoch 21/50: Train Loss: 4.2057, Val Loss: 3.9479, Val Acc: 21.34%
2025-12-15 07:58:20,496 - INFO - Epoch 22/50: LR: 0.000350
2025-12-15 07:58:20,527 - INFO - Epoch 22/50: Train Loss: 4.1267, Val Loss: 3.9034, Val Acc: 21.89%
2025-12-15 08:45:48,142 - INFO - Epoch 23/50: LR: 0.000336
2025-12-15 08:45:48,195 - INFO - Epoch 23/50: Train Loss: 4.0449, Val Loss: 3.9102, Val Acc: 22.20%
2025-12-15 09:31:26,362 - INFO - Epoch 24/50: LR: 0.000321
2025-12-15 09:31:26,390 - INFO - Epoch 24/50: Train Loss: 3.9699, Val Loss: 3.8286, Val Acc: 23.01%
2025-12-15 10:19:46,214 - INFO - Epoch 25/50: LR: 0.000306
2025-12-15 10:34:15,923 - INFO - Epoch 25/50: Train Loss: 3.8933, Val Loss: 3.7936, Val Acc: 23.63%, Test Loss: 3.7936, Test Acc: 23.63%
2025-12-15 11:19:05,746 - INFO - Epoch 26/50: LR: 0.000290
2025-12-15 11:19:05,779 - INFO - Epoch 26/50: Train Loss: 3.8216, Val Loss: 3.7128, Val Acc: 25.16%
2025-12-15 12:08:06,505 - INFO - Epoch 27/50: LR: 0.000275
2025-12-15 12:08:06,547 - INFO - Epoch 27/50: Train Loss: 3.7378, Val Loss: 3.6669, Val Acc: 25.51%
2025-12-15 12:53:25,053 - INFO - Epoch 28/50: LR: 0.000260
2025-12-15 12:53:25,092 - INFO - Epoch 28/50: Train Loss: 3.6639, Val Loss: 3.5968, Val Acc: 26.74%
2025-12-15 13:53:48,833 - INFO - Epoch 29/50: LR: 0.000244
2025-12-15 13:53:48,930 - INFO - Epoch 29/50: Train Loss: 3.5907, Val Loss: 3.6177, Val Acc: 26.36%
2025-12-15 14:39:59,206 - INFO - Epoch 30/50: LR: 0.000229
2025-12-15 14:54:18,504 - INFO - Epoch 30/50: Train Loss: 3.5111, Val Loss: 3.5573, Val Acc: 27.38%, Test Loss: 3.5573, Test Acc: 27.38%
2025-12-15 14:54:18,543 - INFO - Saving checkpoint for epoch 30...
2025-12-15 14:54:19,904 - INFO - ✅ Checkpoint saved: runs/run_205/checkpoint_epoch_30.pth
2025-12-15 15:42:22,504 - INFO - Epoch 31/50: LR: 0.000214
2025-12-15 15:42:22,571 - INFO - Epoch 31/50: Train Loss: 3.4418, Val Loss: 3.5325, Val Acc: 27.93%
2025-12-15 16:26:42,530 - INFO - Epoch 32/50: LR: 0.000200
2025-12-15 16:26:42,579 - INFO - Epoch 32/50: Train Loss: 3.3815, Val Loss: 3.5123, Val Acc: 28.09%
2025-12-15 17:15:58,253 - INFO - Epoch 33/50: LR: 0.000185
2025-12-15 17:15:58,276 - INFO - Epoch 33/50: Train Loss: 3.3066, Val Loss: 3.4466, Val Acc: 29.40%
2025-12-15 18:00:06,373 - INFO - Epoch 34/50: LR: 0.000171
2025-12-15 18:00:07,472 - INFO - Epoch 34/50: Train Loss: 3.2561, Val Loss: 3.4338, Val Acc: 29.53%
2025-12-15 18:51:53,265 - INFO - Epoch 35/50: LR: 0.000158
2025-12-15 19:06:23,407 - INFO - Epoch 35/50: Train Loss: 3.1904, Val Loss: 3.4303, Val Acc: 29.90%, Test Loss: 3.4303, Test Acc: 29.90%
2025-12-15 19:50:01,154 - INFO - Epoch 36/50: LR: 0.000145
2025-12-15 19:50:01,182 - INFO - Epoch 36/50: Train Loss: 3.1207, Val Loss: 3.3970, Val Acc: 30.44%
2025-12-15 20:39:11,598 - INFO - Epoch 37/50: LR: 0.000133
2025-12-15 20:39:11,638 - INFO - Epoch 37/50: Train Loss: 3.0646, Val Loss: 3.3839, Val Acc: 30.68%
