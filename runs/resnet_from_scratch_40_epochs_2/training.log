2025-12-24 07:18:35,707 - INFO - Logging initialized. Log file: runs/run_238/training.log
2025-12-24 07:18:35,846 - INFO - Experiment directory: runs/run_238
2025-12-24 07:18:35,848 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-24 07:18:35,898 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-24 07:18:36,369 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-24 07:18:36,371 - INFO - Using device: cuda
2025-12-24 07:18:36,372 - INFO - Training configuration: epochs=40, warmup=3, lr=0.0005
2025-12-24 07:18:36,374 - INFO - RESNET configuration: {'type': 'resnet', 'layers': [3, 4, 6, 3], 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-24 07:18:36,375 - INFO - Loading dataset...
2025-12-24 07:18:36,379 - INFO - Starting ImageNet data loading from root: /
2025-12-24 07:18:36,381 - INFO - Resolved root path: /
2025-12-24 07:18:36,383 - INFO - Root path exists: True
2025-12-24 07:18:36,384 - INFO - Root path is dir: True
2025-12-24 07:18:36,393 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-24 07:18:36,395 - INFO - Expected train_dir: /train_set, exists: True
2025-12-24 07:18:36,397 - INFO - Expected val_dir: /val_set, exists: True
2025-12-24 07:18:58,723 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-24 07:18:59,123 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-24 07:19:03,681 - INFO - Training RESNET from scratch
2025-12-24 07:19:03,718 - INFO - Initializing RESNET model from scratch...
2025-12-24 07:19:03,719 - INFO - Model architecture: RESNET
2025-12-24 07:19:03,721 - INFO - Model config: {'type': 'resnet', 'layers': [3, 4, 6, 3], 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-24 07:19:05,027 - INFO - Model created with random initialization
2025-12-24 07:19:05,029 - INFO - Total parameters: 25,557,032
2025-12-24 07:19:05,030 - INFO - Trainable parameters: 25,557,032
2025-12-24 07:19:05,138 - INFO - Starting from-scratch training...
2025-12-24 07:19:05,140 - INFO - Optimizer: training all model parameters
2025-12-24 07:19:05,144 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-24 07:19:05,145 - INFO - Starting training...
2025-12-24 08:03:59,556 - INFO - Epoch 1/40: LR: 0.000170
2025-12-24 08:03:59,570 - INFO - Epoch 1/40: Train Loss: 6.9438, Val Loss: 6.8890, Val Acc: 0.20%
2025-12-24 08:45:08,171 - INFO - Epoch 2/40: LR: 0.000335
2025-12-24 08:45:08,180 - INFO - Epoch 2/40: Train Loss: 6.8501, Val Loss: 6.6144, Val Acc: 0.76%
2025-12-24 09:25:52,252 - INFO - Epoch 3/40: LR: 0.000500
2025-12-24 09:25:52,263 - INFO - Epoch 3/40: Train Loss: 6.4553, Val Loss: 6.3722, Val Acc: 1.23%
2025-12-24 10:06:33,060 - INFO - Epoch 4/40: LR: 0.000499
2025-12-24 10:06:33,082 - INFO - Epoch 4/40: Train Loss: 6.1912, Val Loss: 5.9250, Val Acc: 2.41%
2025-12-24 10:47:24,663 - INFO - Epoch 5/40: LR: 0.000497
2025-12-24 11:01:07,538 - INFO - Epoch 5/40: Train Loss: 5.9107, Val Loss: 5.5839, Val Acc: 4.23%, Test Loss: 5.5839, Test Acc: 4.23%
2025-12-24 11:41:52,974 - INFO - Epoch 6/40: LR: 0.000493
2025-12-24 11:41:53,010 - INFO - Epoch 6/40: Train Loss: 5.6893, Val Loss: 5.3751, Val Acc: 5.38%
2025-12-24 12:22:49,241 - INFO - Epoch 7/40: LR: 0.000487
2025-12-24 12:22:49,292 - INFO - Epoch 7/40: Train Loss: 5.4968, Val Loss: 5.2757, Val Acc: 6.19%
2025-12-24 13:03:37,682 - INFO - Epoch 8/40: LR: 0.000480
2025-12-24 13:03:37,708 - INFO - Epoch 8/40: Train Loss: 5.2941, Val Loss: 5.0656, Val Acc: 8.03%
2025-12-24 13:44:44,820 - INFO - Epoch 9/40: LR: 0.000471
2025-12-24 13:44:44,858 - INFO - Epoch 9/40: Train Loss: 5.0949, Val Loss: 4.8017, Val Acc: 10.60%
2025-12-24 14:25:45,510 - INFO - Epoch 10/40: LR: 0.000461
2025-12-24 14:39:31,196 - INFO - Epoch 10/40: Train Loss: 4.9095, Val Loss: 4.6314, Val Acc: 12.10%, Test Loss: 4.6314, Test Acc: 12.10%
2025-12-24 14:39:31,214 - INFO - Saving checkpoint for epoch 10...
2025-12-24 14:39:32,676 - INFO - ✅ Checkpoint saved: runs/run_238/checkpoint_epoch_10.pth
2025-12-24 15:20:51,375 - INFO - Epoch 11/40: LR: 0.000450
2025-12-24 15:20:51,452 - INFO - Epoch 11/40: Train Loss: 4.7199, Val Loss: 4.4011, Val Acc: 14.43%
2025-12-24 16:01:44,278 - INFO - Epoch 12/40: LR: 0.000437
2025-12-24 16:01:44,351 - INFO - Epoch 12/40: Train Loss: 4.5424, Val Loss: 4.1160, Val Acc: 17.82%
2025-12-24 16:42:54,696 - INFO - Epoch 13/40: LR: 0.000424
2025-12-24 16:42:54,727 - INFO - Epoch 13/40: Train Loss: 4.3655, Val Loss: 4.0479, Val Acc: 19.14%
2025-12-24 17:23:39,108 - INFO - Epoch 14/40: LR: 0.000409
2025-12-24 17:23:39,124 - INFO - Epoch 14/40: Train Loss: 4.2097, Val Loss: 3.8858, Val Acc: 21.19%
2025-12-24 18:04:43,046 - INFO - Epoch 15/40: LR: 0.000393
2025-12-24 18:18:20,674 - INFO - Epoch 15/40: Train Loss: 4.0720, Val Loss: 3.7331, Val Acc: 23.42%, Test Loss: 3.7331, Test Acc: 23.42%
2025-12-24 18:59:11,168 - INFO - Epoch 16/40: LR: 0.000376
2025-12-24 18:59:11,191 - INFO - Epoch 16/40: Train Loss: 3.9361, Val Loss: 3.6517, Val Acc: 25.11%
2025-12-24 19:40:15,303 - INFO - Epoch 17/40: LR: 0.000359
2025-12-24 19:40:15,347 - INFO - Epoch 17/40: Train Loss: 3.7947, Val Loss: 3.5428, Val Acc: 26.38%
2025-12-24 20:20:59,601 - INFO - Epoch 18/40: LR: 0.000341
2025-12-24 20:20:59,626 - INFO - Epoch 18/40: Train Loss: 3.6832, Val Loss: 3.4551, Val Acc: 27.89%
2025-12-24 21:02:06,777 - INFO - Epoch 19/40: LR: 0.000322
2025-12-24 21:02:06,831 - INFO - Epoch 19/40: Train Loss: 3.5657, Val Loss: 3.4454, Val Acc: 28.21%
2025-12-24 21:42:42,189 - INFO - Epoch 20/40: LR: 0.000304
2025-12-24 21:56:16,442 - INFO - Epoch 20/40: Train Loss: 3.4629, Val Loss: 3.2831, Val Acc: 31.04%, Test Loss: 3.2831, Test Acc: 31.04%
2025-12-24 21:56:16,459 - INFO - Saving checkpoint for epoch 20...
2025-12-24 21:56:17,623 - INFO - ✅ Checkpoint saved: runs/run_238/checkpoint_epoch_20.pth
2025-12-24 22:37:11,215 - INFO - Epoch 21/40: LR: 0.000285
2025-12-24 22:37:11,234 - INFO - Epoch 21/40: Train Loss: 3.3582, Val Loss: 3.2653, Val Acc: 31.34%
2025-12-24 23:17:57,809 - INFO - Epoch 22/40: LR: 0.000265
2025-12-24 23:17:57,849 - INFO - Epoch 22/40: Train Loss: 3.2683, Val Loss: 3.1963, Val Acc: 32.40%
2025-12-24 23:59:04,112 - INFO - Epoch 23/40: LR: 0.000246
2025-12-24 23:59:04,127 - INFO - Epoch 23/40: Train Loss: 3.1641, Val Loss: 3.1240, Val Acc: 33.77%
2025-12-25 00:39:53,591 - INFO - Epoch 24/40: LR: 0.000228
2025-12-25 00:39:53,609 - INFO - Epoch 24/40: Train Loss: 3.0885, Val Loss: 3.1286, Val Acc: 33.38%
2025-12-25 01:21:20,295 - INFO - Epoch 25/40: LR: 0.000209
2025-12-25 01:35:05,905 - INFO - Epoch 25/40: Train Loss: 3.0125, Val Loss: 3.0490, Val Acc: 35.37%, Test Loss: 3.0490, Test Acc: 35.37%
2025-12-25 02:16:00,068 - INFO - Epoch 26/40: LR: 0.000191
2025-12-25 02:16:00,085 - INFO - Epoch 26/40: Train Loss: 2.9422, Val Loss: 3.0106, Val Acc: 35.73%
2025-12-25 02:57:18,608 - INFO - Epoch 27/40: LR: 0.000174
2025-12-25 02:57:18,613 - INFO - Epoch 27/40: Train Loss: 2.8567, Val Loss: 2.9409, Val Acc: 36.97%
2025-12-25 03:38:15,058 - INFO - Epoch 28/40: LR: 0.000157
2025-12-25 03:38:15,081 - INFO - Epoch 28/40: Train Loss: 2.7848, Val Loss: 2.9028, Val Acc: 37.86%
2025-12-25 04:19:25,797 - INFO - Epoch 29/40: LR: 0.000141
2025-12-25 04:19:25,835 - INFO - Epoch 29/40: Train Loss: 2.7234, Val Loss: 2.8636, Val Acc: 38.71%
2025-12-25 05:00:14,837 - INFO - Epoch 30/40: LR: 0.000126
2025-12-25 05:14:08,970 - INFO - Epoch 30/40: Train Loss: 2.6596, Val Loss: 2.8316, Val Acc: 39.38%, Test Loss: 2.8316, Test Acc: 39.38%
2025-12-25 05:14:08,986 - INFO - Saving checkpoint for epoch 30...
2025-12-25 05:14:10,146 - INFO - ✅ Checkpoint saved: runs/run_238/checkpoint_epoch_30.pth
2025-12-25 05:55:37,595 - INFO - Epoch 31/40: LR: 0.000113
2025-12-25 05:55:37,621 - INFO - Epoch 31/40: Train Loss: 2.6117, Val Loss: 2.8105, Val Acc: 39.85%
2025-12-25 06:36:16,986 - INFO - Epoch 32/40: LR: 0.000100
2025-12-25 06:36:17,024 - INFO - Epoch 32/40: Train Loss: 2.5566, Val Loss: 2.7903, Val Acc: 40.31%
2025-12-25 07:17:10,229 - INFO - Epoch 33/40: LR: 0.000089
2025-12-25 07:17:10,231 - INFO - Epoch 33/40: Train Loss: 2.5189, Val Loss: 2.7725, Val Acc: 40.28%
2025-12-25 07:57:58,042 - INFO - Epoch 34/40: LR: 0.000079
2025-12-25 07:57:58,047 - INFO - Epoch 34/40: Train Loss: 2.4638, Val Loss: 2.7336, Val Acc: 41.22%
2025-12-25 08:38:56,686 - INFO - Epoch 35/40: LR: 0.000070
2025-12-25 08:52:47,873 - INFO - Epoch 35/40: Train Loss: 2.4237, Val Loss: 2.7370, Val Acc: 41.07%, Test Loss: 2.7370, Test Acc: 41.07%
2025-12-25 09:33:33,106 - INFO - Epoch 36/40: LR: 0.000063
2025-12-25 09:33:33,150 - INFO - Epoch 36/40: Train Loss: 2.3842, Val Loss: 2.7238, Val Acc: 41.58%
2025-12-25 10:14:59,813 - INFO - Epoch 37/40: LR: 0.000057
2025-12-25 10:14:59,841 - INFO - Epoch 37/40: Train Loss: 2.3498, Val Loss: 2.7034, Val Acc: 42.09%
2025-12-25 10:55:45,426 - INFO - Epoch 38/40: LR: 0.000053
2025-12-25 10:55:45,471 - INFO - Epoch 38/40: Train Loss: 2.3220, Val Loss: 2.6990, Val Acc: 42.46%
2025-12-25 11:36:54,576 - INFO - Epoch 39/40: LR: 0.000051
2025-12-25 11:36:54,618 - INFO - Epoch 39/40: Train Loss: 2.3060, Val Loss: 2.7113, Val Acc: 42.24%
2025-12-25 12:17:44,652 - INFO - Epoch 40/40: LR: 0.000050
2025-12-25 12:31:19,891 - INFO - Epoch 40/40: Train Loss: 2.2854, Val Loss: 2.6864, Val Acc: 42.68%, Test Loss: 2.6864, Test Acc: 42.68%
2025-12-25 12:31:19,893 - INFO - Saving checkpoint for epoch 40...
2025-12-25 12:31:21,024 - INFO - ✅ Checkpoint saved: runs/run_238/checkpoint_epoch_40.pth
2025-12-25 12:31:21,027 - INFO - Training completed!
2025-12-25 12:31:21,029 - INFO - Training completed!
2025-12-25 12:31:21,031 - INFO - Generating training curves...
2025-12-25 12:31:24,470 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-25 12:31:24,472 - INFO - Training curves saved as separate images with base name 'runs/run_238/training_curves_from_scratch'
2025-12-25 12:31:24,473 - INFO - Generating confusion matrix on test set...
2025-12-25 13:37:00,107 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-25 13:51:53,392 - INFO - Final Test Results of from_scratch model: Loss: 2.6864, Accuracy: 42.68%
2025-12-25 13:51:53,417 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-25 13:51:54,173 - INFO - LR schedule plot saved to 'runs/run_238/lr_schedule_from_scratch.png'
2025-12-25 13:51:54,174 - INFO - 
Final Test Results:
2025-12-25 13:51:54,176 - INFO - Loss: 2.6864
2025-12-25 13:51:54,177 - INFO - Accuracy: 42.68%
2025-12-25 13:51:54,179 - INFO - Precision: 43.43%
2025-12-25 13:51:54,181 - INFO - Recall: 42.68%
2025-12-25 13:51:54,182 - INFO - F1 Score: 41.92%
2025-12-25 13:51:54,937 - INFO - Experiment completed. Results saved to runs/run_238/results_from_scratch.json
2025-12-25 13:51:54,944 - INFO - Experiment completed. Metadata saved to runs/run_238/metadata_from_scratch.json
2025-12-25 13:51:55,358 - INFO - ✅ Model weights saved: runs/run_238/final_model_from_scratch_weights.pth
2025-12-25 13:51:55,363 - INFO - Final model saved: runs/run_238/final_model_from_scratch_weights.pth
2025-12-25 13:51:55,365 - INFO - Final model metadata saved: runs/run_238/final_model_from_scratch_metadata.json
2025-12-25 13:51:55,367 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-25 13:51:55,368 - INFO - Final Accuracy: 42.68%
2025-12-25 13:51:55,370 - INFO - Final F1 Score: 41.92%
2025-12-25 13:51:55,371 - INFO - from_scratch experiment completed successfully!
