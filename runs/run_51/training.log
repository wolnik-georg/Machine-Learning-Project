2025-11-27 10:12:24,749 - INFO - Logging initialized. Log file: runs/run_51/training.log
2025-11-27 10:12:24,750 - INFO - Experiment directory: runs/run_51
2025-11-27 10:12:24,750 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-11-27 10:12:24,920 - INFO - Random seeds set to 42 (deterministic=False)
2025-11-27 10:12:24,920 - INFO - Using device: cuda
2025-11-27 10:12:24,921 - INFO - Training configuration: epochs=1, warmup=0, lr=0.001
2025-11-27 10:12:24,921 - INFO - Loading dataset...
2025-11-27 10:12:27,471 - INFO - Dataset loaded: train=1303, val=261, test=313 batches
2025-11-27 10:12:29,239 - INFO - Using pretrained model: swin_base_patch4_window7_224
2025-11-27 10:12:29,240 - INFO - Model architecture: Swin-Base
2025-11-27 10:12:29,240 - INFO - Initializing reference model...
2025-11-27 10:12:29,241 - INFO - Loading TIMM model: swin_base_patch4_window7_224 with pretrained weights
2025-11-27 10:12:30,514 - INFO - Loading pretrained weights from Hugging Face hub (timm/swin_base_patch4_window7_224.ms_in22k_ft_in1k)
2025-11-27 10:12:30,733 - INFO - HTTP Request: HEAD https://huggingface.co/timm/swin_base_patch4_window7_224.ms_in22k_ft_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-11-27 10:12:30,765 - INFO - [timm/swin_base_patch4_window7_224.ms_in22k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-27 10:12:31,306 - INFO - Successfully loaded swin_base_patch4_window7_224 from TIMM
2025-11-27 10:12:31,307 - INFO - Encoder loaded: 1024 output features
2025-11-27 10:12:31,308 - INFO - Created classification head: 1024 -> 100 classes
2025-11-27 10:12:31,310 - INFO - Reference model created. Trainable params (head only): 104,548
2025-11-27 10:12:31,671 - INFO - Detected Swin Transformer architecture
2025-11-27 10:12:31,672 - INFO - Detected model size: base
2025-11-27 10:12:31,673 - INFO - Initializing custom Swin model (size: base)...
2025-11-27 10:12:31,673 - INFO - Custom model will match architecture: embed_dim=128, depths=[2, 2, 18, 2], num_heads=[4, 8, 16, 32]
2025-11-27 10:12:32,733 - INFO - Transferring weights from reference to custom encoder...
2025-11-27 10:12:32,734 - INFO - Weight transfer: SwinTransformer -> SwinTransformerModel
2025-11-27 10:12:32,770 - INFO - Weight transfer: 325 layers transferred.
2025-11-27 10:12:32,833 - INFO - Weight transfer completed: {'transferred': 325, 'missing': 0, 'size_mismatches': 0}
2025-11-27 10:12:32,833 - INFO - ✓ All expected weights transferred successfully
2025-11-27 10:12:32,835 - INFO - Custom model created. Trainable params (head only): 104,548
2025-11-27 10:12:32,838 - INFO - Starting reference model training...
2025-11-27 10:12:32,839 - INFO - Optimizer: training head parameters only (encoder frozen)
2025-11-27 10:12:32,840 - INFO - Starting training...
2025-11-27 10:18:36,578 - INFO - Epoch 1/1: LR: 0.001100
2025-11-27 10:18:36,579 - INFO - Epoch 1/1: Train Loss: 2.8799, Val Loss: 1.5045, Val Acc: 80.57%
2025-11-27 10:18:36,579 - INFO - Training completed!
2025-11-27 10:18:36,580 - INFO - Reference model training completed!
2025-11-27 10:18:36,581 - INFO - Generating training curves...
2025-11-27 10:18:38,219 - INFO - Training curves saved as separate images with base name 'runs/run_51/training_curves_reference'
2025-11-27 10:18:38,220 - INFO - Generating confusion matrix on test set...
2025-11-27 10:20:53,994 - INFO - Performing final evaluation of reference model on test set...
2025-11-27 10:22:57,439 - INFO - Final Test Results of reference model: Loss: 1.4913, Accuracy: 81.00%
2025-11-27 10:22:57,440 - INFO - Generating LR schedule plot of reference model...
2025-11-27 10:22:57,739 - INFO - LR schedule plot saved to 'runs/run_51/lr_schedule_reference.png'
2025-11-27 10:22:57,740 - INFO - 
Final Test Results:
2025-11-27 10:22:57,741 - INFO - Loss: 1.4913
2025-11-27 10:22:57,741 - INFO - Accuracy: 81.00%
2025-11-27 10:22:57,742 - INFO - Precision: 81.39%
2025-11-27 10:22:57,743 - INFO - Recall: 81.00%
2025-11-27 10:22:57,743 - INFO - F1 Score: 80.77%
2025-11-27 10:22:57,749 - INFO - Experiment completed. Results saved to runs/run_51/results_reference.json
2025-11-27 10:22:57,752 - INFO - Experiment completed. Metadata saved to runs/run_51/metadata_reference.json
2025-11-27 10:22:58,583 - INFO - ✅ Model weights saved: trained_models/CIFAR100_final_model_reference_weights.pth
2025-11-27 10:22:58,583 - INFO - Starting custom model training...
2025-11-27 10:22:58,584 - INFO - Optimizer: training head parameters only (encoder frozen)
2025-11-27 10:22:58,585 - INFO - Starting training...
2025-11-27 10:29:03,532 - INFO - Epoch 1/1: LR: 0.001100
2025-11-27 10:29:03,533 - INFO - Epoch 1/1: Train Loss: 2.9166, Val Loss: 1.5154, Val Acc: 80.67%
2025-11-27 10:29:03,533 - INFO - Training completed!
2025-11-27 10:29:03,534 - INFO - Custom model training completed!
2025-11-27 10:29:03,535 - INFO - Generating training curves...
2025-11-27 10:29:05,140 - INFO - Training curves saved as separate images with base name 'runs/run_51/training_curves_custom'
2025-11-27 10:29:05,140 - INFO - Generating confusion matrix on test set...
2025-11-27 10:31:20,745 - INFO - Performing final evaluation of custom model on test set...
2025-11-27 10:33:24,393 - INFO - Final Test Results of custom model: Loss: 1.5031, Accuracy: 81.03%
2025-11-27 10:33:24,419 - INFO - Generating LR schedule plot of custom model...
2025-11-27 10:33:24,719 - INFO - LR schedule plot saved to 'runs/run_51/lr_schedule_custom.png'
2025-11-27 10:33:24,719 - INFO - 
Final Test Results:
2025-11-27 10:33:24,720 - INFO - Loss: 1.5031
2025-11-27 10:33:24,720 - INFO - Accuracy: 81.03%
2025-11-27 10:33:24,720 - INFO - Precision: 81.78%
2025-11-27 10:33:24,721 - INFO - Recall: 81.03%
2025-11-27 10:33:24,721 - INFO - F1 Score: 80.74%
2025-11-27 10:33:24,726 - INFO - Experiment completed. Results saved to runs/run_51/results_custom.json
2025-11-27 10:33:24,729 - INFO - Experiment completed. Metadata saved to runs/run_51/metadata_custom.json
2025-11-27 10:33:25,464 - INFO - ✅ Model weights saved: trained_models/CIFAR100_final_model_custom_weights.pth
2025-11-27 10:33:25,465 - INFO - === MODEL COMPARISON RESULTS (linear_probe on CIFAR100) ===
2025-11-27 10:33:25,465 - INFO - Reference (TIMM): 81.00%
2025-11-27 10:33:25,465 - INFO - Custom          : 81.03%
2025-11-27 10:33:25,466 - INFO - Difference      : 0.03%
2025-11-27 10:33:25,469 - INFO - linear_probe experiment completed successfully!
