2025-12-30 13:55:34,296 - INFO - Logging initialized. Log file: runs/run_245/training.log
2025-12-30 13:55:34,323 - INFO - Experiment directory: runs/run_245
2025-12-30 13:55:34,325 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-30 13:55:34,346 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-30 13:55:34,666 - INFO - GPU memory cleared at startup. Available: 11.6GB
2025-12-30 13:55:34,667 - INFO - Using device: cuda
2025-12-30 13:55:34,669 - INFO - Training configuration: epochs=50, warmup=3, lr=0.0003
2025-12-30 13:55:34,670 - INFO - RESNET configuration: {'type': 'resnet', 'layers': [3, 4, 6, 3], 'num_classes': 1000, 'use_gradient_checkpointing': False}
2025-12-30 13:55:34,672 - INFO - Loading dataset...
2025-12-30 13:55:34,675 - INFO - Starting ImageNet data loading from root: /
2025-12-30 13:55:34,676 - INFO - Resolved root path: /
2025-12-30 13:55:34,678 - INFO - Root path exists: True
2025-12-30 13:55:34,679 - INFO - Root path is dir: True
2025-12-30 13:55:34,688 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-30 13:55:34,690 - INFO - Expected train_dir: /train_set, exists: True
2025-12-30 13:55:34,691 - INFO - Expected val_dir: /val_set, exists: True
2025-12-30 13:55:48,743 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-30 13:55:51,698 - INFO - Dataset limits applied (stratified sampling enabled)
2025-12-30 13:55:51,701 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-30 13:55:53,646 - INFO - Training RESNET from scratch
2025-12-30 13:55:53,647 - INFO - Initializing RESNET model from scratch...
2025-12-30 13:55:53,649 - INFO - Model architecture: RESNET
2025-12-30 13:55:53,650 - INFO - Model config: {'type': 'resnet', 'layers': [3, 4, 6, 3], 'num_classes': 1000, 'use_gradient_checkpointing': False}
2025-12-30 13:55:54,928 - INFO - Model created with random initialization
2025-12-30 13:55:54,930 - INFO - Total parameters: 25,557,032
2025-12-30 13:55:54,931 - INFO - Trainable parameters: 25,557,032
2025-12-30 13:55:55,037 - INFO - Compiling model with torch.compile()
2025-12-30 13:55:58,974 - INFO - Mixed precision enabled → CUDA bf16 selected (hardware supported)
2025-12-30 13:55:58,975 - INFO - Starting from-scratch training...
2025-12-30 13:55:58,976 - INFO - Optimizer: training all model parameters
2025-12-30 13:55:58,980 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-30 13:55:58,982 - INFO - Starting training...
2025-12-30 14:38:16,676 - INFO - Epoch 1/50: LR: 0.000102
2025-12-30 14:38:16,691 - INFO - Epoch 1/50: Train Loss: 6.9712, Val Loss: 6.9011, Val Acc: 0.18%
2025-12-30 14:52:24,679 - INFO - Epoch 2/50: LR: 0.000201
2025-12-30 14:52:24,681 - INFO - Epoch 2/50: Train Loss: 6.8719, Val Loss: 6.5789, Val Acc: 0.86%
2025-12-30 15:08:08,830 - INFO - Epoch 3/50: LR: 0.000300
2025-12-30 15:08:08,832 - INFO - Epoch 3/50: Train Loss: 6.5132, Val Loss: 6.1610, Val Acc: 1.69%
2025-12-30 15:22:17,133 - INFO - Epoch 4/50: LR: 0.000300
2025-12-30 15:22:17,143 - INFO - Epoch 4/50: Train Loss: 6.2541, Val Loss: 5.8990, Val Acc: 2.51%
2025-12-30 15:35:40,994 - INFO - Epoch 5/50: LR: 0.000299
2025-12-30 15:40:25,657 - INFO - Epoch 5/50: Train Loss: 5.9832, Val Loss: 5.6534, Val Acc: 3.70%, Test Loss: 5.6534, Test Acc: 3.70%
2025-12-30 15:54:30,930 - INFO - Epoch 6/50: LR: 0.000297
2025-12-30 15:54:30,949 - INFO - Epoch 6/50: Train Loss: 5.7631, Val Loss: 5.5772, Val Acc: 4.47%
2025-12-30 16:09:06,568 - INFO - Epoch 7/50: LR: 0.000296
2025-12-30 16:09:06,572 - INFO - Epoch 7/50: Train Loss: 5.5681, Val Loss: 5.4463, Val Acc: 5.93%
2025-12-30 16:24:01,574 - INFO - Epoch 8/50: LR: 0.000293
2025-12-30 16:24:01,586 - INFO - Epoch 8/50: Train Loss: 5.3683, Val Loss: 4.9826, Val Acc: 8.53%
2025-12-30 16:40:57,239 - INFO - Epoch 9/50: LR: 0.000290
2025-12-30 16:40:57,244 - INFO - Epoch 9/50: Train Loss: 5.1820, Val Loss: 4.9228, Val Acc: 9.71%
2025-12-30 16:56:14,569 - INFO - Epoch 10/50: LR: 0.000287
2025-12-30 17:01:29,570 - INFO - Epoch 10/50: Train Loss: 5.0056, Val Loss: 4.7148, Val Acc: 11.46%, Test Loss: 4.7148, Test Acc: 11.46%
2025-12-30 17:01:29,574 - INFO - Saving checkpoint for epoch 10...
2025-12-30 17:01:30,950 - INFO - ✅ Checkpoint saved: runs/run_245/checkpoint_epoch_10.pth
2025-12-30 17:16:11,161 - INFO - Epoch 11/50: LR: 0.000283
2025-12-30 17:16:11,165 - INFO - Epoch 11/50: Train Loss: 4.8233, Val Loss: 4.5517, Val Acc: 13.30%
2025-12-30 17:30:50,020 - INFO - Epoch 12/50: LR: 0.000278
2025-12-30 17:30:50,023 - INFO - Epoch 12/50: Train Loss: 4.6630, Val Loss: 4.2878, Val Acc: 15.95%
2025-12-30 17:46:12,975 - INFO - Epoch 13/50: LR: 0.000273
2025-12-30 17:46:12,984 - INFO - Epoch 13/50: Train Loss: 4.5253, Val Loss: 4.2313, Val Acc: 16.87%
2025-12-30 18:02:10,467 - INFO - Epoch 14/50: LR: 0.000268
2025-12-30 18:02:10,474 - INFO - Epoch 14/50: Train Loss: 4.3606, Val Loss: 4.2544, Val Acc: 17.14%
2025-12-30 18:17:38,626 - INFO - Epoch 15/50: LR: 0.000262
2025-12-30 18:23:55,348 - INFO - Epoch 15/50: Train Loss: 4.2421, Val Loss: 3.9466, Val Acc: 20.72%, Test Loss: 3.9466, Test Acc: 20.72%
2025-12-30 18:39:32,322 - INFO - Epoch 16/50: LR: 0.000256
2025-12-30 18:39:32,357 - INFO - Epoch 16/50: Train Loss: 4.1130, Val Loss: 3.7725, Val Acc: 22.77%
