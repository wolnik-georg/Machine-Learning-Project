2025-12-10 09:02:47,274 - INFO - Logging initialized. Log file: runs/run_144/training.log
2025-12-10 09:02:47,276 - INFO - Experiment directory: runs/run_144
2025-12-10 09:02:47,278 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-10 09:02:47,391 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-10 09:02:47,392 - INFO - Using device: cuda
2025-12-10 09:02:47,394 - INFO - Training configuration: epochs=100, warmup=3, lr=0.0005
2025-12-10 09:02:47,396 - INFO - SWIN configuration: variant=tiny, use_shifted_window=True, use_relative_bias=False, use_absolute_pos_embed=True, use_hierarchical_merge=False
2025-12-10 09:02:47,397 - INFO - SWIN details: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7
2025-12-10 09:02:47,399 - INFO - Loading dataset...
2025-12-10 09:02:47,402 - INFO - Starting ImageNet data loading from root: /
2025-12-10 09:02:47,403 - INFO - Resolved root path: /
2025-12-10 09:02:47,405 - INFO - Root path exists: True
2025-12-10 09:02:47,407 - INFO - Root path is dir: True
2025-12-10 09:02:47,412 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-10 09:02:47,413 - INFO - Expected train_dir: /train_set, exists: True
2025-12-10 09:02:47,415 - INFO - Expected val_dir: /val_set, exists: True
2025-12-10 09:02:54,244 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-10 09:02:54,361 - INFO - Dataset loaded: train=50000 samples (391 batches), val=5000 samples (40 batches), test=5000 samples (40 batches)
2025-12-10 09:02:56,181 - INFO - Training Swin-Tiny from scratch
2025-12-10 09:02:56,183 - INFO - Initializing model from scratch...
2025-12-10 09:02:56,185 - INFO - Model architecture: Swin-Tiny
2025-12-10 09:02:56,186 - INFO - Model config: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7, use_shifted_window=True, use_relative_bias=False, use_absolute_pos_embed=True, use_hierarchical_merge=False
2025-12-10 09:02:56,693 - INFO - Model created with random initialization
2025-12-10 09:02:56,696 - INFO - Total parameters: 28,589,410
2025-12-10 09:02:56,698 - INFO - Trainable parameters: 28,589,410
2025-12-10 09:02:57,039 - INFO - Starting from-scratch training...
2025-12-10 09:02:57,041 - INFO - Optimizer: training all model parameters
2025-12-10 09:02:57,043 - INFO - Starting training...
2025-12-10 09:17:58,115 - INFO - Epoch 1/100: LR: 0.000170
2025-12-10 09:17:58,117 - INFO - Epoch 1/100: Train Loss: 6.9038, Val Loss: 6.8299, Val Acc: 0.34%
2025-12-10 09:31:40,832 - INFO - Epoch 2/100: LR: 0.000335
2025-12-10 09:31:40,834 - INFO - Epoch 2/100: Train Loss: 6.8210, Val Loss: 6.6959, Val Acc: 0.68%
2025-12-10 09:45:35,378 - INFO - Epoch 3/100: LR: 0.000500
2025-12-10 09:45:35,380 - INFO - Epoch 3/100: Train Loss: 6.7388, Val Loss: 6.6154, Val Acc: 0.64%
2025-12-10 09:59:14,319 - INFO - Epoch 4/100: LR: 0.000500
2025-12-10 09:59:14,321 - INFO - Epoch 4/100: Train Loss: 6.6238, Val Loss: 6.4872, Val Acc: 0.70%
2025-12-10 10:12:50,117 - INFO - Epoch 5/100: LR: 0.000499
2025-12-10 10:14:09,117 - INFO - Epoch 5/100: Train Loss: 6.4945, Val Loss: 6.3209, Val Acc: 1.10%, Test Loss: 6.3209, Test Acc: 1.10%
2025-12-10 10:27:47,711 - INFO - Epoch 6/100: LR: 0.000499
2025-12-10 10:27:47,713 - INFO - Epoch 6/100: Train Loss: 6.3683, Val Loss: 6.1797, Val Acc: 1.42%
2025-12-10 10:41:21,224 - INFO - Epoch 7/100: LR: 0.000498
2025-12-10 10:41:21,226 - INFO - Epoch 7/100: Train Loss: 6.2823, Val Loss: 6.0778, Val Acc: 2.20%
2025-12-10 10:54:56,689 - INFO - Epoch 8/100: LR: 0.000497
2025-12-10 10:54:56,718 - INFO - Epoch 8/100: Train Loss: 6.2162, Val Loss: 6.0482, Val Acc: 2.48%
2025-12-10 11:08:38,248 - INFO - Epoch 9/100: LR: 0.000495
2025-12-10 11:08:38,250 - INFO - Epoch 9/100: Train Loss: 6.1711, Val Loss: 5.9465, Val Acc: 2.32%
2025-12-10 11:22:21,174 - INFO - Epoch 10/100: LR: 0.000494
2025-12-10 11:23:41,279 - INFO - Epoch 10/100: Train Loss: 6.1176, Val Loss: 5.9214, Val Acc: 2.64%, Test Loss: 5.9214, Test Acc: 2.64%
2025-12-10 11:23:41,281 - INFO - Saving checkpoint for epoch 10...
2025-12-10 11:23:42,103 - INFO - ✅ Checkpoint saved: runs/run_144/checkpoint_epoch_10.pth
2025-12-10 11:37:21,607 - INFO - Epoch 11/100: LR: 0.000492
2025-12-10 11:37:21,609 - INFO - Epoch 11/100: Train Loss: 6.0760, Val Loss: 5.9198, Val Acc: 2.64%
2025-12-10 11:51:01,843 - INFO - Epoch 12/100: LR: 0.000489
2025-12-10 11:51:01,845 - INFO - Epoch 12/100: Train Loss: 6.0061, Val Loss: 5.7899, Val Acc: 3.56%
2025-12-10 12:05:00,599 - INFO - Epoch 13/100: LR: 0.000487
2025-12-10 12:05:00,601 - INFO - Epoch 13/100: Train Loss: 5.9409, Val Loss: 5.7584, Val Acc: 3.94%
2025-12-10 12:18:57,742 - INFO - Epoch 14/100: LR: 0.000484
2025-12-10 12:18:57,744 - INFO - Epoch 14/100: Train Loss: 5.9051, Val Loss: 5.6516, Val Acc: 4.24%
2025-12-10 12:32:40,391 - INFO - Epoch 15/100: LR: 0.000481
2025-12-10 12:34:00,444 - INFO - Epoch 15/100: Train Loss: 5.8398, Val Loss: 5.6745, Val Acc: 4.20%, Test Loss: 5.6745, Test Acc: 4.20%
2025-12-10 12:47:42,588 - INFO - Epoch 16/100: LR: 0.000478
2025-12-10 12:47:42,590 - INFO - Epoch 16/100: Train Loss: 5.7778, Val Loss: 5.5499, Val Acc: 5.04%
2025-12-10 13:01:36,216 - INFO - Epoch 17/100: LR: 0.000475
2025-12-10 13:01:36,218 - INFO - Epoch 17/100: Train Loss: 5.7120, Val Loss: 5.4936, Val Acc: 5.62%
2025-12-10 13:15:41,470 - INFO - Epoch 18/100: LR: 0.000471
2025-12-10 13:15:41,518 - INFO - Epoch 18/100: Train Loss: 5.6532, Val Loss: 5.4415, Val Acc: 5.80%
2025-12-10 13:29:38,340 - INFO - Epoch 19/100: LR: 0.000467
2025-12-10 13:29:38,342 - INFO - Epoch 19/100: Train Loss: 5.5965, Val Loss: 5.3342, Val Acc: 7.08%
2025-12-10 13:43:29,259 - INFO - Epoch 20/100: LR: 0.000463
2025-12-10 13:44:48,581 - INFO - Epoch 20/100: Train Loss: 5.5315, Val Loss: 5.3051, Val Acc: 7.64%, Test Loss: 5.3051, Test Acc: 7.64%
2025-12-10 13:44:48,583 - INFO - Saving checkpoint for epoch 20...
2025-12-10 13:44:49,256 - INFO - ✅ Checkpoint saved: runs/run_144/checkpoint_epoch_20.pth
2025-12-10 13:58:29,969 - INFO - Epoch 21/100: LR: 0.000459
2025-12-10 13:58:29,972 - INFO - Epoch 21/100: Train Loss: 5.4766, Val Loss: 5.2569, Val Acc: 7.72%
