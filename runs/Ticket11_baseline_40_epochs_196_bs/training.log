2025-12-12 07:57:22,956 - INFO - Logging initialized. Log file: runs/run_169/training.log
2025-12-12 07:57:22,958 - INFO - Experiment directory: runs/run_169
2025-12-12 07:57:22,959 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-12 07:57:23,231 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-12 07:57:23,477 - INFO - GPU memory cleared at startup. Available: 23.5GB
2025-12-12 07:57:23,478 - INFO - Using device: cuda
2025-12-12 07:57:23,479 - INFO - Training configuration: epochs=40, warmup=3, lr=0.0004
2025-12-12 07:57:23,480 - INFO - SWIN configuration: variant=tiny, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False
2025-12-12 07:57:23,481 - INFO - SWIN details: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7
2025-12-12 07:57:23,482 - INFO - Loading dataset...
2025-12-12 07:57:23,484 - INFO - Starting ImageNet data loading from root: /
2025-12-12 07:57:23,485 - INFO - Resolved root path: /
2025-12-12 07:57:23,487 - INFO - Root path exists: True
2025-12-12 07:57:23,487 - INFO - Root path is dir: True
2025-12-12 07:57:23,496 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-12 07:57:23,498 - INFO - Expected train_dir: /train_set, exists: True
2025-12-12 07:57:23,499 - INFO - Expected val_dir: /val_set, exists: True
2025-12-12 07:57:36,855 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-12 07:57:37,073 - INFO - Dataset loaded: train=100000 samples (521 batches), val=50000 samples (261 batches), test=50000 samples (261 batches)
2025-12-12 07:57:40,325 - INFO - Training Swin-Tiny from scratch
2025-12-12 07:57:40,326 - INFO - Initializing model from scratch...
2025-12-12 07:57:40,328 - INFO - Model architecture: Swin-Tiny
2025-12-12 07:57:40,329 - INFO - Model config: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False
2025-12-12 07:57:40,982 - INFO - Model created with random initialization
2025-12-12 07:57:40,983 - INFO - Total parameters: 28,288,354
2025-12-12 07:57:40,984 - INFO - Trainable parameters: 28,288,354
2025-12-12 07:57:41,046 - INFO - Starting from-scratch training...
2025-12-12 07:57:41,047 - INFO - Optimizer: training all model parameters
2025-12-12 07:57:41,050 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-12 07:57:41,051 - INFO - Starting training...
2025-12-12 08:52:43,125 - INFO - Epoch 1/40: LR: 0.000136
2025-12-12 08:52:43,150 - INFO - Epoch 1/40: Train Loss: 6.8917, Val Loss: 6.8066, Val Acc: 0.47%
2025-12-12 09:26:10,024 - INFO - Epoch 2/40: LR: 0.000268
2025-12-12 09:26:10,028 - INFO - Epoch 2/40: Train Loss: 6.7676, Val Loss: 6.5565, Val Acc: 0.93%
2025-12-12 09:59:38,905 - INFO - Epoch 3/40: LR: 0.000400
2025-12-12 09:59:39,503 - INFO - Epoch 3/40: Train Loss: 6.4881, Val Loss: 6.1339, Val Acc: 1.81%
2025-12-12 10:32:31,306 - INFO - Epoch 4/40: LR: 0.000399
2025-12-12 10:32:31,360 - INFO - Epoch 4/40: Train Loss: 6.2439, Val Loss: 5.9479, Val Acc: 2.44%
2025-12-12 11:05:32,211 - INFO - Epoch 5/40: LR: 0.000397
2025-12-12 11:15:56,549 - INFO - Epoch 5/40: Train Loss: 6.0492, Val Loss: 5.7114, Val Acc: 3.57%, Test Loss: 5.7114, Test Acc: 3.57%
2025-12-12 11:49:07,863 - INFO - Epoch 6/40: LR: 0.000394
2025-12-12 11:49:07,889 - INFO - Epoch 6/40: Train Loss: 5.8863, Val Loss: 5.5310, Val Acc: 4.96%
2025-12-12 12:22:32,135 - INFO - Epoch 7/40: LR: 0.000390
2025-12-12 12:22:32,162 - INFO - Epoch 7/40: Train Loss: 5.7418, Val Loss: 5.4152, Val Acc: 5.52%
2025-12-12 12:55:26,664 - INFO - Epoch 8/40: LR: 0.000384
2025-12-12 12:55:26,694 - INFO - Epoch 8/40: Train Loss: 5.6240, Val Loss: 5.3021, Val Acc: 6.60%
2025-12-12 13:28:35,001 - INFO - Epoch 9/40: LR: 0.000378
2025-12-12 13:28:35,026 - INFO - Epoch 9/40: Train Loss: 5.5044, Val Loss: 5.1080, Val Acc: 7.90%
2025-12-12 14:01:11,067 - INFO - Epoch 10/40: LR: 0.000370
2025-12-12 14:11:46,344 - INFO - Epoch 10/40: Train Loss: 5.4014, Val Loss: 5.0048, Val Acc: 9.31%, Test Loss: 5.0048, Test Acc: 9.31%
2025-12-12 14:11:46,353 - INFO - Saving checkpoint for epoch 10...
2025-12-12 14:11:47,341 - INFO - ✅ Checkpoint saved: runs/run_169/checkpoint_epoch_10.pth
2025-12-12 14:45:22,424 - INFO - Epoch 11/40: LR: 0.000361
2025-12-12 14:45:22,435 - INFO - Epoch 11/40: Train Loss: 5.3049, Val Loss: 4.9279, Val Acc: 9.70%
2025-12-12 15:19:37,940 - INFO - Epoch 12/40: LR: 0.000351
2025-12-12 15:19:37,972 - INFO - Epoch 12/40: Train Loss: 5.2035, Val Loss: 4.8290, Val Acc: 10.78%
2025-12-12 15:53:22,195 - INFO - Epoch 13/40: LR: 0.000341
2025-12-12 15:53:22,204 - INFO - Epoch 13/40: Train Loss: 5.1216, Val Loss: 4.7632, Val Acc: 11.53%
2025-12-12 16:26:05,147 - INFO - Epoch 14/40: LR: 0.000329
2025-12-12 16:26:05,148 - INFO - Epoch 14/40: Train Loss: 5.0384, Val Loss: 4.6845, Val Acc: 12.28%
2025-12-12 16:59:25,755 - INFO - Epoch 15/40: LR: 0.000317
2025-12-12 17:10:00,392 - INFO - Epoch 15/40: Train Loss: 4.9551, Val Loss: 4.6052, Val Acc: 13.31%, Test Loss: 4.6052, Test Acc: 13.31%
2025-12-12 17:42:55,814 - INFO - Epoch 16/40: LR: 0.000304
2025-12-12 17:42:55,815 - INFO - Epoch 16/40: Train Loss: 4.8790, Val Loss: 4.5771, Val Acc: 13.81%
2025-12-12 18:16:11,738 - INFO - Epoch 17/40: LR: 0.000290
2025-12-12 18:16:11,777 - INFO - Epoch 17/40: Train Loss: 4.7914, Val Loss: 4.4972, Val Acc: 14.38%
2025-12-12 18:48:43,321 - INFO - Epoch 18/40: LR: 0.000276
2025-12-12 18:48:43,323 - INFO - Epoch 18/40: Train Loss: 4.7107, Val Loss: 4.4383, Val Acc: 15.70%
2025-12-12 19:21:37,884 - INFO - Epoch 19/40: LR: 0.000262
2025-12-12 19:21:37,892 - INFO - Epoch 19/40: Train Loss: 4.6299, Val Loss: 4.3260, Val Acc: 16.58%
2025-12-12 19:55:15,234 - INFO - Epoch 20/40: LR: 0.000247
2025-12-12 20:05:49,942 - INFO - Epoch 20/40: Train Loss: 4.5485, Val Loss: 4.2717, Val Acc: 17.24%, Test Loss: 4.2717, Test Acc: 17.24%
2025-12-12 20:05:49,975 - INFO - Saving checkpoint for epoch 20...
2025-12-12 20:05:51,191 - INFO - ✅ Checkpoint saved: runs/run_169/checkpoint_epoch_20.pth
2025-12-12 20:40:50,395 - INFO - Epoch 21/40: LR: 0.000232
2025-12-12 20:40:50,396 - INFO - Epoch 21/40: Train Loss: 4.4767, Val Loss: 4.2373, Val Acc: 17.61%
2025-12-12 21:15:33,509 - INFO - Epoch 22/40: LR: 0.000218
2025-12-12 21:15:33,540 - INFO - Epoch 22/40: Train Loss: 4.4002, Val Loss: 4.1721, Val Acc: 18.29%
2025-12-12 21:49:41,304 - INFO - Epoch 23/40: LR: 0.000203
2025-12-12 21:49:41,344 - INFO - Epoch 23/40: Train Loss: 4.3239, Val Loss: 4.1098, Val Acc: 19.32%
2025-12-12 22:23:05,413 - INFO - Epoch 24/40: LR: 0.000188
2025-12-12 22:23:05,456 - INFO - Epoch 24/40: Train Loss: 4.2566, Val Loss: 4.0502, Val Acc: 20.08%
2025-12-12 22:55:58,342 - INFO - Epoch 25/40: LR: 0.000174
2025-12-12 23:06:21,879 - INFO - Epoch 25/40: Train Loss: 4.1690, Val Loss: 4.0212, Val Acc: 20.58%, Test Loss: 4.0212, Test Acc: 20.58%
2025-12-12 23:40:21,530 - INFO - Epoch 26/40: LR: 0.000160
2025-12-12 23:40:21,536 - INFO - Epoch 26/40: Train Loss: 4.1100, Val Loss: 3.9499, Val Acc: 21.67%
2025-12-13 00:13:00,541 - INFO - Epoch 27/40: LR: 0.000146
2025-12-13 00:13:00,551 - INFO - Epoch 27/40: Train Loss: 4.0374, Val Loss: 3.9249, Val Acc: 22.03%
2025-12-13 00:46:39,890 - INFO - Epoch 28/40: LR: 0.000133
2025-12-13 00:46:39,958 - INFO - Epoch 28/40: Train Loss: 3.9787, Val Loss: 3.8656, Val Acc: 22.78%
2025-12-13 01:19:50,937 - INFO - Epoch 29/40: LR: 0.000121
2025-12-13 01:19:50,971 - INFO - Epoch 29/40: Train Loss: 3.9221, Val Loss: 3.8334, Val Acc: 23.32%
2025-12-13 01:52:47,471 - INFO - Epoch 30/40: LR: 0.000109
2025-12-13 02:03:10,475 - INFO - Epoch 30/40: Train Loss: 3.8602, Val Loss: 3.8029, Val Acc: 23.91%, Test Loss: 3.8029, Test Acc: 23.91%
2025-12-13 02:03:10,494 - INFO - Saving checkpoint for epoch 30...
2025-12-13 02:03:11,640 - INFO - ✅ Checkpoint saved: runs/run_169/checkpoint_epoch_30.pth
2025-12-13 02:36:27,390 - INFO - Epoch 31/40: LR: 0.000099
2025-12-13 02:36:27,417 - INFO - Epoch 31/40: Train Loss: 3.8016, Val Loss: 3.7591, Val Acc: 24.33%
2025-12-13 03:09:16,602 - INFO - Epoch 32/40: LR: 0.000089
2025-12-13 03:09:16,622 - INFO - Epoch 32/40: Train Loss: 3.7509, Val Loss: 3.7376, Val Acc: 24.92%
2025-12-13 03:42:18,319 - INFO - Epoch 33/40: LR: 0.000080
2025-12-13 03:42:18,364 - INFO - Epoch 33/40: Train Loss: 3.6987, Val Loss: 3.7250, Val Acc: 24.97%
2025-12-13 04:17:02,814 - INFO - Epoch 34/40: LR: 0.000072
2025-12-13 04:17:02,850 - INFO - Epoch 34/40: Train Loss: 3.6656, Val Loss: 3.6714, Val Acc: 25.82%
2025-12-13 04:50:45,529 - INFO - Epoch 35/40: LR: 0.000066
2025-12-13 05:01:09,770 - INFO - Epoch 35/40: Train Loss: 3.6147, Val Loss: 3.6642, Val Acc: 25.96%, Test Loss: 3.6642, Test Acc: 25.96%
2025-12-13 05:33:58,602 - INFO - Epoch 36/40: LR: 0.000060
2025-12-13 05:33:58,820 - INFO - Epoch 36/40: Train Loss: 3.5867, Val Loss: 3.6432, Val Acc: 26.33%
2025-12-13 06:06:55,222 - INFO - Epoch 37/40: LR: 0.000056
2025-12-13 06:06:55,229 - INFO - Epoch 37/40: Train Loss: 3.5534, Val Loss: 3.6398, Val Acc: 26.40%
2025-12-13 06:39:27,387 - INFO - Epoch 38/40: LR: 0.000053
2025-12-13 06:39:27,388 - INFO - Epoch 38/40: Train Loss: 3.5154, Val Loss: 3.6286, Val Acc: 26.80%
2025-12-13 07:12:19,124 - INFO - Epoch 39/40: LR: 0.000051
2025-12-13 07:12:19,192 - INFO - Epoch 39/40: Train Loss: 3.4938, Val Loss: 3.6128, Val Acc: 26.90%
2025-12-13 07:44:53,699 - INFO - Epoch 40/40: LR: 0.000050
2025-12-13 07:55:22,627 - INFO - Epoch 40/40: Train Loss: 3.4588, Val Loss: 3.5942, Val Acc: 27.05%, Test Loss: 3.5942, Test Acc: 27.05%
2025-12-13 07:55:22,651 - INFO - Saving checkpoint for epoch 40...
2025-12-13 07:55:23,759 - INFO - ✅ Checkpoint saved: runs/run_169/checkpoint_epoch_40.pth
2025-12-13 07:55:23,761 - INFO - Training completed!
2025-12-13 07:55:23,763 - INFO - Training completed!
2025-12-13 07:55:23,765 - INFO - Generating training curves...
2025-12-13 07:55:26,711 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-13 07:55:26,713 - INFO - Training curves saved as separate images with base name 'runs/run_169/training_curves_from_scratch'
2025-12-13 07:55:26,714 - INFO - Generating confusion matrix on test set...
2025-12-13 08:26:02,505 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-13 08:37:24,266 - INFO - Final Test Results of from_scratch model: Loss: 3.5942, Accuracy: 27.05%
2025-12-13 08:37:24,268 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-13 08:37:24,681 - INFO - LR schedule plot saved to 'runs/run_169/lr_schedule_from_scratch.png'
2025-12-13 08:37:24,682 - INFO - 
Final Test Results:
2025-12-13 08:37:24,683 - INFO - Loss: 3.5942
2025-12-13 08:37:24,684 - INFO - Accuracy: 27.05%
2025-12-13 08:37:24,685 - INFO - Precision: 26.52%
2025-12-13 08:37:24,686 - INFO - Recall: 27.05%
2025-12-13 08:37:24,688 - INFO - F1 Score: 25.65%
2025-12-13 08:37:24,865 - INFO - Experiment completed. Results saved to runs/run_169/results_from_scratch.json
2025-12-13 08:37:24,870 - INFO - Experiment completed. Metadata saved to runs/run_169/metadata_from_scratch.json
2025-12-13 08:37:25,219 - INFO - ✅ Model weights saved: runs/run_169/final_model_from_scratch_weights.pth
2025-12-13 08:37:25,223 - INFO - Final model saved: runs/run_169/final_model_from_scratch_weights.pth
2025-12-13 08:37:25,224 - INFO - Final model metadata saved: runs/run_169/final_model_from_scratch_metadata.json
2025-12-13 08:37:25,226 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-13 08:37:25,227 - INFO - Final Accuracy: 27.05%
2025-12-13 08:37:25,228 - INFO - Final F1 Score: 25.65%
2025-12-13 08:37:25,232 - INFO - from_scratch experiment completed successfully!
