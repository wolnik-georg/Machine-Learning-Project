2025-12-19 16:47:55,891 - INFO - Logging initialized. Log file: runs/run_230/training.log
2025-12-19 16:47:55,902 - INFO - Experiment directory: runs/run_230
2025-12-19 16:47:55,903 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-19 16:47:55,925 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-19 16:47:56,373 - INFO - GPU memory cleared at startup. Available: 23.5GB
2025-12-19 16:47:56,374 - INFO - Using device: cuda
2025-12-19 16:47:56,376 - INFO - Training configuration: epochs=40, warmup=3, lr=0.0005
2025-12-19 16:47:56,377 - INFO - VIT configuration: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-19 16:47:56,379 - INFO - Loading dataset...
2025-12-19 16:47:56,381 - INFO - Starting ImageNet data loading from root: /
2025-12-19 16:47:56,382 - INFO - Resolved root path: /
2025-12-19 16:47:56,383 - INFO - Root path exists: True
2025-12-19 16:47:56,385 - INFO - Root path is dir: True
2025-12-19 16:47:56,394 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-19 16:47:56,396 - INFO - Expected train_dir: /train_set, exists: True
2025-12-19 16:47:56,398 - INFO - Expected val_dir: /val_set, exists: True
2025-12-19 16:48:10,282 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-19 16:48:10,487 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-19 16:48:14,468 - INFO - Training VIT from scratch
2025-12-19 16:48:14,494 - INFO - Initializing VIT model from scratch...
2025-12-19 16:48:14,496 - INFO - Model architecture: VIT
2025-12-19 16:48:14,497 - INFO - Model config: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-19 16:48:15,136 - INFO - Model created with random initialization
2025-12-19 16:48:15,137 - INFO - Total parameters: 29,854,376
2025-12-19 16:48:15,138 - INFO - Trainable parameters: 29,854,376
2025-12-19 16:48:15,210 - INFO - Starting from-scratch training...
2025-12-19 16:48:15,212 - INFO - Optimizer: training all model parameters
2025-12-19 16:48:15,214 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-19 16:48:15,216 - INFO - Starting training...
2025-12-19 17:31:27,890 - INFO - Epoch 1/40: LR: 0.000170
2025-12-19 17:31:27,896 - INFO - Epoch 1/40: Train Loss: 6.8936, Val Loss: 6.8025, Val Acc: 0.47%
2025-12-19 18:09:15,887 - INFO - Epoch 2/40: LR: 0.000335
2025-12-19 18:09:15,892 - INFO - Epoch 2/40: Train Loss: 6.7229, Val Loss: 6.4320, Val Acc: 1.36%
2025-12-19 18:46:13,142 - INFO - Epoch 3/40: LR: 0.000500
2025-12-19 18:46:13,177 - INFO - Epoch 3/40: Train Loss: 6.4491, Val Loss: 6.1231, Val Acc: 2.30%
2025-12-19 19:22:32,259 - INFO - Epoch 4/40: LR: 0.000499
2025-12-19 19:22:32,294 - INFO - Epoch 4/40: Train Loss: 6.3081, Val Loss: 6.0413, Val Acc: 2.69%
2025-12-19 19:58:38,295 - INFO - Epoch 5/40: LR: 0.000497
2025-12-19 20:09:12,441 - INFO - Epoch 5/40: Train Loss: 6.2391, Val Loss: 6.0155, Val Acc: 2.79%, Test Loss: 6.0155, Test Acc: 2.79%
2025-12-19 20:45:58,639 - INFO - Epoch 6/40: LR: 0.000493
2025-12-19 20:45:58,640 - INFO - Epoch 6/40: Train Loss: 6.1691, Val Loss: 5.8897, Val Acc: 3.45%
2025-12-19 21:22:30,741 - INFO - Epoch 7/40: LR: 0.000487
2025-12-19 21:22:30,744 - INFO - Epoch 7/40: Train Loss: 6.0923, Val Loss: 5.8875, Val Acc: 3.82%
2025-12-19 21:59:16,820 - INFO - Epoch 8/40: LR: 0.000480
2025-12-19 21:59:16,948 - INFO - Epoch 8/40: Train Loss: 6.0451, Val Loss: 5.7975, Val Acc: 4.30%
2025-12-19 22:38:53,225 - INFO - Epoch 9/40: LR: 0.000471
2025-12-19 22:38:53,282 - INFO - Epoch 9/40: Train Loss: 5.9633, Val Loss: 5.6686, Val Acc: 4.88%
2025-12-19 23:15:58,792 - INFO - Epoch 10/40: LR: 0.000461
2025-12-19 23:26:29,495 - INFO - Epoch 10/40: Train Loss: 5.8847, Val Loss: 5.6424, Val Acc: 5.29%, Test Loss: 5.6424, Test Acc: 5.29%
2025-12-19 23:26:29,527 - INFO - Saving checkpoint for epoch 10...
2025-12-19 23:26:30,566 - INFO - ✅ Checkpoint saved: runs/run_230/checkpoint_epoch_10.pth
2025-12-20 00:06:17,160 - INFO - Epoch 11/40: LR: 0.000450
2025-12-20 00:06:17,345 - INFO - Epoch 11/40: Train Loss: 5.8201, Val Loss: 5.5205, Val Acc: 6.18%
2025-12-20 00:45:09,277 - INFO - Epoch 12/40: LR: 0.000437
2025-12-20 00:45:09,318 - INFO - Epoch 12/40: Train Loss: 5.7105, Val Loss: 5.4378, Val Acc: 6.70%
2025-12-20 01:25:09,022 - INFO - Epoch 13/40: LR: 0.000424
2025-12-20 01:25:09,202 - INFO - Epoch 13/40: Train Loss: 5.6509, Val Loss: 5.3598, Val Acc: 7.38%
2025-12-20 02:00:14,031 - INFO - Epoch 14/40: LR: 0.000409
2025-12-20 02:00:14,083 - INFO - Epoch 14/40: Train Loss: 5.5659, Val Loss: 5.2865, Val Acc: 7.84%
2025-12-20 02:36:22,813 - INFO - Epoch 15/40: LR: 0.000393
2025-12-20 02:46:38,421 - INFO - Epoch 15/40: Train Loss: 5.4912, Val Loss: 5.2554, Val Acc: 8.40%, Test Loss: 5.2554, Test Acc: 8.40%
2025-12-20 03:25:26,599 - INFO - Epoch 16/40: LR: 0.000376
2025-12-20 03:25:26,647 - INFO - Epoch 16/40: Train Loss: 5.4165, Val Loss: 5.1967, Val Acc: 8.52%
2025-12-20 04:04:09,026 - INFO - Epoch 17/40: LR: 0.000359
2025-12-20 04:04:09,059 - INFO - Epoch 17/40: Train Loss: 5.3425, Val Loss: 5.1036, Val Acc: 9.51%
2025-12-20 04:43:04,227 - INFO - Epoch 18/40: LR: 0.000341
2025-12-20 04:43:04,255 - INFO - Epoch 18/40: Train Loss: 5.2788, Val Loss: 5.0618, Val Acc: 9.75%
2025-12-20 05:23:23,574 - INFO - Epoch 19/40: LR: 0.000322
2025-12-20 05:23:23,676 - INFO - Epoch 19/40: Train Loss: 5.1965, Val Loss: 4.9835, Val Acc: 10.63%
2025-12-20 06:03:53,765 - INFO - Epoch 20/40: LR: 0.000304
2025-12-20 06:14:16,137 - INFO - Epoch 20/40: Train Loss: 5.1250, Val Loss: 4.9928, Val Acc: 10.69%, Test Loss: 4.9928, Test Acc: 10.69%
2025-12-20 06:14:16,177 - INFO - Saving checkpoint for epoch 20...
2025-12-20 06:14:17,723 - INFO - ✅ Checkpoint saved: runs/run_230/checkpoint_epoch_20.pth
2025-12-20 06:52:14,609 - INFO - Epoch 21/40: LR: 0.000285
2025-12-20 06:52:14,648 - INFO - Epoch 21/40: Train Loss: 5.0520, Val Loss: 4.9168, Val Acc: 11.39%
2025-12-20 07:28:50,436 - INFO - Epoch 22/40: LR: 0.000265
2025-12-20 07:28:50,468 - INFO - Epoch 22/40: Train Loss: 4.9778, Val Loss: 4.8731, Val Acc: 11.65%
2025-12-20 08:06:12,007 - INFO - Epoch 23/40: LR: 0.000246
2025-12-20 08:06:12,042 - INFO - Epoch 23/40: Train Loss: 4.9005, Val Loss: 4.8573, Val Acc: 12.23%
2025-12-20 08:41:57,432 - INFO - Epoch 24/40: LR: 0.000228
2025-12-20 08:41:57,439 - INFO - Epoch 24/40: Train Loss: 4.8284, Val Loss: 4.7589, Val Acc: 13.24%
2025-12-20 09:17:21,316 - INFO - Epoch 25/40: LR: 0.000209
2025-12-20 09:27:36,182 - INFO - Epoch 25/40: Train Loss: 4.7505, Val Loss: 4.7404, Val Acc: 13.46%, Test Loss: 4.7404, Test Acc: 13.46%
2025-12-20 10:02:16,112 - INFO - Epoch 26/40: LR: 0.000191
2025-12-20 10:02:16,119 - INFO - Epoch 26/40: Train Loss: 4.6754, Val Loss: 4.7045, Val Acc: 13.99%
2025-12-20 10:36:33,245 - INFO - Epoch 27/40: LR: 0.000174
2025-12-20 10:36:33,247 - INFO - Epoch 27/40: Train Loss: 4.6050, Val Loss: 4.6597, Val Acc: 14.40%
2025-12-20 11:11:07,145 - INFO - Epoch 28/40: LR: 0.000157
2025-12-20 11:11:07,147 - INFO - Epoch 28/40: Train Loss: 4.5333, Val Loss: 4.6415, Val Acc: 14.81%
2025-12-20 11:45:29,688 - INFO - Epoch 29/40: LR: 0.000141
2025-12-20 11:45:29,694 - INFO - Epoch 29/40: Train Loss: 4.4628, Val Loss: 4.6041, Val Acc: 15.24%
2025-12-20 12:22:37,984 - INFO - Epoch 30/40: LR: 0.000126
2025-12-20 12:33:01,375 - INFO - Epoch 30/40: Train Loss: 4.3928, Val Loss: 4.6013, Val Acc: 15.30%, Test Loss: 4.6013, Test Acc: 15.30%
2025-12-20 12:33:01,377 - INFO - Saving checkpoint for epoch 30...
2025-12-20 12:33:02,634 - INFO - ✅ Checkpoint saved: runs/run_230/checkpoint_epoch_30.pth
2025-12-20 13:10:08,325 - INFO - Epoch 31/40: LR: 0.000113
2025-12-20 13:10:08,387 - INFO - Epoch 31/40: Train Loss: 4.3334, Val Loss: 4.5590, Val Acc: 15.78%
2025-12-20 13:50:13,645 - INFO - Epoch 32/40: LR: 0.000100
2025-12-20 13:50:13,690 - INFO - Epoch 32/40: Train Loss: 4.2663, Val Loss: 4.5715, Val Acc: 15.89%
2025-12-20 14:30:59,963 - INFO - Epoch 33/40: LR: 0.000089
2025-12-20 14:30:59,986 - INFO - Epoch 33/40: Train Loss: 4.2147, Val Loss: 4.5323, Val Acc: 16.29%
2025-12-20 15:08:33,384 - INFO - Epoch 34/40: LR: 0.000079
2025-12-20 15:08:33,479 - INFO - Epoch 34/40: Train Loss: 4.1556, Val Loss: 4.5293, Val Acc: 16.48%
2025-12-20 15:44:39,447 - INFO - Epoch 35/40: LR: 0.000070
2025-12-20 15:55:01,884 - INFO - Epoch 35/40: Train Loss: 4.1102, Val Loss: 4.5099, Val Acc: 16.66%, Test Loss: 4.5099, Test Acc: 16.66%
2025-12-20 16:37:41,700 - INFO - Epoch 36/40: LR: 0.000063
2025-12-20 16:37:41,705 - INFO - Epoch 36/40: Train Loss: 4.0675, Val Loss: 4.4936, Val Acc: 16.95%
2025-12-20 17:16:18,837 - INFO - Epoch 37/40: LR: 0.000057
2025-12-20 17:16:18,901 - INFO - Epoch 37/40: Train Loss: 4.0266, Val Loss: 4.4909, Val Acc: 16.91%
2025-12-20 17:52:41,252 - INFO - Epoch 38/40: LR: 0.000053
2025-12-20 17:52:41,323 - INFO - Epoch 38/40: Train Loss: 3.9822, Val Loss: 4.4771, Val Acc: 17.25%
2025-12-20 18:26:06,150 - INFO - Epoch 39/40: LR: 0.000051
2025-12-20 18:26:06,154 - INFO - Epoch 39/40: Train Loss: 3.9519, Val Loss: 4.4678, Val Acc: 17.21%
2025-12-20 19:00:22,456 - INFO - Epoch 40/40: LR: 0.000050
2025-12-20 19:10:35,780 - INFO - Epoch 40/40: Train Loss: 3.9270, Val Loss: 4.4729, Val Acc: 17.28%, Test Loss: 4.4729, Test Acc: 17.28%
2025-12-20 19:10:35,795 - INFO - Saving checkpoint for epoch 40...
2025-12-20 19:10:36,796 - INFO - ✅ Checkpoint saved: runs/run_230/checkpoint_epoch_40.pth
2025-12-20 19:10:36,798 - INFO - Training completed!
2025-12-20 19:10:36,800 - INFO - Training completed!
2025-12-20 19:10:36,801 - INFO - Generating training curves...
2025-12-20 19:10:39,760 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-20 19:10:39,762 - INFO - Training curves saved as separate images with base name 'runs/run_230/training_curves_from_scratch'
2025-12-20 19:10:39,763 - INFO - Generating confusion matrix on test set...
2025-12-20 19:40:14,939 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-20 19:51:24,109 - INFO - Final Test Results of from_scratch model: Loss: 4.4729, Accuracy: 17.28%
2025-12-20 19:51:24,122 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-20 19:51:24,691 - INFO - LR schedule plot saved to 'runs/run_230/lr_schedule_from_scratch.png'
2025-12-20 19:51:24,693 - INFO - 
Final Test Results:
2025-12-20 19:51:24,695 - INFO - Loss: 4.4729
2025-12-20 19:51:24,696 - INFO - Accuracy: 17.28%
2025-12-20 19:51:24,698 - INFO - Precision: 15.69%
2025-12-20 19:51:24,699 - INFO - Recall: 17.28%
2025-12-20 19:51:24,701 - INFO - F1 Score: 15.71%
2025-12-20 19:51:24,873 - INFO - Experiment completed. Results saved to runs/run_230/results_from_scratch.json
2025-12-20 19:51:24,877 - INFO - Experiment completed. Metadata saved to runs/run_230/metadata_from_scratch.json
2025-12-20 19:51:25,391 - INFO - ✅ Model weights saved: runs/run_230/final_model_from_scratch_weights.pth
2025-12-20 19:51:25,396 - INFO - Final model saved: runs/run_230/final_model_from_scratch_weights.pth
2025-12-20 19:51:25,398 - INFO - Final model metadata saved: runs/run_230/final_model_from_scratch_metadata.json
2025-12-20 19:51:25,399 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-20 19:51:25,401 - INFO - Final Accuracy: 17.28%
2025-12-20 19:51:25,402 - INFO - Final F1 Score: 15.71%
2025-12-20 19:51:25,406 - INFO - from_scratch experiment completed successfully!
