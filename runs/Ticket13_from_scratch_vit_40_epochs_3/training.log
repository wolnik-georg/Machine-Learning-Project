2025-12-19 13:44:38,154 - INFO - Logging initialized. Log file: runs/run_229/training.log
2025-12-19 13:44:38,168 - INFO - Experiment directory: runs/run_229
2025-12-19 13:44:38,170 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-19 13:44:38,261 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-19 13:44:38,693 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-19 13:44:38,694 - INFO - Using device: cuda
2025-12-19 13:44:38,696 - INFO - Training configuration: epochs=40, warmup=3, lr=0.0005
2025-12-19 13:44:38,697 - INFO - VIT configuration: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-19 13:44:38,699 - INFO - Loading dataset...
2025-12-19 13:44:38,702 - INFO - Starting ImageNet data loading from root: /
2025-12-19 13:44:38,704 - INFO - Resolved root path: /
2025-12-19 13:44:38,705 - INFO - Root path exists: True
2025-12-19 13:44:38,707 - INFO - Root path is dir: True
2025-12-19 13:44:38,717 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-19 13:44:38,719 - INFO - Expected train_dir: /train_set, exists: True
2025-12-19 13:44:38,721 - INFO - Expected val_dir: /val_set, exists: True
2025-12-19 13:44:53,159 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-19 13:44:53,499 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-19 13:44:59,025 - INFO - Training VIT from scratch
2025-12-19 13:44:59,066 - INFO - Initializing VIT model from scratch...
2025-12-19 13:44:59,067 - INFO - Model architecture: VIT
2025-12-19 13:44:59,069 - INFO - Model config: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-19 13:45:00,394 - INFO - Model created with random initialization
2025-12-19 13:45:00,396 - INFO - Total parameters: 29,854,376
2025-12-19 13:45:00,397 - INFO - Trainable parameters: 29,854,376
2025-12-19 13:45:00,488 - INFO - Starting from-scratch training...
2025-12-19 13:45:00,489 - INFO - Optimizer: training all model parameters
2025-12-19 13:45:00,493 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-19 13:45:00,495 - INFO - Starting training...
2025-12-19 14:50:27,659 - INFO - Epoch 1/40: LR: 0.000170
2025-12-19 14:50:27,706 - INFO - Epoch 1/40: Train Loss: 6.8936, Val Loss: 6.8025, Val Acc: 0.47%
2025-12-19 15:41:13,742 - INFO - Epoch 2/40: LR: 0.000335
2025-12-19 15:41:13,790 - INFO - Epoch 2/40: Train Loss: 6.7229, Val Loss: 6.4320, Val Acc: 1.36%
2025-12-19 16:30:11,050 - INFO - Epoch 3/40: LR: 0.000500
2025-12-19 16:30:11,089 - INFO - Epoch 3/40: Train Loss: 6.4489, Val Loss: 6.1245, Val Acc: 2.28%
2025-12-19 17:16:57,186 - INFO - Epoch 4/40: LR: 0.000499
2025-12-19 17:16:57,210 - INFO - Epoch 4/40: Train Loss: 6.3010, Val Loss: 6.1043, Val Acc: 2.52%
2025-12-19 18:05:29,974 - INFO - Epoch 5/40: LR: 0.000497
2025-12-19 18:19:34,600 - INFO - Epoch 5/40: Train Loss: 6.1972, Val Loss: 5.9586, Val Acc: 3.09%, Test Loss: 5.9586, Test Acc: 3.09%
2025-12-19 19:05:47,111 - INFO - Epoch 6/40: LR: 0.000493
2025-12-19 19:05:47,159 - INFO - Epoch 6/40: Train Loss: 6.1345, Val Loss: 5.8206, Val Acc: 3.81%
2025-12-19 19:55:52,595 - INFO - Epoch 7/40: LR: 0.000487
2025-12-19 19:55:52,634 - INFO - Epoch 7/40: Train Loss: 6.0623, Val Loss: 5.8433, Val Acc: 3.95%
2025-12-19 20:42:53,417 - INFO - Epoch 8/40: LR: 0.000480
2025-12-19 20:42:53,448 - INFO - Epoch 8/40: Train Loss: 6.0304, Val Loss: 5.7556, Val Acc: 4.46%
2025-12-19 21:29:31,225 - INFO - Epoch 9/40: LR: 0.000471
2025-12-19 21:29:31,240 - INFO - Epoch 9/40: Train Loss: 5.9803, Val Loss: 5.6994, Val Acc: 4.88%
2025-12-19 22:19:11,742 - INFO - Epoch 10/40: LR: 0.000461
2025-12-19 22:33:15,815 - INFO - Epoch 10/40: Train Loss: 5.9047, Val Loss: 5.6725, Val Acc: 4.81%, Test Loss: 5.6725, Test Acc: 4.81%
2025-12-19 22:33:15,817 - INFO - Saving checkpoint for epoch 10...
2025-12-19 22:33:17,204 - INFO - ✅ Checkpoint saved: runs/run_229/checkpoint_epoch_10.pth
2025-12-19 23:21:09,264 - INFO - Epoch 11/40: LR: 0.000450
2025-12-19 23:21:09,283 - INFO - Epoch 11/40: Train Loss: 5.8223, Val Loss: 5.5334, Val Acc: 6.13%
2025-12-20 00:09:05,780 - INFO - Epoch 12/40: LR: 0.000437
2025-12-20 00:09:05,818 - INFO - Epoch 12/40: Train Loss: 5.7406, Val Loss: 5.4585, Val Acc: 6.30%
2025-12-20 00:56:39,937 - INFO - Epoch 13/40: LR: 0.000424
2025-12-20 00:56:39,974 - INFO - Epoch 13/40: Train Loss: 5.6778, Val Loss: 5.4127, Val Acc: 6.73%
2025-12-20 01:44:38,956 - INFO - Epoch 14/40: LR: 0.000409
2025-12-20 01:44:38,986 - INFO - Epoch 14/40: Train Loss: 5.5890, Val Loss: 5.3224, Val Acc: 7.45%
2025-12-20 02:34:42,323 - INFO - Epoch 15/40: LR: 0.000393
2025-12-20 02:48:57,828 - INFO - Epoch 15/40: Train Loss: 5.5054, Val Loss: 5.2727, Val Acc: 8.14%, Test Loss: 5.2727, Test Acc: 8.14%
2025-12-20 03:38:46,880 - INFO - Epoch 16/40: LR: 0.000376
2025-12-20 03:38:46,972 - INFO - Epoch 16/40: Train Loss: 5.4384, Val Loss: 5.2307, Val Acc: 8.44%
2025-12-20 04:31:14,562 - INFO - Epoch 17/40: LR: 0.000359
2025-12-20 04:31:14,627 - INFO - Epoch 17/40: Train Loss: 5.3579, Val Loss: 5.1344, Val Acc: 9.14%
2025-12-20 05:23:08,751 - INFO - Epoch 18/40: LR: 0.000341
2025-12-20 05:23:08,840 - INFO - Epoch 18/40: Train Loss: 5.2928, Val Loss: 5.0890, Val Acc: 9.57%
2025-12-20 06:15:28,523 - INFO - Epoch 19/40: LR: 0.000322
2025-12-20 06:15:28,544 - INFO - Epoch 19/40: Train Loss: 5.2115, Val Loss: 4.9994, Val Acc: 10.56%
2025-12-20 07:07:55,523 - INFO - Epoch 20/40: LR: 0.000304
2025-12-20 07:21:53,102 - INFO - Epoch 20/40: Train Loss: 5.1370, Val Loss: 4.9899, Val Acc: 10.73%, Test Loss: 4.9899, Test Acc: 10.73%
2025-12-20 07:21:53,126 - INFO - Saving checkpoint for epoch 20...
2025-12-20 07:21:55,630 - INFO - ✅ Checkpoint saved: runs/run_229/checkpoint_epoch_20.pth
2025-12-20 08:13:03,014 - INFO - Epoch 21/40: LR: 0.000285
2025-12-20 08:13:03,031 - INFO - Epoch 21/40: Train Loss: 5.0617, Val Loss: 4.9236, Val Acc: 11.30%
2025-12-20 09:02:04,210 - INFO - Epoch 22/40: LR: 0.000265
2025-12-20 09:02:04,212 - INFO - Epoch 22/40: Train Loss: 4.9901, Val Loss: 4.8713, Val Acc: 11.88%
2025-12-20 09:48:05,079 - INFO - Epoch 23/40: LR: 0.000246
2025-12-20 09:48:05,103 - INFO - Epoch 23/40: Train Loss: 4.9058, Val Loss: 4.8400, Val Acc: 12.25%
2025-12-20 10:32:23,985 - INFO - Epoch 24/40: LR: 0.000228
2025-12-20 10:32:24,015 - INFO - Epoch 24/40: Train Loss: 4.8384, Val Loss: 4.7899, Val Acc: 12.87%
2025-12-20 11:17:33,399 - INFO - Epoch 25/40: LR: 0.000209
2025-12-20 11:31:41,346 - INFO - Epoch 25/40: Train Loss: 4.7546, Val Loss: 4.7579, Val Acc: 13.40%, Test Loss: 4.7579, Test Acc: 13.40%
2025-12-20 12:20:16,131 - INFO - Epoch 26/40: LR: 0.000191
2025-12-20 12:20:16,208 - INFO - Epoch 26/40: Train Loss: 4.6799, Val Loss: 4.7245, Val Acc: 14.02%
2025-12-20 13:10:22,290 - INFO - Epoch 27/40: LR: 0.000174
2025-12-20 13:10:22,346 - INFO - Epoch 27/40: Train Loss: 4.6056, Val Loss: 4.6820, Val Acc: 14.36%
2025-12-20 14:01:28,302 - INFO - Epoch 28/40: LR: 0.000157
2025-12-20 14:01:28,398 - INFO - Epoch 28/40: Train Loss: 4.5350, Val Loss: 4.6512, Val Acc: 14.82%
2025-12-20 14:56:25,058 - INFO - Epoch 29/40: LR: 0.000141
2025-12-20 14:56:25,139 - INFO - Epoch 29/40: Train Loss: 4.4583, Val Loss: 4.6142, Val Acc: 15.14%
2025-12-20 15:45:21,302 - INFO - Epoch 30/40: LR: 0.000126
2025-12-20 15:59:27,726 - INFO - Epoch 30/40: Train Loss: 4.3867, Val Loss: 4.6011, Val Acc: 15.46%, Test Loss: 4.6011, Test Acc: 15.46%
2025-12-20 15:59:27,746 - INFO - Saving checkpoint for epoch 30...
2025-12-20 15:59:29,460 - INFO - ✅ Checkpoint saved: runs/run_229/checkpoint_epoch_30.pth
2025-12-20 16:55:50,219 - INFO - Epoch 31/40: LR: 0.000113
2025-12-20 16:55:50,281 - INFO - Epoch 31/40: Train Loss: 4.3301, Val Loss: 4.5639, Val Acc: 15.91%
2025-12-20 17:44:36,046 - INFO - Epoch 32/40: LR: 0.000100
2025-12-20 17:44:36,086 - INFO - Epoch 32/40: Train Loss: 4.2669, Val Loss: 4.5634, Val Acc: 16.01%
2025-12-20 18:30:13,236 - INFO - Epoch 33/40: LR: 0.000089
2025-12-20 18:30:13,247 - INFO - Epoch 33/40: Train Loss: 4.2069, Val Loss: 4.5402, Val Acc: 16.44%
2025-12-20 19:14:04,288 - INFO - Epoch 34/40: LR: 0.000079
2025-12-20 19:14:04,314 - INFO - Epoch 34/40: Train Loss: 4.1473, Val Loss: 4.5391, Val Acc: 16.45%
2025-12-20 19:56:37,370 - INFO - Epoch 35/40: LR: 0.000070
2025-12-20 20:10:28,983 - INFO - Epoch 35/40: Train Loss: 4.1036, Val Loss: 4.5108, Val Acc: 16.80%, Test Loss: 4.5108, Test Acc: 16.80%
2025-12-20 20:53:11,858 - INFO - Epoch 36/40: LR: 0.000063
2025-12-20 20:53:11,860 - INFO - Epoch 36/40: Train Loss: 4.0580, Val Loss: 4.4968, Val Acc: 17.11%
2025-12-20 21:35:55,457 - INFO - Epoch 37/40: LR: 0.000057
2025-12-20 21:35:55,487 - INFO - Epoch 37/40: Train Loss: 4.0164, Val Loss: 4.4915, Val Acc: 17.33%
2025-12-20 22:19:31,076 - INFO - Epoch 38/40: LR: 0.000053
2025-12-20 22:19:31,113 - INFO - Epoch 38/40: Train Loss: 3.9674, Val Loss: 4.4773, Val Acc: 17.50%
2025-12-20 23:03:09,680 - INFO - Epoch 39/40: LR: 0.000051
2025-12-20 23:03:09,719 - INFO - Epoch 39/40: Train Loss: 3.9411, Val Loss: 4.4751, Val Acc: 17.53%
2025-12-20 23:45:15,665 - INFO - Epoch 40/40: LR: 0.000050
2025-12-20 23:59:19,324 - INFO - Epoch 40/40: Train Loss: 3.9109, Val Loss: 4.4803, Val Acc: 17.50%, Test Loss: 4.4803, Test Acc: 17.50%
2025-12-20 23:59:19,341 - INFO - Saving checkpoint for epoch 40...
2025-12-20 23:59:20,694 - INFO - ✅ Checkpoint saved: runs/run_229/checkpoint_epoch_40.pth
2025-12-20 23:59:20,696 - INFO - Training completed!
2025-12-20 23:59:20,701 - INFO - Training completed!
2025-12-20 23:59:20,703 - INFO - Generating training curves...
2025-12-20 23:59:24,899 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-20 23:59:24,901 - INFO - Training curves saved as separate images with base name 'runs/run_229/training_curves_from_scratch'
2025-12-20 23:59:24,902 - INFO - Generating confusion matrix on test set...
2025-12-21 01:03:28,170 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-21 01:19:29,701 - INFO - Final Test Results of from_scratch model: Loss: 4.4803, Accuracy: 17.50%
2025-12-21 01:19:29,743 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-21 01:19:30,498 - INFO - LR schedule plot saved to 'runs/run_229/lr_schedule_from_scratch.png'
2025-12-21 01:19:30,500 - INFO - 
Final Test Results:
2025-12-21 01:19:30,502 - INFO - Loss: 4.4803
2025-12-21 01:19:30,503 - INFO - Accuracy: 17.50%
2025-12-21 01:19:30,505 - INFO - Precision: 15.84%
2025-12-21 01:19:30,506 - INFO - Recall: 17.50%
2025-12-21 01:19:30,508 - INFO - F1 Score: 15.82%
2025-12-21 01:19:31,424 - INFO - Experiment completed. Results saved to runs/run_229/results_from_scratch.json
2025-12-21 01:19:31,430 - INFO - Experiment completed. Metadata saved to runs/run_229/metadata_from_scratch.json
2025-12-21 01:19:31,905 - INFO - ✅ Model weights saved: runs/run_229/final_model_from_scratch_weights.pth
2025-12-21 01:19:31,910 - INFO - Final model saved: runs/run_229/final_model_from_scratch_weights.pth
2025-12-21 01:19:31,912 - INFO - Final model metadata saved: runs/run_229/final_model_from_scratch_metadata.json
2025-12-21 01:19:31,913 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-21 01:19:31,915 - INFO - Final Accuracy: 17.50%
2025-12-21 01:19:31,916 - INFO - Final F1 Score: 15.82%
2025-12-21 01:19:31,922 - INFO - from_scratch experiment completed successfully!
